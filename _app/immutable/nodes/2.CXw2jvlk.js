import{b as ja,e as Hu,a as ue,c as cn,t as ze,n as Zt}from"../chunks/disclose-version.BzHuQ_uG.js";import{m as Gu,J as Gc,ar as Xc,w as Ct,y as Br,z as fo,I as Xu,am as Zc,O as Zu,P as za,Q as Ji,x as Zn,K as Yc,L as Eo,M as Yu,as as Qi,W as $u,q as Ha,at as Mo,au as Ga,av as Do,aw as Ku,a9 as Ju,C as Xa,ax as Qu,al as eh,ay as th,az as $c,o as Kc,ai as nh,aA as sh,af as Jc,aj as rh,ah as ih,R as Po,b as oh,V as Qc,e as Be,s as ah,H as Za,aB as ch,aC as lh,aD as uh,aE as hh,p as ai,aF as Ut,aG as el,j as oe,t as we,k as ae,l as te,h as Dt,g as _,i as ci,aH as Pt,E as ie,a5 as ft,aI as wn,aq as st,a as Ya,f as _t,aJ as dh}from"../chunks/runtime.BIFCGmUB.js";import{e as Re,a as ln,s as fh,d as ph,b as mh,f as tl,g as gh}from"../chunks/store.C2x_kkK2.js";import{c as vh,p as $,i as Ue,d as _h,b as Ur,a as yt,o as yh}from"../chunks/index-client.CDEMa4yC.js";import{i as Ro}from"../chunks/lifecycle.Bbr3nD3V.js";import{w as bh}from"../chunks/index.oxzxKtlv.js";let eo=null;function ht(n,e){return e}function wh(n,e,t,s){for(var r=[],i=e.length,o=0;o<i;o++)Qu(e[o].e,r,!0);var a=i>0&&r.length===0&&t!==null;if(a){var c=t.parentNode;eh(c),c.append(t),s.clear(),Dn(n,e[0].prev,e[i-1].next)}th(r,()=>{for(var l=0;l<i;l++){var u=e[l];a||(s.delete(u.k),Dn(n,u.prev,u.next)),$c(u.e,!a)}})}function dt(n,e,t,s,r,i=null){var o=n,a={flags:e,items:new Map,first:null},c=(e&Xc)!==0;if(c){var l=n;o=Ct?Br(Kc(l)):l.appendChild(Gu())}Ct&&fo();var u=null,h=!1;Gc(()=>{var d=t(),p=Xu(d)?d:d==null?[]:Zc(d),f=p.length;if(h&&f===0)return;h=f===0;let v=!1;if(Ct){var g=o.data===Zu;g!==(f===0)&&(o=za(),Br(o),Ji(!1),v=!0)}if(Ct){for(var y=null,x,T=0;T<f;T++){if(Zn.nodeType===8&&Zn.data===nh){o=Zn,v=!0,Ji(!1);break}var m=p[T],b=s(m,T);x=nl(Zn,a,y,null,m,b,T,r,e),a.items.set(b,x),y=x}f>0&&Br(za())}Ct||Th(p,a,o,r,e,s),i!==null&&(f===0?u?Yc(u):u=Eo(()=>i(o)):u!==null&&Yu(u,()=>{u=null})),v&&Ji(!0),t()}),Ct&&(o=Zn)}function Th(n,e,t,s,r,i){var P,R,V,L;var o=(r&sh)!==0,a=(r&(Mo|Do))!==0,c=n.length,l=e.items,u=e.first,h=u,d,p=null,f,v=[],g=[],y,x,T,m;if(o)for(m=0;m<c;m+=1)y=n[m],x=i(y,m),T=l.get(x),T!==void 0&&((P=T.a)==null||P.measure(),(f??(f=new Set)).add(T));for(m=0;m<c;m+=1){if(y=n[m],x=i(y,m),T=l.get(x),T===void 0){var b=h?h.e.nodes_start:t;p=nl(b,e,p,p===null?e.first:p.next,y,x,m,s,r),l.set(x,p),v=[],g=[],h=p.next;continue}if(a&&xh(T,y,m,r),T.e.f&Qi&&(Yc(T.e),o&&((R=T.a)==null||R.unfix(),(f??(f=new Set)).delete(T))),T!==h){if(d!==void 0&&d.has(T)){if(v.length<g.length){var w=g[0],C;p=w.prev;var k=v[0],M=v[v.length-1];for(C=0;C<v.length;C+=1)$a(v[C],w,t);for(C=0;C<g.length;C+=1)d.delete(g[C]);Dn(e,k.prev,M.next),Dn(e,p,k),Dn(e,M,w),h=w,p=M,m-=1,v=[],g=[]}else d.delete(T),$a(T,h,t),Dn(e,T.prev,T.next),Dn(e,T,p===null?e.first:p.next),Dn(e,p,T),p=T;continue}for(v=[],g=[];h!==null&&h.k!==x;)h.e.f&Qi||(d??(d=new Set)).add(h),g.push(h),h=h.next;if(h===null)continue;T=h}v.push(T),p=T,h=T.next}if(h!==null||d!==void 0){for(var O=d===void 0?[]:Zc(d);h!==null;)h.e.f&Qi||O.push(h),h=h.next;var N=O.length;if(N>0){var I=r&Xc&&c===0?t:null;if(o){for(m=0;m<N;m+=1)(V=O[m].a)==null||V.measure();for(m=0;m<N;m+=1)(L=O[m].a)==null||L.fix()}wh(e,O,I,l)}}o&&$u(()=>{var F;if(f!==void 0)for(T of f)(F=T.a)==null||F.apply()}),Ha.first=e.first&&e.first.e,Ha.last=p&&p.e}function xh(n,e,t,s){s&Mo&&Ga(n.v,e),s&Do?Ga(n.i,t):n.i=t}function nl(n,e,t,s,r,i,o,a,c){var l=eo;try{var u=(c&Mo)!==0,h=(c&Ku)===0,d=u?h?Ju(r):Xa(r):r,p=c&Do?Xa(o):o,f={i:p,v:d,k:i,a:null,e:null,prev:t,next:s};return eo=f,f.e=Eo(()=>a(n,d,p),Ct),f.e.prev=t&&t.e,f.e.next=s&&s.e,t===null?e.first=f:(t.next=f,t.e.next=f.e),s!==null&&(s.prev=f,s.e.prev=f.e),f}finally{eo=l}}function $a(n,e,t){for(var s=n.next?n.next.e.nodes_start:t,r=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==s;){var o=Jc(i);r.before(i),i=o}}function Dn(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function qr(n,e,t,s,r){var i=n,o="",a;Gc(()=>{if(o===(o=e()??"")){Ct&&fo();return}a!==void 0&&($c(a),a=void 0),o!==""&&(a=Eo(()=>{if(Ct){Zn.data;for(var c=fo(),l=c;c!==null&&(c.nodeType!==8||c.data!=="");)l=c,c=Jc(c);if(c===null)throw rh(),ih;ja(Zn,l),i=Br(c);return}var u=o+"",h=Hu(u);ja(Kc(h),h.lastChild),i.before(h)}))})}function bn(n,e,t){Po(()=>{var s=oh(()=>e(n,t==null?void 0:t())||{});if(t&&(s!=null&&s.update)){var r=!1,i={};Qc(()=>{var o=t();Be(o),r&&ah(i,o)&&(i=o,s.update(o))}),r=!0}if(s!=null&&s.destroy)return()=>s.destroy()})}let Ka=!1;function sl(){Ka||(Ka=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var e;if(!n.defaultPrevented)for(const t of n.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function to(n){if(Ct){var e=!1,t=()=>{if(!e){if(e=!0,n.hasAttribute("value")){var s=n.value;j(n,"value",null),n.value=s}if(n.hasAttribute("checked")){var r=n.checked;j(n,"checked",null),n.checked=r}}};n.__on_r=t,lh(t),sl()}}function j(n,e,t,s){var r=n.__attributes??(n.__attributes={});Ct&&(r[e]=n.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&n.nodeName==="LINK")||r[e]!==(r[e]=t)&&(e==="style"&&"__styles"in n&&(n.__styles={}),e==="loading"&&(n[uh]=t),t==null?n.removeAttribute(e):typeof t!="string"&&kh(n).includes(e)?n[e]=t:n.setAttribute(e,t))}var Ja=new Map;function kh(n){var e=Ja.get(n.nodeName);if(e)return e;Ja.set(n.nodeName,e=[]);for(var t,s=Za(n),r=Element.prototype;r!==s;){t=ch(s);for(var i in t)t[i].set&&e.push(i);s=Za(s)}return e}function Ys(n,e){var t=n.__className,s=Ch(e);Ct&&n.getAttribute("class")===s?n.__className=s:(t!==s||Ct&&n.getAttribute("class")!==s)&&(s===""?n.removeAttribute("class"):n.setAttribute("class",s),n.__className=s)}function Ch(n){return n??""}function We(n,e,t){if(t){if(n.classList.contains(e))return;n.classList.add(e)}else{if(!n.classList.contains(e))return;n.classList.remove(e)}}const Sh=requestAnimationFrame,Ah=()=>performance.now(),hn={tick:n=>Sh(n),now:()=>Ah(),tasks:new Set};function rl(n){hn.tasks.forEach(e=>{e.c(n)||(hn.tasks.delete(e),e.f())}),hn.tasks.size!==0&&hn.tick(rl)}function Oh(n){let e;return hn.tasks.size===0&&hn.tick(rl),{promise:new Promise(t=>{hn.tasks.add(e={c:n,f:t})}),abort(){hn.tasks.delete(e)}}}function il(n,e,t,s=t){n.addEventListener(e,t);const r=n.__on_r;r?n.__on_r=()=>{r(),s()}:n.__on_r=s,sl()}function no(n,e,t=e){var s=hh();il(n,"input",()=>{var r=Qa(n)?ec(n.value):n.value;t(r),s&&r!==(r=e())&&(n.value=r??"")}),Qc(()=>{var r=e();if(Ct&&n.defaultValue!==n.value){t(n.value);return}Qa(n)&&r===ec(n.value)||n.type==="date"&&!r&&!n.value||r!==n.value&&(n.value=r??"")})}function Qa(n){var e=n.type;return e==="number"||e==="range"}function ec(n){return n===""?null:+n}function ol(n,e,t){if(n.multiple)return Nh(n,e);for(var s of n.options){var r=Ks(s);if(vh(r,e)){s.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function Ih(n,e){Po(()=>{var t=new MutationObserver(()=>{var s=n.__value;ol(n,s)});return t.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function tc(n,e,t=e){var s=!0;il(n,"change",()=>{var r;if(n.multiple)r=[].map.call(n.querySelectorAll(":checked"),Ks);else{var i=n.querySelector(":checked");r=i&&Ks(i)}t(r)}),Po(()=>{var r=e();if(ol(n,r,s),s&&r===void 0){var i=n.querySelector(":checked");i!==null&&(r=Ks(i),t(r))}n.__value=r,s=!1}),Ih(n)}function Nh(n,e){for(var t of n.options)t.selected=~e.indexOf(Ks(t))}function Ks(n){return"__value"in n?n.__value:n.value}function nc(n){return function(...e){var t=e[0];return t.preventDefault(),n==null?void 0:n.apply(this,e)}}var At="top",Gt="bottom",Xt="right",Ot="left",Fo="auto",lr=[At,Gt,Xt,Ot],ys="start",sr="end",Eh="clippingParents",al="viewport",$s="popper",Mh="reference",sc=lr.reduce(function(n,e){return n.concat([e+"-"+ys,e+"-"+sr])},[]),cl=[].concat(lr,[Fo]).reduce(function(n,e){return n.concat([e,e+"-"+ys,e+"-"+sr])},[]),Dh="beforeRead",Ph="read",Rh="afterRead",Fh="beforeMain",Vh="main",Lh="afterMain",Bh="beforeWrite",Uh="write",qh="afterWrite",Wh=[Dh,Ph,Rh,Fh,Vh,Lh,Bh,Uh,qh];function fn(n){return n?(n.nodeName||"").toLowerCase():null}function Ft(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Jn(n){var e=Ft(n).Element;return n instanceof e||n instanceof Element}function jt(n){var e=Ft(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Vo(n){if(typeof ShadowRoot>"u")return!1;var e=Ft(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function jh(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var s=e.styles[t]||{},r=e.attributes[t]||{},i=e.elements[t];!jt(i)||!fn(i)||(Object.assign(i.style,s),Object.keys(r).forEach(function(o){var a=r[o];a===!1?i.removeAttribute(o):i.setAttribute(o,a===!0?"":a)}))})}function zh(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(s){var r=e.elements[s],i=e.attributes[s]||{},o=Object.keys(e.styles.hasOwnProperty(s)?e.styles[s]:t[s]),a=o.reduce(function(c,l){return c[l]="",c},{});!jt(r)||!fn(r)||(Object.assign(r.style,a),Object.keys(i).forEach(function(c){r.removeAttribute(c)}))})}}const ll={name:"applyStyles",enabled:!0,phase:"write",fn:jh,effect:zh,requires:["computeStyles"]};function dn(n){return n.split("-")[0]}var $n=Math.max,Hr=Math.min,bs=Math.round;function po(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function ul(){return!/^((?!chrome|android).)*safari/i.test(po())}function ws(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var s=n.getBoundingClientRect(),r=1,i=1;e&&jt(n)&&(r=n.offsetWidth>0&&bs(s.width)/n.offsetWidth||1,i=n.offsetHeight>0&&bs(s.height)/n.offsetHeight||1);var o=Jn(n)?Ft(n):window,a=o.visualViewport,c=!ul()&&t,l=(s.left+(c&&a?a.offsetLeft:0))/r,u=(s.top+(c&&a?a.offsetTop:0))/i,h=s.width/r,d=s.height/i;return{width:h,height:d,top:u,right:l+h,bottom:u+d,left:l,x:l,y:u}}function Lo(n){var e=ws(n),t=n.offsetWidth,s=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-s)<=1&&(s=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:s}}function hl(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Vo(t)){var s=e;do{if(s&&n.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function kn(n){return Ft(n).getComputedStyle(n)}function Hh(n){return["table","td","th"].indexOf(fn(n))>=0}function Bn(n){return((Jn(n)?n.ownerDocument:n.document)||window.document).documentElement}function li(n){return fn(n)==="html"?n:n.assignedSlot||n.parentNode||(Vo(n)?n.host:null)||Bn(n)}function rc(n){return!jt(n)||kn(n).position==="fixed"?null:n.offsetParent}function Gh(n){var e=/firefox/i.test(po()),t=/Trident/i.test(po());if(t&&jt(n)){var s=kn(n);if(s.position==="fixed")return null}var r=li(n);for(Vo(r)&&(r=r.host);jt(r)&&["html","body"].indexOf(fn(r))<0;){var i=kn(r);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||e&&i.willChange==="filter"||e&&i.filter&&i.filter!=="none")return r;r=r.parentNode}return null}function ur(n){for(var e=Ft(n),t=rc(n);t&&Hh(t)&&kn(t).position==="static";)t=rc(t);return t&&(fn(t)==="html"||fn(t)==="body"&&kn(t).position==="static")?e:t||Gh(n)||e}function Bo(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Js(n,e,t){return $n(n,Hr(e,t))}function Xh(n,e,t){var s=Js(n,e,t);return s>t?t:s}function dl(){return{top:0,right:0,bottom:0,left:0}}function fl(n){return Object.assign({},dl(),n)}function pl(n,e){return e.reduce(function(t,s){return t[s]=n,t},{})}var Zh=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,fl(typeof e!="number"?e:pl(e,lr))};function Yh(n){var e,t=n.state,s=n.name,r=n.options,i=t.elements.arrow,o=t.modifiersData.popperOffsets,a=dn(t.placement),c=Bo(a),l=[Ot,Xt].indexOf(a)>=0,u=l?"height":"width";if(!(!i||!o)){var h=Zh(r.padding,t),d=Lo(i),p=c==="y"?At:Ot,f=c==="y"?Gt:Xt,v=t.rects.reference[u]+t.rects.reference[c]-o[c]-t.rects.popper[u],g=o[c]-t.rects.reference[c],y=ur(i),x=y?c==="y"?y.clientHeight||0:y.clientWidth||0:0,T=v/2-g/2,m=h[p],b=x-d[u]-h[f],w=x/2-d[u]/2+T,C=Js(m,w,b),k=c;t.modifiersData[s]=(e={},e[k]=C,e.centerOffset=C-w,e)}}function $h(n){var e=n.state,t=n.options,s=t.element,r=s===void 0?"[data-popper-arrow]":s;r!=null&&(typeof r=="string"&&(r=e.elements.popper.querySelector(r),!r)||hl(e.elements.popper,r)&&(e.elements.arrow=r))}const Kh={name:"arrow",enabled:!0,phase:"main",fn:Yh,effect:$h,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ts(n){return n.split("-")[1]}var Jh={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Qh(n,e){var t=n.x,s=n.y,r=e.devicePixelRatio||1;return{x:bs(t*r)/r||0,y:bs(s*r)/r||0}}function ic(n){var e,t=n.popper,s=n.popperRect,r=n.placement,i=n.variation,o=n.offsets,a=n.position,c=n.gpuAcceleration,l=n.adaptive,u=n.roundOffsets,h=n.isFixed,d=o.x,p=d===void 0?0:d,f=o.y,v=f===void 0?0:f,g=typeof u=="function"?u({x:p,y:v}):{x:p,y:v};p=g.x,v=g.y;var y=o.hasOwnProperty("x"),x=o.hasOwnProperty("y"),T=Ot,m=At,b=window;if(l){var w=ur(t),C="clientHeight",k="clientWidth";if(w===Ft(t)&&(w=Bn(t),kn(w).position!=="static"&&a==="absolute"&&(C="scrollHeight",k="scrollWidth")),w=w,r===At||(r===Ot||r===Xt)&&i===sr){m=Gt;var M=h&&w===b&&b.visualViewport?b.visualViewport.height:w[C];v-=M-s.height,v*=c?1:-1}if(r===Ot||(r===At||r===Gt)&&i===sr){T=Xt;var O=h&&w===b&&b.visualViewport?b.visualViewport.width:w[k];p-=O-s.width,p*=c?1:-1}}var N=Object.assign({position:a},l&&Jh),I=u===!0?Qh({x:p,y:v},Ft(t)):{x:p,y:v};if(p=I.x,v=I.y,c){var P;return Object.assign({},N,(P={},P[m]=x?"0":"",P[T]=y?"0":"",P.transform=(b.devicePixelRatio||1)<=1?"translate("+p+"px, "+v+"px)":"translate3d("+p+"px, "+v+"px, 0)",P))}return Object.assign({},N,(e={},e[m]=x?v+"px":"",e[T]=y?p+"px":"",e.transform="",e))}function ed(n){var e=n.state,t=n.options,s=t.gpuAcceleration,r=s===void 0?!0:s,i=t.adaptive,o=i===void 0?!0:i,a=t.roundOffsets,c=a===void 0?!0:a,l={placement:dn(e.placement),variation:Ts(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,ic(Object.assign({},l,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:c})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,ic(Object.assign({},l,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const td={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:ed,data:{}};var Ir={passive:!0};function nd(n){var e=n.state,t=n.instance,s=n.options,r=s.scroll,i=r===void 0?!0:r,o=s.resize,a=o===void 0?!0:o,c=Ft(e.elements.popper),l=[].concat(e.scrollParents.reference,e.scrollParents.popper);return i&&l.forEach(function(u){u.addEventListener("scroll",t.update,Ir)}),a&&c.addEventListener("resize",t.update,Ir),function(){i&&l.forEach(function(u){u.removeEventListener("scroll",t.update,Ir)}),a&&c.removeEventListener("resize",t.update,Ir)}}const sd={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:nd,data:{}};var rd={left:"right",right:"left",bottom:"top",top:"bottom"};function Wr(n){return n.replace(/left|right|bottom|top/g,function(e){return rd[e]})}var id={start:"end",end:"start"};function oc(n){return n.replace(/start|end/g,function(e){return id[e]})}function Uo(n){var e=Ft(n),t=e.pageXOffset,s=e.pageYOffset;return{scrollLeft:t,scrollTop:s}}function qo(n){return ws(Bn(n)).left+Uo(n).scrollLeft}function od(n,e){var t=Ft(n),s=Bn(n),r=t.visualViewport,i=s.clientWidth,o=s.clientHeight,a=0,c=0;if(r){i=r.width,o=r.height;var l=ul();(l||!l&&e==="fixed")&&(a=r.offsetLeft,c=r.offsetTop)}return{width:i,height:o,x:a+qo(n),y:c}}function ad(n){var e,t=Bn(n),s=Uo(n),r=(e=n.ownerDocument)==null?void 0:e.body,i=$n(t.scrollWidth,t.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=$n(t.scrollHeight,t.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-s.scrollLeft+qo(n),c=-s.scrollTop;return kn(r||t).direction==="rtl"&&(a+=$n(t.clientWidth,r?r.clientWidth:0)-i),{width:i,height:o,x:a,y:c}}function Wo(n){var e=kn(n),t=e.overflow,s=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+r+s)}function ml(n){return["html","body","#document"].indexOf(fn(n))>=0?n.ownerDocument.body:jt(n)&&Wo(n)?n:ml(li(n))}function Qs(n,e){var t;e===void 0&&(e=[]);var s=ml(n),r=s===((t=n.ownerDocument)==null?void 0:t.body),i=Ft(s),o=r?[i].concat(i.visualViewport||[],Wo(s)?s:[]):s,a=e.concat(o);return r?a:a.concat(Qs(li(o)))}function mo(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function cd(n,e){var t=ws(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function ac(n,e,t){return e===al?mo(od(n,t)):Jn(e)?cd(e,t):mo(ad(Bn(n)))}function ld(n){var e=Qs(li(n)),t=["absolute","fixed"].indexOf(kn(n).position)>=0,s=t&&jt(n)?ur(n):n;return Jn(s)?e.filter(function(r){return Jn(r)&&hl(r,s)&&fn(r)!=="body"}):[]}function ud(n,e,t,s){var r=e==="clippingParents"?ld(n):[].concat(e),i=[].concat(r,[t]),o=i[0],a=i.reduce(function(c,l){var u=ac(n,l,s);return c.top=$n(u.top,c.top),c.right=Hr(u.right,c.right),c.bottom=Hr(u.bottom,c.bottom),c.left=$n(u.left,c.left),c},ac(n,o,s));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function gl(n){var e=n.reference,t=n.element,s=n.placement,r=s?dn(s):null,i=s?Ts(s):null,o=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,c;switch(r){case At:c={x:o,y:e.y-t.height};break;case Gt:c={x:o,y:e.y+e.height};break;case Xt:c={x:e.x+e.width,y:a};break;case Ot:c={x:e.x-t.width,y:a};break;default:c={x:e.x,y:e.y}}var l=r?Bo(r):null;if(l!=null){var u=l==="y"?"height":"width";switch(i){case ys:c[l]=c[l]-(e[u]/2-t[u]/2);break;case sr:c[l]=c[l]+(e[u]/2-t[u]/2);break}}return c}function rr(n,e){e===void 0&&(e={});var t=e,s=t.placement,r=s===void 0?n.placement:s,i=t.strategy,o=i===void 0?n.strategy:i,a=t.boundary,c=a===void 0?Eh:a,l=t.rootBoundary,u=l===void 0?al:l,h=t.elementContext,d=h===void 0?$s:h,p=t.altBoundary,f=p===void 0?!1:p,v=t.padding,g=v===void 0?0:v,y=fl(typeof g!="number"?g:pl(g,lr)),x=d===$s?Mh:$s,T=n.rects.popper,m=n.elements[f?x:d],b=ud(Jn(m)?m:m.contextElement||Bn(n.elements.popper),c,u,o),w=ws(n.elements.reference),C=gl({reference:w,element:T,strategy:"absolute",placement:r}),k=mo(Object.assign({},T,C)),M=d===$s?k:w,O={top:b.top-M.top+y.top,bottom:M.bottom-b.bottom+y.bottom,left:b.left-M.left+y.left,right:M.right-b.right+y.right},N=n.modifiersData.offset;if(d===$s&&N){var I=N[r];Object.keys(O).forEach(function(P){var R=[Xt,Gt].indexOf(P)>=0?1:-1,V=[At,Gt].indexOf(P)>=0?"y":"x";O[P]+=I[V]*R})}return O}function hd(n,e){e===void 0&&(e={});var t=e,s=t.placement,r=t.boundary,i=t.rootBoundary,o=t.padding,a=t.flipVariations,c=t.allowedAutoPlacements,l=c===void 0?cl:c,u=Ts(s),h=u?a?sc:sc.filter(function(f){return Ts(f)===u}):lr,d=h.filter(function(f){return l.indexOf(f)>=0});d.length===0&&(d=h);var p=d.reduce(function(f,v){return f[v]=rr(n,{placement:v,boundary:r,rootBoundary:i,padding:o})[dn(v)],f},{});return Object.keys(p).sort(function(f,v){return p[f]-p[v]})}function dd(n){if(dn(n)===Fo)return[];var e=Wr(n);return[oc(n),e,oc(e)]}function fd(n){var e=n.state,t=n.options,s=n.name;if(!e.modifiersData[s]._skip){for(var r=t.mainAxis,i=r===void 0?!0:r,o=t.altAxis,a=o===void 0?!0:o,c=t.fallbackPlacements,l=t.padding,u=t.boundary,h=t.rootBoundary,d=t.altBoundary,p=t.flipVariations,f=p===void 0?!0:p,v=t.allowedAutoPlacements,g=e.options.placement,y=dn(g),x=y===g,T=c||(x||!f?[Wr(g)]:dd(g)),m=[g].concat(T).reduce(function(me,ee){return me.concat(dn(ee)===Fo?hd(e,{placement:ee,boundary:u,rootBoundary:h,padding:l,flipVariations:f,allowedAutoPlacements:v}):ee)},[]),b=e.rects.reference,w=e.rects.popper,C=new Map,k=!0,M=m[0],O=0;O<m.length;O++){var N=m[O],I=dn(N),P=Ts(N)===ys,R=[At,Gt].indexOf(I)>=0,V=R?"width":"height",L=rr(e,{placement:N,boundary:u,rootBoundary:h,altBoundary:d,padding:l}),F=R?P?Xt:Ot:P?Gt:At;b[V]>w[V]&&(F=Wr(F));var K=Wr(F),z=[];if(i&&z.push(L[I]<=0),a&&z.push(L[F]<=0,L[K]<=0),z.every(function(me){return me})){M=N,k=!1;break}C.set(N,z)}if(k)for(var Z=f?3:1,G=function(ee){var ne=m.find(function(_e){var q=C.get(_e);if(q)return q.slice(0,ee).every(function(xe){return xe})});if(ne)return M=ne,"break"},X=Z;X>0;X--){var ce=G(X);if(ce==="break")break}e.placement!==M&&(e.modifiersData[s]._skip=!0,e.placement=M,e.reset=!0)}}const pd={name:"flip",enabled:!0,phase:"main",fn:fd,requiresIfExists:["offset"],data:{_skip:!1}};function cc(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function lc(n){return[At,Xt,Gt,Ot].some(function(e){return n[e]>=0})}function md(n){var e=n.state,t=n.name,s=e.rects.reference,r=e.rects.popper,i=e.modifiersData.preventOverflow,o=rr(e,{elementContext:"reference"}),a=rr(e,{altBoundary:!0}),c=cc(o,s),l=cc(a,r,i),u=lc(c),h=lc(l);e.modifiersData[t]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}const gd={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:md};function vd(n,e,t){var s=dn(n),r=[Ot,At].indexOf(s)>=0?-1:1,i=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,o=i[0],a=i[1];return o=o||0,a=(a||0)*r,[Ot,Xt].indexOf(s)>=0?{x:a,y:o}:{x:o,y:a}}function _d(n){var e=n.state,t=n.options,s=n.name,r=t.offset,i=r===void 0?[0,0]:r,o=cl.reduce(function(u,h){return u[h]=vd(h,e.rects,i),u},{}),a=o[e.placement],c=a.x,l=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=l),e.modifiersData[s]=o}const yd={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:_d};function bd(n){var e=n.state,t=n.name;e.modifiersData[t]=gl({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const wd={name:"popperOffsets",enabled:!0,phase:"read",fn:bd,data:{}};function Td(n){return n==="x"?"y":"x"}function xd(n){var e=n.state,t=n.options,s=n.name,r=t.mainAxis,i=r===void 0?!0:r,o=t.altAxis,a=o===void 0?!1:o,c=t.boundary,l=t.rootBoundary,u=t.altBoundary,h=t.padding,d=t.tether,p=d===void 0?!0:d,f=t.tetherOffset,v=f===void 0?0:f,g=rr(e,{boundary:c,rootBoundary:l,padding:h,altBoundary:u}),y=dn(e.placement),x=Ts(e.placement),T=!x,m=Bo(y),b=Td(m),w=e.modifiersData.popperOffsets,C=e.rects.reference,k=e.rects.popper,M=typeof v=="function"?v(Object.assign({},e.rects,{placement:e.placement})):v,O=typeof M=="number"?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),N=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,I={x:0,y:0};if(w){if(i){var P,R=m==="y"?At:Ot,V=m==="y"?Gt:Xt,L=m==="y"?"height":"width",F=w[m],K=F+g[R],z=F-g[V],Z=p?-k[L]/2:0,G=x===ys?C[L]:k[L],X=x===ys?-k[L]:-C[L],ce=e.elements.arrow,me=p&&ce?Lo(ce):{width:0,height:0},ee=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:dl(),ne=ee[R],_e=ee[V],q=Js(0,C[L],me[L]),xe=T?C[L]/2-Z-q-ne-O.mainAxis:G-q-ne-O.mainAxis,Oe=T?-C[L]/2+Z+q+_e+O.mainAxis:X+q+_e+O.mainAxis,ve=e.elements.arrow&&ur(e.elements.arrow),he=ve?m==="y"?ve.clientTop||0:ve.clientLeft||0:0,$e=(P=N==null?void 0:N[m])!=null?P:0,kt=F+xe-$e-he,B=F+Oe-$e,Y=Js(p?Hr(K,kt):K,F,p?$n(z,B):z);w[m]=Y,I[m]=Y-F}if(a){var ke,fe=m==="x"?At:Ot,le=m==="x"?Gt:Xt,ge=w[b],Ie=b==="y"?"height":"width",De=ge+g[fe],Pe=ge-g[le],nt=[At,Ot].indexOf(y)!==-1,Et=(ke=N==null?void 0:N[b])!=null?ke:0,at=nt?De:ge-C[Ie]-k[Ie]-Et+O.altAxis,Yt=nt?ge+C[Ie]+k[Ie]-Et-O.altAxis:Pe,$t=p&&nt?Xh(at,ge,Yt):Js(p?at:De,ge,p?Yt:Pe);w[b]=$t,I[b]=$t-ge}e.modifiersData[s]=I}}const kd={name:"preventOverflow",enabled:!0,phase:"main",fn:xd,requiresIfExists:["offset"]};function Cd(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Sd(n){return n===Ft(n)||!jt(n)?Uo(n):Cd(n)}function Ad(n){var e=n.getBoundingClientRect(),t=bs(e.width)/n.offsetWidth||1,s=bs(e.height)/n.offsetHeight||1;return t!==1||s!==1}function Od(n,e,t){t===void 0&&(t=!1);var s=jt(e),r=jt(e)&&Ad(e),i=Bn(e),o=ws(n,r,t),a={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(s||!s&&!t)&&((fn(e)!=="body"||Wo(i))&&(a=Sd(e)),jt(e)?(c=ws(e,!0),c.x+=e.clientLeft,c.y+=e.clientTop):i&&(c.x=qo(i))),{x:o.left+a.scrollLeft-c.x,y:o.top+a.scrollTop-c.y,width:o.width,height:o.height}}function Id(n){var e=new Map,t=new Set,s=[];n.forEach(function(i){e.set(i.name,i)});function r(i){t.add(i.name);var o=[].concat(i.requires||[],i.requiresIfExists||[]);o.forEach(function(a){if(!t.has(a)){var c=e.get(a);c&&r(c)}}),s.push(i)}return n.forEach(function(i){t.has(i.name)||r(i)}),s}function Nd(n){var e=Id(n);return Wh.reduce(function(t,s){return t.concat(e.filter(function(r){return r.phase===s}))},[])}function Ed(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Md(n){var e=n.reduce(function(t,s){var r=t[s.name];return t[s.name]=r?Object.assign({},r,s,{options:Object.assign({},r.options,s.options),data:Object.assign({},r.data,s.data)}):s,t},{});return Object.keys(e).map(function(t){return e[t]})}var uc={placement:"bottom",modifiers:[],strategy:"absolute"};function hc(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function Dd(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,s=t===void 0?[]:t,r=e.defaultOptions,i=r===void 0?uc:r;return function(a,c,l){l===void 0&&(l=i);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},uc,i),modifiersData:{},elements:{reference:a,popper:c},attributes:{},styles:{}},h=[],d=!1,p={state:u,setOptions:function(y){var x=typeof y=="function"?y(u.options):y;v(),u.options=Object.assign({},i,u.options,x),u.scrollParents={reference:Jn(a)?Qs(a):a.contextElement?Qs(a.contextElement):[],popper:Qs(c)};var T=Nd(Md([].concat(s,u.options.modifiers)));return u.orderedModifiers=T.filter(function(m){return m.enabled}),f(),p.update()},forceUpdate:function(){if(!d){var y=u.elements,x=y.reference,T=y.popper;if(hc(x,T)){u.rects={reference:Od(x,ur(T),u.options.strategy==="fixed"),popper:Lo(T)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(O){return u.modifiersData[O.name]=Object.assign({},O.data)});for(var m=0;m<u.orderedModifiers.length;m++){if(u.reset===!0){u.reset=!1,m=-1;continue}var b=u.orderedModifiers[m],w=b.fn,C=b.options,k=C===void 0?{}:C,M=b.name;typeof w=="function"&&(u=w({state:u,options:k,name:M,instance:p})||u)}}}},update:Ed(function(){return new Promise(function(g){p.forceUpdate(),g(u)})}),destroy:function(){v(),d=!0}};if(!hc(a,c))return p;p.setOptions(l).then(function(g){!d&&l.onFirstUpdate&&l.onFirstUpdate(g)});function f(){u.orderedModifiers.forEach(function(g){var y=g.name,x=g.options,T=x===void 0?{}:x,m=g.effect;if(typeof m=="function"){var b=m({state:u,name:y,instance:p,options:T}),w=function(){};h.push(b||w)}})}function v(){h.forEach(function(g){return g()}),h=[]}return p}}var Pd=[sd,wd,td,ll,yd,pd,kd,Kh,gd],Rd=Dd({defaultModifiers:Pd}),Fd="tippy-box",vl="tippy-content",Vd="tippy-backdrop",_l="tippy-arrow",yl="tippy-svg-arrow",Xn={passive:!0,capture:!0},bl=function(){return document.body};function so(n,e,t){if(Array.isArray(n)){var s=n[e];return s??(Array.isArray(t)?t[e]:t)}return n}function jo(n,e){var t={}.toString.call(n);return t.indexOf("[object")===0&&t.indexOf(e+"]")>-1}function wl(n,e){return typeof n=="function"?n.apply(void 0,e):n}function dc(n,e){if(e===0)return n;var t;return function(s){clearTimeout(t),t=setTimeout(function(){n(s)},e)}}function Ld(n){return n.split(/\s+/).filter(Boolean)}function us(n){return[].concat(n)}function fc(n,e){n.indexOf(e)===-1&&n.push(e)}function Bd(n){return n.filter(function(e,t){return n.indexOf(e)===t})}function Ud(n){return n.split("-")[0]}function Gr(n){return[].slice.call(n)}function pc(n){return Object.keys(n).reduce(function(e,t){return n[t]!==void 0&&(e[t]=n[t]),e},{})}function er(){return document.createElement("div")}function ui(n){return["Element","Fragment"].some(function(e){return jo(n,e)})}function qd(n){return jo(n,"NodeList")}function Wd(n){return jo(n,"MouseEvent")}function jd(n){return!!(n&&n._tippy&&n._tippy.reference===n)}function zd(n){return ui(n)?[n]:qd(n)?Gr(n):Array.isArray(n)?n:Gr(document.querySelectorAll(n))}function ro(n,e){n.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function mc(n,e){n.forEach(function(t){t&&t.setAttribute("data-state",e)})}function Hd(n){var e,t=us(n),s=t[0];return s!=null&&(e=s.ownerDocument)!=null&&e.body?s.ownerDocument:document}function Gd(n,e){var t=e.clientX,s=e.clientY;return n.every(function(r){var i=r.popperRect,o=r.popperState,a=r.props,c=a.interactiveBorder,l=Ud(o.placement),u=o.modifiersData.offset;if(!u)return!0;var h=l==="bottom"?u.top.y:0,d=l==="top"?u.bottom.y:0,p=l==="right"?u.left.x:0,f=l==="left"?u.right.x:0,v=i.top-s+h>c,g=s-i.bottom-d>c,y=i.left-t+p>c,x=t-i.right-f>c;return v||g||y||x})}function io(n,e,t){var s=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(r){n[s](r,t)})}function gc(n,e){for(var t=e;t;){var s;if(n.contains(t))return!0;t=t.getRootNode==null||(s=t.getRootNode())==null?void 0:s.host}return!1}var un={isTouch:!1},vc=0;function Xd(){un.isTouch||(un.isTouch=!0,window.performance&&document.addEventListener("mousemove",Tl))}function Tl(){var n=performance.now();n-vc<20&&(un.isTouch=!1,document.removeEventListener("mousemove",Tl)),vc=n}function Zd(){var n=document.activeElement;if(jd(n)){var e=n._tippy;n.blur&&!e.state.isVisible&&n.blur()}}function Yd(){document.addEventListener("touchstart",Xd,Xn),window.addEventListener("blur",Zd)}var $d=typeof window<"u"&&typeof document<"u",Kd=$d?!!window.msCrypto:!1,Jd={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Qd={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},en=Object.assign({appendTo:bl,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},Jd,Qd),ef=Object.keys(en),tf=function(e){var t=Object.keys(e);t.forEach(function(s){en[s]=e[s]})};function xl(n){var e=n.plugins||[],t=e.reduce(function(s,r){var i=r.name,o=r.defaultValue;if(i){var a;s[i]=n[i]!==void 0?n[i]:(a=en[i])!=null?a:o}return s},{});return Object.assign({},n,t)}function nf(n,e){var t=e?Object.keys(xl(Object.assign({},en,{plugins:e}))):ef,s=t.reduce(function(r,i){var o=(n.getAttribute("data-tippy-"+i)||"").trim();if(!o)return r;if(i==="content")r[i]=o;else try{r[i]=JSON.parse(o)}catch{r[i]=o}return r},{});return s}function _c(n,e){var t=Object.assign({},e,{content:wl(e.content,[n])},e.ignoreAttributes?{}:nf(n,e.plugins));return t.aria=Object.assign({},en.aria,t.aria),t.aria={expanded:t.aria.expanded==="auto"?e.interactive:t.aria.expanded,content:t.aria.content==="auto"?e.interactive?null:"describedby":t.aria.content},t}var sf=function(){return"innerHTML"};function go(n,e){n[sf()]=e}function yc(n){var e=er();return n===!0?e.className=_l:(e.className=yl,ui(n)?e.appendChild(n):go(e,n)),e}function bc(n,e){ui(e.content)?(go(n,""),n.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?go(n,e.content):n.textContent=e.content)}function vo(n){var e=n.firstElementChild,t=Gr(e.children);return{box:e,content:t.find(function(s){return s.classList.contains(vl)}),arrow:t.find(function(s){return s.classList.contains(_l)||s.classList.contains(yl)}),backdrop:t.find(function(s){return s.classList.contains(Vd)})}}function kl(n){var e=er(),t=er();t.className=Fd,t.setAttribute("data-state","hidden"),t.setAttribute("tabindex","-1");var s=er();s.className=vl,s.setAttribute("data-state","hidden"),bc(s,n.props),e.appendChild(t),t.appendChild(s),r(n.props,n.props);function r(i,o){var a=vo(e),c=a.box,l=a.content,u=a.arrow;o.theme?c.setAttribute("data-theme",o.theme):c.removeAttribute("data-theme"),typeof o.animation=="string"?c.setAttribute("data-animation",o.animation):c.removeAttribute("data-animation"),o.inertia?c.setAttribute("data-inertia",""):c.removeAttribute("data-inertia"),c.style.maxWidth=typeof o.maxWidth=="number"?o.maxWidth+"px":o.maxWidth,o.role?c.setAttribute("role",o.role):c.removeAttribute("role"),(i.content!==o.content||i.allowHTML!==o.allowHTML)&&bc(l,n.props),o.arrow?u?i.arrow!==o.arrow&&(c.removeChild(u),c.appendChild(yc(o.arrow))):c.appendChild(yc(o.arrow)):u&&c.removeChild(u)}return{popper:e,onUpdate:r}}kl.$$tippy=!0;var rf=1,Nr=[],oo=[];function of(n,e){var t=_c(n,Object.assign({},en,xl(pc(e)))),s,r,i,o=!1,a=!1,c=!1,l=!1,u,h,d,p=[],f=dc(kt,t.interactiveDebounce),v,g=rf++,y=null,x=Bd(t.plugins),T={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},m={id:g,reference:n,popper:er(),popperInstance:y,props:t,state:T,plugins:x,clearDelayTimeouts:at,setProps:Yt,setContent:$t,show:In,hide:jn,hideWithInteractivity:zn,enable:nt,disable:Et,unmount:Vs,destroy:Ve};if(!t.render)return m;var b=t.render(m),w=b.popper,C=b.onUpdate;w.setAttribute("data-tippy-root",""),w.id="tippy-"+m.id,m.popper=w,n._tippy=m,w._tippy=m;var k=x.map(function(E){return E.fn(m)}),M=n.hasAttribute("aria-expanded");return ve(),Z(),F(),K("onCreate",[m]),t.showOnCreate&&De(),w.addEventListener("mouseenter",function(){m.props.interactive&&m.state.isVisible&&m.clearDelayTimeouts()}),w.addEventListener("mouseleave",function(){m.props.interactive&&m.props.trigger.indexOf("mouseenter")>=0&&R().addEventListener("mousemove",f)}),m;function O(){var E=m.props.touch;return Array.isArray(E)?E:[E,0]}function N(){return O()[0]==="hold"}function I(){var E;return!!((E=m.props.render)!=null&&E.$$tippy)}function P(){return v||n}function R(){var E=P().parentNode;return E?Hd(E):document}function V(){return vo(w)}function L(E){return m.state.isMounted&&!m.state.isVisible||un.isTouch||u&&u.type==="focus"?0:so(m.props.delay,E?0:1,en.delay)}function F(E){E===void 0&&(E=!1),w.style.pointerEvents=m.props.interactive&&!E?"":"none",w.style.zIndex=""+m.props.zIndex}function K(E,J,re){if(re===void 0&&(re=!0),k.forEach(function(D){D[E]&&D[E].apply(D,J)}),re){var Ce;(Ce=m.props)[E].apply(Ce,J)}}function z(){var E=m.props.aria;if(E.content){var J="aria-"+E.content,re=w.id,Ce=us(m.props.triggerTarget||n);Ce.forEach(function(D){var U=D.getAttribute(J);if(m.state.isVisible)D.setAttribute(J,U?U+" "+re:re);else{var se=U&&U.replace(re,"").trim();se?D.setAttribute(J,se):D.removeAttribute(J)}})}}function Z(){if(!(M||!m.props.aria.expanded)){var E=us(m.props.triggerTarget||n);E.forEach(function(J){m.props.interactive?J.setAttribute("aria-expanded",m.state.isVisible&&J===P()?"true":"false"):J.removeAttribute("aria-expanded")})}}function G(){R().removeEventListener("mousemove",f),Nr=Nr.filter(function(E){return E!==f})}function X(E){if(!(un.isTouch&&(c||E.type==="mousedown"))){var J=E.composedPath&&E.composedPath()[0]||E.target;if(!(m.props.interactive&&gc(w,J))){if(us(m.props.triggerTarget||n).some(function(re){return gc(re,J)})){if(un.isTouch||m.state.isVisible&&m.props.trigger.indexOf("click")>=0)return}else K("onClickOutside",[m,E]);m.props.hideOnClick===!0&&(m.clearDelayTimeouts(),m.hide(),a=!0,setTimeout(function(){a=!1}),m.state.isMounted||ne())}}}function ce(){c=!0}function me(){c=!1}function ee(){var E=R();E.addEventListener("mousedown",X,!0),E.addEventListener("touchend",X,Xn),E.addEventListener("touchstart",me,Xn),E.addEventListener("touchmove",ce,Xn)}function ne(){var E=R();E.removeEventListener("mousedown",X,!0),E.removeEventListener("touchend",X,Xn),E.removeEventListener("touchstart",me,Xn),E.removeEventListener("touchmove",ce,Xn)}function _e(E,J){xe(E,function(){!m.state.isVisible&&w.parentNode&&w.parentNode.contains(w)&&J()})}function q(E,J){xe(E,J)}function xe(E,J){var re=V().box;function Ce(D){D.target===re&&(io(re,"remove",Ce),J())}if(E===0)return J();io(re,"remove",h),io(re,"add",Ce),h=Ce}function Oe(E,J,re){re===void 0&&(re=!1);var Ce=us(m.props.triggerTarget||n);Ce.forEach(function(D){D.addEventListener(E,J,re),p.push({node:D,eventType:E,handler:J,options:re})})}function ve(){N()&&(Oe("touchstart",$e,{passive:!0}),Oe("touchend",B,{passive:!0})),Ld(m.props.trigger).forEach(function(E){if(E!=="manual")switch(Oe(E,$e),E){case"mouseenter":Oe("mouseleave",B);break;case"focus":Oe(Kd?"focusout":"blur",Y);break;case"focusin":Oe("focusout",Y);break}})}function he(){p.forEach(function(E){var J=E.node,re=E.eventType,Ce=E.handler,D=E.options;J.removeEventListener(re,Ce,D)}),p=[]}function $e(E){var J,re=!1;if(!(!m.state.isEnabled||ke(E)||a)){var Ce=((J=u)==null?void 0:J.type)==="focus";u=E,v=E.currentTarget,Z(),!m.state.isVisible&&Wd(E)&&Nr.forEach(function(D){return D(E)}),E.type==="click"&&(m.props.trigger.indexOf("mouseenter")<0||o)&&m.props.hideOnClick!==!1&&m.state.isVisible?re=!0:De(E),E.type==="click"&&(o=!re),re&&!Ce&&Pe(E)}}function kt(E){var J=E.target,re=P().contains(J)||w.contains(J);if(!(E.type==="mousemove"&&re)){var Ce=Ie().concat(w).map(function(D){var U,se=D._tippy,Q=(U=se.popperInstance)==null?void 0:U.state;return Q?{popperRect:D.getBoundingClientRect(),popperState:Q,props:t}:null}).filter(Boolean);Gd(Ce,E)&&(G(),Pe(E))}}function B(E){var J=ke(E)||m.props.trigger.indexOf("click")>=0&&o;if(!J){if(m.props.interactive){m.hideWithInteractivity(E);return}Pe(E)}}function Y(E){m.props.trigger.indexOf("focusin")<0&&E.target!==P()||m.props.interactive&&E.relatedTarget&&w.contains(E.relatedTarget)||Pe(E)}function ke(E){return un.isTouch?N()!==E.type.indexOf("touch")>=0:!1}function fe(){le();var E=m.props,J=E.popperOptions,re=E.placement,Ce=E.offset,D=E.getReferenceClientRect,U=E.moveTransition,se=I()?vo(w).arrow:null,Q=D?{getBoundingClientRect:D,contextElement:D.contextElement||P()}:n,He={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Lt){var Mt=Lt.state;if(I()){var Hn=V(),_n=Hn.box;["placement","reference-hidden","escaped"].forEach(function(yn){yn==="placement"?_n.setAttribute("data-placement",Mt.placement):Mt.attributes.popper["data-popper-"+yn]?_n.setAttribute("data-"+yn,""):_n.removeAttribute("data-"+yn)}),Mt.attributes.popper={}}}},ut=[{name:"offset",options:{offset:Ce}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!U}},He];I()&&se&&ut.push({name:"arrow",options:{element:se,padding:3}}),ut.push.apply(ut,(J==null?void 0:J.modifiers)||[]),m.popperInstance=Rd(Q,w,Object.assign({},J,{placement:re,onFirstUpdate:d,modifiers:ut}))}function le(){m.popperInstance&&(m.popperInstance.destroy(),m.popperInstance=null)}function ge(){var E=m.props.appendTo,J,re=P();m.props.interactive&&E===bl||E==="parent"?J=re.parentNode:J=wl(E,[re]),J.contains(w)||J.appendChild(w),m.state.isMounted=!0,fe()}function Ie(){return Gr(w.querySelectorAll("[data-tippy-root]"))}function De(E){m.clearDelayTimeouts(),E&&K("onTrigger",[m,E]),ee();var J=L(!0),re=O(),Ce=re[0],D=re[1];un.isTouch&&Ce==="hold"&&D&&(J=D),J?s=setTimeout(function(){m.show()},J):m.show()}function Pe(E){if(m.clearDelayTimeouts(),K("onUntrigger",[m,E]),!m.state.isVisible){ne();return}if(!(m.props.trigger.indexOf("mouseenter")>=0&&m.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(E.type)>=0&&o)){var J=L(!1);J?r=setTimeout(function(){m.state.isVisible&&m.hide()},J):i=requestAnimationFrame(function(){m.hide()})}}function nt(){m.state.isEnabled=!0}function Et(){m.hide(),m.state.isEnabled=!1}function at(){clearTimeout(s),clearTimeout(r),cancelAnimationFrame(i)}function Yt(E){if(!m.state.isDestroyed){K("onBeforeUpdate",[m,E]),he();var J=m.props,re=_c(n,Object.assign({},J,pc(E),{ignoreAttributes:!0}));m.props=re,ve(),J.interactiveDebounce!==re.interactiveDebounce&&(G(),f=dc(kt,re.interactiveDebounce)),J.triggerTarget&&!re.triggerTarget?us(J.triggerTarget).forEach(function(Ce){Ce.removeAttribute("aria-expanded")}):re.triggerTarget&&n.removeAttribute("aria-expanded"),Z(),F(),C&&C(J,re),m.popperInstance&&(fe(),Ie().forEach(function(Ce){requestAnimationFrame(Ce._tippy.popperInstance.forceUpdate)})),K("onAfterUpdate",[m,E])}}function $t(E){m.setProps({content:E})}function In(){var E=m.state.isVisible,J=m.state.isDestroyed,re=!m.state.isEnabled,Ce=un.isTouch&&!m.props.touch,D=so(m.props.duration,0,en.duration);if(!(E||J||re||Ce)&&!P().hasAttribute("disabled")&&(K("onShow",[m],!1),m.props.onShow(m)!==!1)){if(m.state.isVisible=!0,I()&&(w.style.visibility="visible"),F(),ee(),m.state.isMounted||(w.style.transition="none"),I()){var U=V(),se=U.box,Q=U.content;ro([se,Q],0)}d=function(){var ut;if(!(!m.state.isVisible||l)){if(l=!0,w.offsetHeight,w.style.transition=m.props.moveTransition,I()&&m.props.animation){var Kt=V(),Lt=Kt.box,Mt=Kt.content;ro([Lt,Mt],D),mc([Lt,Mt],"visible")}z(),Z(),fc(oo,m),(ut=m.popperInstance)==null||ut.forceUpdate(),K("onMount",[m]),m.props.animation&&I()&&q(D,function(){m.state.isShown=!0,K("onShown",[m])})}},ge()}}function jn(){var E=!m.state.isVisible,J=m.state.isDestroyed,re=!m.state.isEnabled,Ce=so(m.props.duration,1,en.duration);if(!(E||J||re)&&(K("onHide",[m],!1),m.props.onHide(m)!==!1)){if(m.state.isVisible=!1,m.state.isShown=!1,l=!1,o=!1,I()&&(w.style.visibility="hidden"),G(),ne(),F(!0),I()){var D=V(),U=D.box,se=D.content;m.props.animation&&(ro([U,se],Ce),mc([U,se],"hidden"))}z(),Z(),m.props.animation?I()&&_e(Ce,m.unmount):m.unmount()}}function zn(E){R().addEventListener("mousemove",f),fc(Nr,f),f(E)}function Vs(){m.state.isVisible&&m.hide(),m.state.isMounted&&(le(),Ie().forEach(function(E){E._tippy.unmount()}),w.parentNode&&w.parentNode.removeChild(w),oo=oo.filter(function(E){return E!==m}),m.state.isMounted=!1,K("onHidden",[m]))}function Ve(){m.state.isDestroyed||(m.clearDelayTimeouts(),m.unmount(),he(),delete n._tippy,m.state.isDestroyed=!0,K("onDestroy",[m]))}}function hr(n,e){e===void 0&&(e={});var t=en.plugins.concat(e.plugins||[]);Yd();var s=Object.assign({},e,{plugins:t}),r=zd(n),i=r.reduce(function(o,a){var c=a&&of(a,s);return c&&o.push(c),o},[]);return ui(n)?i[0]:i}hr.defaultProps=en;hr.setDefaultProps=tf;hr.currentInput=un;Object.assign({},ll,{effect:function(e){var t=e.state,s={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,s.popper),t.styles=s,t.elements.arrow&&Object.assign(t.elements.arrow.style,s.arrow)}});hr.setDefaultProps({render:kl});const Cl="15.0.4",wc=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),Tc=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),_o=(n,e)=>({startTime:e,type:"setValue",value:n}),Sl=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),Al=(n,e,{startTime:t,target:s,timeConstant:r})=>s+(e-s)*Math.exp((t-n)/r),ds=n=>n.type==="exponentialRampToValue",Xr=n=>n.type==="linearRampToValue",Pn=n=>ds(n)||Xr(n),zo=n=>n.type==="setValue",Tn=n=>n.type==="setValueCurve",Zr=(n,e,t,s)=>{const r=n[e];return r===void 0?s:Pn(r)||zo(r)?r.value:Tn(r)?r.values[r.values.length-1]:Al(t,Zr(n,e-1,r.startTime,s),r)},xc=(n,e,t,s,r)=>t===void 0?[s.insertTime,r]:Pn(t)?[t.endTime,t.value]:zo(t)?[t.startTime,t.value]:Tn(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,Zr(n,e-1,t.startTime,r)],yo=n=>n.type==="cancelAndHold",bo=n=>n.type==="cancelScheduledValues",Nn=n=>yo(n)||bo(n)?n.cancelTime:ds(n)||Xr(n)?n.endTime:n.startTime,kc=(n,e,t,{endTime:s,value:r})=>t===r?r:0<t&&0<r||t<0&&r<0?t*(r/t)**((n-e)/(s-e)):0,Cc=(n,e,t,{endTime:s,value:r})=>t+(n-e)/(s-e)*(r-t),af=(n,e)=>{const t=Math.floor(e),s=Math.ceil(e);return t===s?n[t]:(1-(e-t))*n[t]+(1-(s-e))*n[s]},cf=(n,{duration:e,startTime:t,values:s})=>{const r=(n-t)/e*(s.length-1);return af(s,r)},Er=n=>n.type==="setTarget";class lf{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=Nn(e);if(yo(e)||bo(e)){const s=this._automationEvents.findIndex(i=>bo(e)&&Tn(i)?i.startTime+i.duration>=t:Nn(i)>=t),r=this._automationEvents[s];if(s!==-1&&(this._automationEvents=this._automationEvents.slice(0,s)),yo(e)){const i=this._automationEvents[this._automationEvents.length-1];if(r!==void 0&&Pn(r)){if(i!==void 0&&Er(i))throw new Error("The internal list is malformed.");const o=i===void 0?r.insertTime:Tn(i)?i.startTime+i.duration:Nn(i),a=i===void 0?this._defaultValue:Tn(i)?i.values[i.values.length-1]:i.value,c=ds(r)?kc(t,o,a,r):Cc(t,o,a,r),l=ds(r)?wc(c,t,this._currenTime):Tc(c,t,this._currenTime);this._automationEvents.push(l)}if(i!==void 0&&Er(i)&&this._automationEvents.push(_o(this.getValue(t),t)),i!==void 0&&Tn(i)&&i.startTime+i.duration>t){const o=t-i.startTime,a=(i.values.length-1)/i.duration,c=Math.max(2,1+Math.ceil(o*a)),l=o/(c-1)*a,u=i.values.slice(0,c);if(l<1)for(let h=1;h<c;h+=1){const d=l*h%1;u[h]=i.values[h-1]*(1-d)+i.values[h]*d}this._automationEvents[this._automationEvents.length-1]=Sl(u,i.startTime,o)}}}else{const s=this._automationEvents.findIndex(o=>Nn(o)>t),r=s===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[s-1];if(r!==void 0&&Tn(r)&&Nn(r)+r.duration>t)return!1;const i=ds(e)?wc(e.value,e.endTime,this._currenTime):Xr(e)?Tc(e.value,t,this._currenTime):e;if(s===-1)this._automationEvents.push(i);else{if(Tn(e)&&t+e.duration>Nn(this._automationEvents[s]))return!1;this._automationEvents.splice(s,0,i)}}return!0}flush(e){const t=this._automationEvents.findIndex(s=>Nn(s)>e);if(t>1){const s=this._automationEvents.slice(t-1),r=s[0];Er(r)&&s.unshift(_o(Zr(this._automationEvents,t-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=s}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(o=>Nn(o)>e),s=this._automationEvents[t],r=(t===-1?this._automationEvents.length:t)-1,i=this._automationEvents[r];if(i!==void 0&&Er(i)&&(s===void 0||!Pn(s)||s.insertTime>e))return Al(e,Zr(this._automationEvents,r-1,i.startTime,this._defaultValue),i);if(i!==void 0&&zo(i)&&(s===void 0||!Pn(s)))return i.value;if(i!==void 0&&Tn(i)&&(s===void 0||!Pn(s)||i.startTime+i.duration>e))return e<i.startTime+i.duration?cf(e,i):i.values[i.values.length-1];if(i!==void 0&&Pn(i)&&(s===void 0||!Pn(s)))return i.value;if(s!==void 0&&ds(s)){const[o,a]=xc(this._automationEvents,r,i,s,this._defaultValue);return kc(e,o,a,s)}if(s!==void 0&&Xr(s)){const[o,a]=xc(this._automationEvents,r,i,s,this._defaultValue);return Cc(e,o,a,s)}return this._defaultValue}}const uf=n=>({cancelTime:n,type:"cancelAndHold"}),hf=n=>({cancelTime:n,type:"cancelScheduledValues"}),df=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),ff=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),pf=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),mf=()=>new DOMException("","AbortError"),gf=n=>(e,t,[s,r,i],o)=>{n(e[r],[t,s,i],a=>a[0]===t&&a[1]===s,o)},vf=n=>(e,t,s)=>{const r=[];for(let i=0;i<s.numberOfInputs;i+=1)r.push(new Set);n.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},_f=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},xs=new WeakSet,Ol=new WeakMap,Ho=new WeakMap,Il=new WeakMap,Go=new WeakMap,hi=new WeakMap,Nl=new WeakMap,wo=new WeakMap,To=new WeakMap,xo=new WeakMap,El={construct(){return El}},yf=n=>{try{const e=new Proxy(n,El);new e}catch{return!1}return!0},Sc=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Ac=(n,e)=>{const t=[];let s=n.replace(/^[\s]+/,""),r=s.match(Sc);for(;r!==null;){const i=r[1].slice(1,-1),o=r[0].replace(/([\s]+)?;?$/,"").replace(i,new URL(i,e).toString());t.push(o),s=s.slice(r[0].length).replace(/^[\s]+/,""),r=s.match(Sc)}return[t.join(";"),s]},Oc=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Ic=n=>{if(!yf(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},bf=(n,e,t,s,r,i,o,a,c,l,u,h,d)=>{let p=0;return(f,v,g={credentials:"omit"})=>{const y=u.get(f);if(y!==void 0&&y.has(v))return Promise.resolve();const x=l.get(f);if(x!==void 0){const b=x.get(v);if(b!==void 0)return b}const T=i(f),m=T.audioWorklet===void 0?r(v).then(([b,w])=>{const[C,k]=Ac(b,w),M=`${C};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${k}
})})(window,'_AWGS')`;return t(M)}).then(()=>{const b=d._AWGS.pop();if(b===void 0)throw new SyntaxError;s(T.currentTime,T.sampleRate,()=>b(class{},void 0,(w,C)=>{if(w.trim()==="")throw e();const k=To.get(T);if(k!==void 0){if(k.has(w))throw e();Ic(C),Oc(C.parameterDescriptors),k.set(w,C)}else Ic(C),Oc(C.parameterDescriptors),To.set(T,new Map([[w,C]]))},T.sampleRate,void 0,void 0))}):Promise.all([r(v),Promise.resolve(n(h,h))]).then(([[b,w],C])=>{const k=p+1;p=k;const[M,O]=Ac(b,w),R=`${M};((AudioWorkletProcessor,registerProcessor)=>{${O}
})(${C?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${C?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${C?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${k}',class extends AudioWorkletProcessor{process(){return !1}})`,V=new Blob([R],{type:"application/javascript; charset=utf-8"}),L=URL.createObjectURL(V);return T.audioWorklet.addModule(L,g).then(()=>{if(a(T))return T;const F=o(T);return F.audioWorklet.addModule(L,g).then(()=>F)}).then(F=>{if(c===null)throw new SyntaxError;try{new c(F,`__sac${k}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(L))});return x===void 0?l.set(f,new Map([[v,m]])):x.set(v,m),m.then(()=>{const b=u.get(f);b===void 0?u.set(f,new Set([v])):b.add(v)}).finally(()=>{const b=l.get(f);b!==void 0&&b.delete(v)}),m}},sn=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},di=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[s]=t;return n.delete(s),s},Ml=(n,e,t,s)=>{const r=sn(n,e),i=di(r,o=>o[0]===t&&o[1]===s);return r.size===0&&n.delete(e),i},dr=n=>sn(Nl,n),ks=n=>{if(xs.has(n))throw new Error("The AudioNode is already stored.");xs.add(n),dr(n).forEach(e=>e(!0))},Dl=n=>"port"in n,fr=n=>{if(!xs.has(n))throw new Error("The AudioNode is not stored.");xs.delete(n),dr(n).forEach(e=>e(!1))},ko=(n,e)=>{!Dl(n)&&e.every(t=>t.size===0)&&fr(n)},wf=(n,e,t,s,r,i,o,a,c,l,u,h,d)=>{const p=new WeakMap;return(f,v,g,y,x)=>{const{activeInputs:T,passiveInputs:m}=i(v),{outputs:b}=i(f),w=a(f),C=k=>{const M=c(v),O=c(f);if(k){const N=Ml(m,f,g,y);n(T,f,N,!1),!x&&!h(f)&&t(O,M,g,y),d(v)&&ks(v)}else{const N=s(T,f,g,y);e(m,y,N,!1),!x&&!h(f)&&r(O,M,g,y);const I=o(v);if(I===0)u(v)&&ko(v,T);else{const P=p.get(v);P!==void 0&&clearTimeout(P),p.set(v,setTimeout(()=>{u(v)&&ko(v,T)},I*1e3))}}};return l(b,[v,g,y],k=>k[0]===v&&k[1]===g&&k[2]===y,!0)?(w.add(C),u(f)?n(T,f,[g,y,C],!0):e(m,y,[f,g,C],!0),!0):!1}},Tf=n=>(e,t,[s,r,i],o)=>{const a=e.get(s);a===void 0?e.set(s,new Set([[r,t,i]])):n(a,[r,t,i],c=>c[0]===r&&c[1]===t,o)},xf=n=>(e,t)=>{const s=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(s).connect(e.destination);const r=()=>{t.removeEventListener("ended",r),t.disconnect(s),s.disconnect()};t.addEventListener("ended",r)},kf=n=>(e,t)=>{n(e).add(t)},Cf={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Sf=(n,e,t,s,r,i)=>class extends n{constructor(a,c){const l=r(a),u={...Cf,...c},h=s(l,u),d=i(l)?e():null;super(a,!1,h,d),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},vt=(n,e)=>n.context===e,Af=(n,e,t)=>()=>{const s=new WeakMap,r=async(i,o)=>{let a=e(i);if(!vt(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=n(o,l)}return s.set(o,a),await t(i,o,a),a};return{render(i,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},Yr=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},mn=()=>new DOMException("","IndexSizeError"),Xo=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(s){throw s.code===12?mn():s}})(n.getChannelData)},Of={numberOfChannels:1},If=(n,e,t,s,r,i,o,a)=>{let c=null;return class Pl{constructor(u){if(r===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:d,sampleRate:p}={...Of,...u};c===null&&(c=new r(1,1,44100));const f=s!==null&&e(i,i)?new s({length:h,numberOfChannels:d,sampleRate:p}):c.createBuffer(d,h,p);if(f.numberOfChannels===0)throw t();return typeof f.copyFromChannel!="function"?(o(f),Xo(f)):e(Yr,()=>Yr(f))||a(f),n.add(f),f}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===Pl.prototype||n.has(u)}}},St=-34028234663852886e22,bt=-St,xn=n=>xs.has(n),Nf={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Ef=(n,e,t,s,r,i,o,a)=>class extends n{constructor(l,u){const h=i(l),d={...Nf,...u},p=r(h,d),f=o(h),v=f?e():null;super(l,!1,p,v),this._audioBufferSourceNodeRenderer=v,this._isBufferNullified=!1,this._isBufferSet=d.buffer!==null,this._nativeAudioBufferSourceNode=p,this._onended=null,this._playbackRate=t(this,f,p.playbackRate,bt,St)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw s();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===u?l:h}get playbackRate(){return this._playbackRate}start(l=0,u=0,h){if(this._nativeAudioBufferSourceNode.start(l,u,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[l,u]:[l,u,h]),this.context.state!=="closed"){ks(this);const d=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",d),xn(this)&&fr(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",d)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},Mf=(n,e,t,s,r)=>()=>{const i=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let h=t(l);const d=vt(h,u);if(!d){const p={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(u,p),o!==null&&h.start(...o),a!==null&&h.stop(a)}return i.set(u,h),d?await n(u,l.playbackRate,h.playbackRate):await s(u,l.playbackRate,h.playbackRate),await r(l,u,h),h};return{set start(l){o=l},set stop(l){a=l},render(l,u){const h=i.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},Df=n=>"playbackRate"in n,Pf=n=>"frequency"in n&&"gain"in n,Rf=n=>"offset"in n,Ff=n=>!("frequency"in n)&&"gain"in n,Vf=n=>"detune"in n&&"frequency"in n&&!("gain"in n),Lf=n=>"pan"in n,wt=n=>sn(Ol,n),pr=n=>sn(Il,n),Co=(n,e)=>{const{activeInputs:t}=wt(n);t.forEach(r=>r.forEach(([i])=>{e.includes(n)||Co(i,[...e,n])}));const s=Df(n)?[n.playbackRate]:Dl(n)?Array.from(n.parameters.values()):Pf(n)?[n.Q,n.detune,n.frequency,n.gain]:Rf(n)?[n.offset]:Ff(n)?[n.gain]:Vf(n)?[n.detune,n.frequency]:Lf(n)?[n.pan]:[];for(const r of s){const i=pr(r);i!==void 0&&i.activeInputs.forEach(([o])=>Co(o,e))}xn(n)&&fr(n)},Rl=n=>{Co(n.destination,[])},Bf=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),Uf=(n,e,t,s,r,i,o,a,c)=>class extends n{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new c(u)}catch(f){throw f.code===12&&f.message==="sampleRate is not in range"?t():f}if(h===null)throw s();if(!Bf(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&h.sampleRate!==u.sampleRate)throw t();super(h,2);const{latencyHint:d}=u,{sampleRate:p}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:d==="balanced"?512/p:d==="interactive"||d===void 0?256/p:d==="playback"?1024/p:Math.max(2,Math.min(128,Math.round(d*p/128)))*128/p,this._nativeAudioContext=h,c.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const f=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",f)};h.addEventListener("statechange",f)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Rl(this)}))}createMediaElementSource(u){return new r(this,{mediaElement:u})}createMediaStreamDestination(){return new i(this)}createMediaStreamSource(u){return new o(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,h)=>{const d=()=>{this._nativeAudioContext.removeEventListener("statechange",d),this._nativeAudioContext.state==="running"?u():this.resume().then(u,h)};this._nativeAudioContext.addEventListener("statechange",d)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},qf=(n,e,t,s,r,i,o,a)=>class extends n{constructor(l,u){const h=i(l),d=o(h),p=r(h,u,d),f=d?e(a):null;super(l,!1,p,f),this._isNodeOfNativeOfflineAudioContext=d,this._nativeAudioDestinationNode=p}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw s();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw s();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},Wf=n=>{const e=new WeakMap,t=async(s,r)=>{const i=r.destination;return e.set(r,i),await n(s,r,i),i};return{render(s,r){const i=e.get(r);return i!==void 0?Promise.resolve(i):t(s,r)}}},jf=(n,e,t,s,r,i,o,a)=>(c,l)=>{const u=l.listener,h=()=>{const b=new Float32Array(1),w=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),C=o(l);let k=!1,M=[0,0,-1,0,1,0],O=[0,0,0];const N=()=>{if(k)return;k=!0;const V=s(l,256,9,0);V.onaudioprocess=({inputBuffer:L})=>{const F=[i(L,b,0),i(L,b,1),i(L,b,2),i(L,b,3),i(L,b,4),i(L,b,5)];F.some((z,Z)=>z!==M[Z])&&(u.setOrientation(...F),M=F);const K=[i(L,b,6),i(L,b,7),i(L,b,8)];K.some((z,Z)=>z!==O[Z])&&(u.setPosition(...K),O=K)},w.connect(V)},I=V=>L=>{L!==M[V]&&(M[V]=L,u.setOrientation(...M))},P=V=>L=>{L!==O[V]&&(O[V]=L,u.setPosition(...O))},R=(V,L,F)=>{const K=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:L});K.connect(w,0,V),K.start(),Object.defineProperty(K.offset,"defaultValue",{get(){return L}});const z=n({context:c},C,K.offset,bt,St);return a(z,"value",Z=>()=>Z.call(z),Z=>G=>{try{Z.call(z,G)}catch(X){if(X.code!==9)throw X}N(),C&&F(G)}),z.cancelAndHoldAtTime=(Z=>C?()=>{throw r()}:(...G)=>{const X=Z.apply(z,G);return N(),X})(z.cancelAndHoldAtTime),z.cancelScheduledValues=(Z=>C?()=>{throw r()}:(...G)=>{const X=Z.apply(z,G);return N(),X})(z.cancelScheduledValues),z.exponentialRampToValueAtTime=(Z=>C?()=>{throw r()}:(...G)=>{const X=Z.apply(z,G);return N(),X})(z.exponentialRampToValueAtTime),z.linearRampToValueAtTime=(Z=>C?()=>{throw r()}:(...G)=>{const X=Z.apply(z,G);return N(),X})(z.linearRampToValueAtTime),z.setTargetAtTime=(Z=>C?()=>{throw r()}:(...G)=>{const X=Z.apply(z,G);return N(),X})(z.setTargetAtTime),z.setValueAtTime=(Z=>C?()=>{throw r()}:(...G)=>{const X=Z.apply(z,G);return N(),X})(z.setValueAtTime),z.setValueCurveAtTime=(Z=>C?()=>{throw r()}:(...G)=>{const X=Z.apply(z,G);return N(),X})(z.setValueCurveAtTime),z};return{forwardX:R(0,0,I(0)),forwardY:R(1,0,I(1)),forwardZ:R(2,-1,I(2)),positionX:R(6,0,P(0)),positionY:R(7,0,P(1)),positionZ:R(8,0,P(2)),upX:R(3,0,I(3)),upY:R(4,1,I(4)),upZ:R(5,0,I(5))}},{forwardX:d,forwardY:p,forwardZ:f,positionX:v,positionY:g,positionZ:y,upX:x,upY:T,upZ:m}=u.forwardX===void 0?h():u;return{get forwardX(){return d},get forwardY(){return p},get forwardZ(){return f},get positionX(){return v},get positionY(){return g},get positionZ(){return y},get upX(){return x},get upY(){return T},get upZ(){return m}}},$r=n=>"context"in n,mr=n=>$r(n[0]),ss=(n,e,t,s)=>{for(const r of n)if(t(r)){if(s)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},Nc=(n,e,[t,s],r)=>{ss(n,[e,t,s],i=>i[0]===e&&i[1]===t,r)},Ec=(n,[e,t,s],r)=>{const i=n.get(e);i===void 0?n.set(e,new Set([[t,s]])):ss(i,[t,s],o=>o[0]===t,r)},Es=n=>"inputs"in n,Kr=(n,e,t,s)=>{if(Es(e)){const r=e.inputs[s];return n.connect(r,t,0),[r,t,0]}return n.connect(e,t,s),[e,t,s]},Fl=(n,e,t)=>{for(const s of n)if(s[0]===e&&s[1]===t)return n.delete(s),s;return null},zf=(n,e,t)=>di(n,s=>s[0]===e&&s[1]===t),Vl=(n,e)=>{if(!dr(n).delete(e))throw new Error("Missing the expected event listener.")},Ll=(n,e,t)=>{const s=sn(n,e),r=di(s,i=>i[0]===t);return s.size===0&&n.delete(e),r},Jr=(n,e,t,s)=>{Es(e)?n.disconnect(e.inputs[s],t,0):n.disconnect(e,t,s)},qe=n=>sn(Ho,n),ir=n=>sn(Go,n),Qn=n=>wo.has(n),jr=n=>!xs.has(n),Mc=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const s=n.createScriptProcessor(256,1,1),r=n.createGain(),i=n.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const a=n.createBufferSource();a.buffer=i,a.loop=!0,a.connect(s).connect(n.destination),a.connect(r),a.disconnect(r),s.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?t(!0):t(!1),a.stop(),s.onaudioprocess=null,a.disconnect(s),s.disconnect(n.destination)},a.start()}}),ao=(n,e)=>{const t=new Map;for(const s of n)for(const r of s){const i=t.get(r);t.set(r,i===void 0?1:i+1)}t.forEach((s,r)=>e(r,s))},Qr=n=>"context"in n,Hf=n=>{const e=new Map;n.connect=(t=>(s,r=0,i=0)=>{const o=Qr(s)?t(s,r,i):t(s,r),a=e.get(s);return a===void 0?e.set(s,[{input:i,output:r}]):a.every(c=>c.input!==i||c.output!==r)&&a.push({input:i,output:r}),o})(n.connect.bind(n)),n.disconnect=(t=>(s,r,i)=>{if(t.apply(n),s===void 0)e.clear();else if(typeof s=="number")for(const[o,a]of e){const c=a.filter(l=>l.output!==s);c.length===0?e.delete(o):e.set(o,c)}else if(e.has(s))if(r===void 0)e.delete(s);else{const o=e.get(s);if(o!==void 0){const a=o.filter(c=>c.output!==r&&(c.input!==i||i===void 0));a.length===0?e.delete(s):e.set(s,a)}}for(const[o,a]of e)a.forEach(c=>{Qr(o)?n.connect(o,c.output,c.input):n.connect(o,c.output)})})(n.disconnect)},Gf=(n,e,t,s)=>{const{activeInputs:r,passiveInputs:i}=pr(e),{outputs:o}=wt(n),a=dr(n),c=l=>{const u=qe(n),h=ir(e);if(l){const d=Ll(i,n,t);Nc(r,n,d,!1),!s&&!Qn(n)&&u.connect(h,t)}else{const d=zf(r,n,t);Ec(i,d,!1),!s&&!Qn(n)&&u.disconnect(h,t)}};return ss(o,[e,t],l=>l[0]===e&&l[1]===t,!0)?(a.add(c),xn(n)?Nc(r,n,[t,c],!0):Ec(i,[n,t,c],!0),!0):!1},Xf=(n,e,t,s)=>{const{activeInputs:r,passiveInputs:i}=wt(e),o=Fl(r[s],n,t);return o===null?[Ml(i,n,t,s)[2],!1]:[o[2],!0]},Zf=(n,e,t)=>{const{activeInputs:s,passiveInputs:r}=pr(e),i=Fl(s,n,t);return i===null?[Ll(r,n,t)[1],!1]:[i[2],!0]},Zo=(n,e,t,s,r)=>{const[i,o]=Xf(n,t,s,r);if(i!==null&&(Vl(n,i),o&&!e&&!Qn(n)&&Jr(qe(n),qe(t),s,r)),xn(t)){const{activeInputs:a}=wt(t);ko(t,a)}},Yo=(n,e,t,s)=>{const[r,i]=Zf(n,t,s);r!==null&&(Vl(n,r),i&&!e&&!Qn(n)&&qe(n).disconnect(ir(t),s))},Yf=(n,e)=>{const t=wt(n),s=[];for(const r of t.outputs)mr(r)?Zo(n,e,...r):Yo(n,e,...r),s.push(r[0]);return t.outputs.clear(),s},$f=(n,e,t)=>{const s=wt(n),r=[];for(const i of s.outputs)i[1]===t&&(mr(i)?Zo(n,e,...i):Yo(n,e,...i),r.push(i[0]),s.outputs.delete(i));return r},Kf=(n,e,t,s,r)=>{const i=wt(n);return Array.from(i.outputs).filter(o=>o[0]===t&&(s===void 0||o[1]===s)&&(r===void 0||o[2]===r)).map(o=>(mr(o)?Zo(n,e,...o):Yo(n,e,...o),i.outputs.delete(o),o[0]))},Jf=(n,e,t,s,r,i,o,a,c,l,u,h,d,p,f,v)=>class extends l{constructor(y,x,T,m){super(T),this._context=y,this._nativeAudioNode=T;const b=u(y);h(b)&&t(Mc,()=>Mc(b,v))!==!0&&Hf(T),Ho.set(this,T),Nl.set(this,new Set),y.state!=="closed"&&x&&ks(this),n(this,m,T)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(y){this._nativeAudioNode.channelCount=y}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(y){this._nativeAudioNode.channelCountMode=y}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(y){this._nativeAudioNode.channelInterpretation=y}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(y,x=0,T=0){if(x<0||x>=this._nativeAudioNode.numberOfOutputs)throw r();const m=u(this._context),b=f(m);if(d(y)||p(y))throw i();if($r(y)){const k=qe(y);try{const O=Kr(this._nativeAudioNode,k,x,T),N=jr(this);(b||N)&&this._nativeAudioNode.disconnect(...O),this.context.state!=="closed"&&!N&&jr(y)&&ks(y)}catch(O){throw O.code===12?i():O}if(e(this,y,x,T,b)){const O=c([this],y);ao(O,s(b))}return y}const w=ir(y);if(w.name==="playbackRate"&&w.maxValue===1024)throw o();try{this._nativeAudioNode.connect(w,x),(b||jr(this))&&this._nativeAudioNode.disconnect(w,x)}catch(k){throw k.code===12?i():k}if(Gf(this,y,x,b)){const k=c([this],y);ao(k,s(b))}}disconnect(y,x,T){let m;const b=u(this._context),w=f(b);if(y===void 0)m=Yf(this,w);else if(typeof y=="number"){if(y<0||y>=this.numberOfOutputs)throw r();m=$f(this,w,y)}else{if(x!==void 0&&(x<0||x>=this.numberOfOutputs)||$r(y)&&T!==void 0&&(T<0||T>=y.numberOfInputs))throw r();if(m=Kf(this,w,y,x,T),m.length===0)throw i()}for(const C of m){const k=c([this],C);ao(k,a)}}},Qf=(n,e,t,s,r,i,o,a,c,l,u,h,d)=>(p,f,v,g=null,y=null)=>{const x=v.value,T=new lf(x),m=f?s(T):null,b={get defaultValue(){return x},get maxValue(){return g===null?v.maxValue:g},get minValue(){return y===null?v.minValue:y},get value(){return v.value},set value(w){v.value=w,b.setValueAtTime(w,p.context.currentTime)},cancelAndHoldAtTime(w){if(typeof v.cancelAndHoldAtTime=="function")m===null&&T.flush(p.context.currentTime),T.add(r(w)),v.cancelAndHoldAtTime(w);else{const C=Array.from(T).pop();m===null&&T.flush(p.context.currentTime),T.add(r(w));const k=Array.from(T).pop();v.cancelScheduledValues(w),C!==k&&k!==void 0&&(k.type==="exponentialRampToValue"?v.exponentialRampToValueAtTime(k.value,k.endTime):k.type==="linearRampToValue"?v.linearRampToValueAtTime(k.value,k.endTime):k.type==="setValue"?v.setValueAtTime(k.value,k.startTime):k.type==="setValueCurve"&&v.setValueCurveAtTime(k.values,k.startTime,k.duration))}return b},cancelScheduledValues(w){return m===null&&T.flush(p.context.currentTime),T.add(i(w)),v.cancelScheduledValues(w),b},exponentialRampToValueAtTime(w,C){if(w===0)throw new RangeError;if(!Number.isFinite(C)||C<0)throw new RangeError;const k=p.context.currentTime;return m===null&&T.flush(k),Array.from(T).length===0&&(T.add(l(x,k)),v.setValueAtTime(x,k)),T.add(o(w,C)),v.exponentialRampToValueAtTime(w,C),b},linearRampToValueAtTime(w,C){const k=p.context.currentTime;return m===null&&T.flush(k),Array.from(T).length===0&&(T.add(l(x,k)),v.setValueAtTime(x,k)),T.add(a(w,C)),v.linearRampToValueAtTime(w,C),b},setTargetAtTime(w,C,k){return m===null&&T.flush(p.context.currentTime),T.add(c(w,C,k)),v.setTargetAtTime(w,C,k),b},setValueAtTime(w,C){return m===null&&T.flush(p.context.currentTime),T.add(l(w,C)),v.setValueAtTime(w,C),b},setValueCurveAtTime(w,C,k){const M=w instanceof Float32Array?w:new Float32Array(w);if(h!==null&&h.name==="webkitAudioContext"){const O=C+k,N=p.context.sampleRate,I=Math.ceil(C*N),P=Math.floor(O*N),R=P-I,V=new Float32Array(R);for(let F=0;F<R;F+=1){const K=(M.length-1)/k*((I+F)/N-C),z=Math.floor(K),Z=Math.ceil(K);V[F]=z===Z?M[z]:(1-(K-z))*M[z]+(1-(Z-K))*M[Z]}m===null&&T.flush(p.context.currentTime),T.add(u(V,C,k)),v.setValueCurveAtTime(V,C,k);const L=P/N;L<O&&d(b,V[V.length-1],L),d(b,M[M.length-1],O)}else m===null&&T.flush(p.context.currentTime),T.add(u(M,C,k)),v.setValueCurveAtTime(M,C,k);return b}};return t.set(b,v),e.set(b,p),n(b,m),b},ep=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:s,value:r}=t;e.exponentialRampToValueAtTime(r,s)}else if(t.type==="linearRampToValue"){const{endTime:s,value:r}=t;e.linearRampToValueAtTime(r,s)}else if(t.type==="setTarget"){const{startTime:s,target:r,timeConstant:i}=t;e.setTargetAtTime(r,s,i)}else if(t.type==="setValue"){const{startTime:s,value:r}=t;e.setValueAtTime(r,s)}else if(t.type==="setValueCurve"){const{duration:s,startTime:r,values:i}=t;e.setValueCurveAtTime(i,r,s)}else throw new Error("Can't apply an unknown automation.")}});class Bl{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((s,r)=>e.call(t,s,r,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const tp={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},np=(n,e,t,s,r,i,o,a,c,l,u,h,d,p)=>class extends e{constructor(v,g,y){var x;const T=a(v),m=c(T),b=u({...tp,...y});d(b);const w=To.get(T),C=w==null?void 0:w.get(g),k=m||T.state!=="closed"?T:(x=o(T))!==null&&x!==void 0?x:T,M=r(k,m?null:v.baseLatency,l,g,C,b),O=m?s(g,b,C):null;super(v,!0,M,O);const N=[];M.parameters.forEach((P,R)=>{const V=t(this,m,P);N.push([R,V])}),this._nativeAudioWorkletNode=M,this._onprocessorerror=null,this._parameters=new Bl(N),m&&n(T,this);const{activeInputs:I}=i(this);h(M,I)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(v){const g=typeof v=="function"?p(this,v):null;this._nativeAudioWorkletNode.onprocessorerror=g;const y=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=y!==null&&y===g?v:y}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function ei(n,e,t,s,r){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],s,r);else{const i=n.getChannelData(s);if(e[t].byteLength===0)e[t]=i.slice(r,r+128);else{const o=new Float32Array(i.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(o)}}}const Ul=(n,e,t,s,r)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],s,r):e[t].byteLength!==0&&n.getChannelData(s).set(e[t],r)},ti=(n,e)=>{const t=[];for(let s=0;s<n;s+=1){const r=[],i=typeof e=="number"?e:e[s];for(let o=0;o<i;o+=1)r.push(new Float32Array(128));t.push(r)}return t},sp=(n,e)=>{const t=sn(xo,n),s=qe(e);return sn(t,s)},rp=async(n,e,t,s,r,i,o)=>{const a=e===null?Math.ceil(n.context.length/128)*128:e.length,c=s.channelCount*s.numberOfInputs,l=r.reduce((g,y)=>g+y,0),u=l===0?null:t.createBuffer(l,a,t.sampleRate);if(i===void 0)throw new Error("Missing the processor constructor.");const h=wt(n),d=await sp(t,n),p=ti(s.numberOfInputs,s.channelCount),f=ti(s.numberOfOutputs,r),v=Array.from(n.parameters.keys()).reduce((g,y)=>({...g,[y]:new Float32Array(128)}),{});for(let g=0;g<a;g+=128){if(s.numberOfInputs>0&&e!==null)for(let y=0;y<s.numberOfInputs;y+=1)for(let x=0;x<s.channelCount;x+=1)ei(e,p[y],x,x,g);i.parameterDescriptors!==void 0&&e!==null&&i.parameterDescriptors.forEach(({name:y},x)=>{ei(e,v,y,c+x,g)});for(let y=0;y<s.numberOfInputs;y+=1)for(let x=0;x<r[y];x+=1)f[y][x].byteLength===0&&(f[y][x]=new Float32Array(128));try{const y=p.map((T,m)=>h.activeInputs[m].size===0?[]:T),x=o(g/t.sampleRate,t.sampleRate,()=>d.process(y,f,v));if(u!==null)for(let T=0,m=0;T<s.numberOfOutputs;T+=1){for(let b=0;b<r[T];b+=1)Ul(u,f[T],b,m+b,g);m+=r[T]}if(!x)break}catch(y){n.dispatchEvent(new ErrorEvent("processorerror",{colno:y.colno,filename:y.filename,lineno:y.lineno,message:y.message}));break}}return u},ip=(n,e,t,s,r,i,o,a,c,l,u,h,d,p,f,v)=>(g,y,x)=>{const T=new WeakMap;let m=null;const b=async(w,C)=>{let k=u(w),M=null;const O=vt(k,C),N=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(h===null){const I=N.reduce((L,F)=>L+F,0),P=r(C,{channelCount:Math.max(1,I),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,I)}),R=[];for(let L=0;L<w.numberOfOutputs;L+=1)R.push(s(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:N[L]}));const V=o(C,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1});V.connect=e.bind(null,R),V.disconnect=c.bind(null,R),M=[P,R,V]}else O||(k=new h(C,g));if(T.set(C,M===null?k:M[2]),M!==null){if(m===null){if(x===void 0)throw new Error("Missing the processor constructor.");if(d===null)throw new Error("Missing the native OfflineAudioContext constructor.");const F=w.channelCount*w.numberOfInputs,K=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length,z=F+K;m=rp(w,z===0?null:await(async()=>{const G=new d(z,Math.ceil(w.context.length/128)*128,C.sampleRate),X=[],ce=[];for(let ne=0;ne<y.numberOfInputs;ne+=1)X.push(o(G,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),ce.push(r(G,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const me=await Promise.all(Array.from(w.parameters.values()).map(async ne=>{const _e=i(G,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ne.value});return await p(G,ne,_e.offset),_e})),ee=s(G,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,F+K)});for(let ne=0;ne<y.numberOfInputs;ne+=1){X[ne].connect(ce[ne]);for(let _e=0;_e<y.channelCount;_e+=1)ce[ne].connect(ee,_e,ne*y.channelCount+_e)}for(const[ne,_e]of me.entries())_e.connect(ee,0,F+ne),_e.start(0);return ee.connect(G.destination),await Promise.all(X.map(ne=>f(w,G,ne))),v(G)})(),C,y,N,x,l)}const I=await m,P=t(C,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[R,V,L]=M;I!==null&&(P.buffer=I,P.start(0)),P.connect(R);for(let F=0,K=0;F<w.numberOfOutputs;F+=1){const z=V[F];for(let Z=0;Z<N[F];Z+=1)R.connect(z,K+Z,Z);K+=N[F]}return L}if(O)for(const[I,P]of w.parameters.entries())await n(C,P,k.parameters.get(I));else for(const[I,P]of w.parameters.entries())await p(C,P,k.parameters.get(I));return await f(w,C,k),k};return{render(w,C){a(C,w);const k=T.get(C);return k!==void 0?Promise.resolve(k):b(w,C)}}},op=(n,e,t,s,r,i,o,a,c,l,u,h,d,p,f,v,g,y,x,T)=>class extends f{constructor(b,w){super(b,w),this._nativeContext=b,this._audioWorklet=n===void 0?void 0:{addModule:(C,k)=>n(this,C,k)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(b,w,C){return new t({length:w,numberOfChannels:b,sampleRate:C})}createBufferSource(){return new s(this)}createChannelMerger(b=6){return new i(this,{numberOfInputs:b})}createChannelSplitter(b=6){return new o(this,{numberOfOutputs:b})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(b=1){return new u(this,{maxDelayTime:b})}createDynamicsCompressor(){return new h(this)}createGain(){return new d(this)}createIIRFilter(b,w){return new p(this,{feedback:w,feedforward:b})}createOscillator(){return new v(this)}createPanner(){return new g(this)}createPeriodicWave(b,w,C={disableNormalization:!1}){return new y(this,{...C,imag:w,real:b})}createStereoPanner(){return new x(this)}createWaveShaper(){return new T(this)}decodeAudioData(b,w,C){return l(this._nativeContext,b).then(k=>(typeof w=="function"&&w(k),k),k=>{throw typeof C=="function"&&C(k),k})}},ap={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},cp=(n,e,t,s,r,i,o,a)=>class extends n{constructor(l,u){const h=i(l),d={...ap,...u},p=r(h,d),f=o(h),v=f?t():null;super(l,!1,p,v),this._Q=e(this,f,p.Q,bt,St),this._detune=e(this,f,p.detune,1200*Math.log2(bt),-1200*Math.log2(bt)),this._frequency=e(this,f,p.frequency,l.sampleRate/2,0),this._gain=e(this,f,p.gain,40*Math.log10(bt),St),this._nativeBiquadFilterNode=p,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,h)}catch(d){throw d.code===11?s():d}if(l.length!==u.length||u.length!==h.length)throw s()}},lp=(n,e,t,s,r)=>()=>{const i=new WeakMap,o=async(a,c)=>{let l=t(a);const u=vt(l,c);if(!u){const h={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,h)}return i.set(c,l),u?(await n(c,a.Q,l.Q),await n(c,a.detune,l.detune),await n(c,a.frequency,l.frequency),await n(c,a.gain,l.gain)):(await s(c,a.Q,l.Q),await s(c,a.detune,l.detune),await s(c,a.frequency,l.frequency),await s(c,a.gain,l.gain)),await r(a,c,l),l};return{render(a,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},up=(n,e)=>(t,s)=>{const r=e.get(t);if(r!==void 0)return r;const i=n.get(t);if(i!==void 0)return i;try{const o=s();return o instanceof Promise?(n.set(t,o),o.catch(()=>!1).then(a=>(n.delete(t),e.set(t,a),a))):(e.set(t,o),o)}catch{return e.set(t,!1),!1}},hp={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},dp=(n,e,t,s,r)=>class extends n{constructor(o,a){const c=s(o),l={...hp,...a},u=t(c,l),h=r(c)?e():null;super(o,!1,u,h)}},fp=(n,e,t)=>()=>{const s=new WeakMap,r=async(i,o)=>{let a=e(i);if(!vt(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=n(o,l)}return s.set(o,a),await t(i,o,a),a};return{render(i,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},pp={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},mp=(n,e,t,s,r,i)=>class extends n{constructor(a,c){const l=s(a),u=i({...pp,...c}),h=t(l,u),d=r(l)?e():null;super(a,!1,h,d)}},gp=(n,e,t)=>()=>{const s=new WeakMap,r=async(i,o)=>{let a=e(i);if(!vt(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=n(o,l)}return s.set(o,a),await t(i,o,a),a};return{render(i,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},vp=n=>(e,t,s)=>n(t,e,s),_p=n=>(e,t,s=0,r=0)=>{const i=e[s];if(i===void 0)throw n();return Qr(t)?i.connect(t,0,r):i.connect(t,0)},yp=n=>(e,t)=>{const s=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return s.buffer=r,s.loop=!0,s.connect(t),s.start(),()=>{s.stop(),s.disconnect(t)}},bp={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},wp=(n,e,t,s,r,i,o)=>class extends n{constructor(c,l){const u=r(c),h={...bp,...l},d=s(u,h),p=i(u),f=p?t():null;super(c,!1,d,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=d,this._offset=e(this,p,d.offset,bt,St),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){ks(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),xn(this)&&fr(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},Tp=(n,e,t,s,r)=>()=>{const i=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let h=t(l);const d=vt(h,u);if(!d){const p={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(u,p),o!==null&&h.start(o),a!==null&&h.stop(a)}return i.set(u,h),d?await n(u,l.offset,h.offset):await s(u,l.offset,h.offset),await r(l,u,h),h};return{set start(l){o=l},set stop(l){a=l},render(l,u){const h=i.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},xp=n=>e=>(n[0]=e,n[0]),kp={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Cp=(n,e,t,s,r,i)=>class extends n{constructor(a,c){const l=s(a),u={...kp,...c},h=t(l,u),p=r(l)?e():null;super(a,!1,h,p),this._isBufferNullified=!1,this._nativeConvolverNode=h,u.buffer!==null&&i(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,i(this,0)}else this._isBufferNullified=!1,i(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},Sp=(n,e,t)=>()=>{const s=new WeakMap,r=async(i,o)=>{let a=e(i);if(!vt(a,o)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=n(o,l)}return s.set(o,a),Es(a)?await t(i,o,a.inputs[0]):await t(i,o,a),a};return{render(i,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},Ap=(n,e)=>(t,s,r)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,s,r)}catch(i){throw i.name==="SyntaxError"?n():i}},Op=()=>new DOMException("","DataCloneError"),Dc=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(s=>{const r=()=>{t.onmessage=null,e.close(),t.close(),s()};t.onmessage=()=>r();try{e.postMessage(n,[n])}catch{}finally{r()}})},Ip=(n,e,t,s,r,i,o,a,c,l,u)=>(h,d)=>{const p=o(h)?h:i(h);if(r.has(d)){const f=t();return Promise.reject(f)}try{r.add(d)}catch{}return e(c,()=>c(p))?p.decodeAudioData(d).then(f=>(Dc(d).catch(()=>{}),e(a,()=>a(f))||u(f),n.add(f),f)):new Promise((f,v)=>{const g=async()=>{try{await Dc(d)}catch{}},y=x=>{v(x),g()};try{p.decodeAudioData(d,x=>{typeof x.copyFromChannel!="function"&&(l(x),Xo(x)),n.add(x),g().then(()=>f(x))},x=>{y(x===null?s():x)})}catch(x){y(x)}})},Np=(n,e,t,s,r,i,o,a)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const h=i(c.context),d=a(h);if(u===l){if(e.delete(c),!d&&o(c)){const p=s(c),{outputs:f}=t(c);for(const v of f)if(mr(v)){const g=s(v[0]);n(p,g,v[1],v[2])}else{const g=r(v[0]);p.connect(g,v[1])}}}else e.set(c,u-l)},Ep={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Mp=(n,e,t,s,r,i,o)=>class extends n{constructor(c,l){const u=r(c),h={...Ep,...l},d=s(u,h),p=i(u),f=p?t(h.maxDelayTime):null;super(c,!1,d,f),this._delayTime=e(this,p,d.delayTime),o(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},Dp=(n,e,t,s,r)=>i=>{const o=new WeakMap,a=async(c,l)=>{let u=t(c);const h=vt(u,l);if(!h){const d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:i};u=e(l,d)}return o.set(l,u),h?await n(l,c.delayTime,u.delayTime):await s(l,c.delayTime,u.delayTime),await r(c,l,u),u};return{render(c,l){const u=o.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}},Pp=n=>(e,t,s,r)=>n(e[r],i=>i[0]===t&&i[1]===s),Rp=n=>(e,t)=>{n(e).delete(t)},Fp=n=>"delayTime"in n,Vp=(n,e,t)=>function s(r,i){const o=$r(i)?i:t(n,i);if(Fp(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(c=>s([...r,o],c[0])).reduce((c,l)=>c.concat(l),[])},Mr=(n,e,t)=>{const s=e[t];if(s===void 0)throw n();return s},Lp=n=>(e,t=void 0,s=void 0,r=0)=>t===void 0?e.forEach(i=>i.disconnect()):typeof t=="number"?Mr(n,e,t).disconnect():Qr(t)?s===void 0?e.forEach(i=>i.disconnect(t)):r===void 0?Mr(n,e,s).disconnect(t,0):Mr(n,e,s).disconnect(t,0,r):s===void 0?e.forEach(i=>i.disconnect(t)):Mr(n,e,s).disconnect(t,0),Bp={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Up=(n,e,t,s,r,i,o,a)=>class extends n{constructor(l,u){const h=i(l),d={...Bp,...u},p=s(h,d),f=o(h),v=f?t():null;super(l,!1,p,v),this._attack=e(this,f,p.attack),this._knee=e(this,f,p.knee),this._nativeDynamicsCompressorNode=p,this._ratio=e(this,f,p.ratio),this._release=e(this,f,p.release),this._threshold=e(this,f,p.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},qp=(n,e,t,s,r)=>()=>{const i=new WeakMap,o=async(a,c)=>{let l=t(a);const u=vt(l,c);if(!u){const h={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,h)}return i.set(c,l),u?(await n(c,a.attack,l.attack),await n(c,a.knee,l.knee),await n(c,a.ratio,l.ratio),await n(c,a.release,l.release),await n(c,a.threshold,l.threshold)):(await s(c,a.attack,l.attack),await s(c,a.knee,l.knee),await s(c,a.ratio,l.ratio),await s(c,a.release,l.release),await s(c,a.threshold,l.threshold)),await r(a,c,l),l};return{render(a,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},Wp=()=>new DOMException("","EncodingError"),jp=n=>e=>new Promise((t,s)=>{if(n===null){s(new SyntaxError);return}const r=n.document.head;if(r===null)s(new SyntaxError);else{const i=n.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=n.onerror,l=()=>{n.onerror=c,URL.revokeObjectURL(a)};n.onerror=(u,h,d,p,f)=>{if(h===a||h===n.location.href&&d===1&&p===1)return l(),s(f),!1;if(c!==null)return c(u,h,d,p,f)},i.onerror=()=>{l(),s(new SyntaxError)},i.onload=()=>{l(),t()},i.src=a,i.type="module",r.appendChild(i)}}),zp=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,s,r){if(s!==null){let i=this._listeners.get(s);i===void 0&&(i=n(this,s),typeof s=="function"&&this._listeners.set(s,i)),this._nativeEventTarget.addEventListener(t,i,r)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,s,r){const i=s===null?void 0:this._listeners.get(s);this._nativeEventTarget.removeEventListener(t,i===void 0?null:i,r)}},Hp=n=>(e,t,s)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return s()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},Gp=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},Xp={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Zp=(n,e,t,s,r,i)=>class extends n{constructor(a,c){const l=r(a),u={...Xp,...c},h=s(l,u),d=i(l),p=d?t():null;super(a,!1,h,p),this._gain=e(this,d,h.gain,bt,St)}get gain(){return this._gain}},Yp=(n,e,t,s,r)=>()=>{const i=new WeakMap,o=async(a,c)=>{let l=t(a);const u=vt(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,h)}return i.set(c,l),u?await n(c,a.gain,l.gain):await s(c,a.gain,l.gain),await r(a,c,l),l};return{render(a,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},$p=(n,e)=>t=>e(n,t),Kp=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},Jp=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},Qp=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},em=n=>e=>n.get(e),ct=()=>new DOMException("","InvalidStateError"),tm=n=>e=>{const t=n.get(e);if(t===void 0)throw ct();return t},nm=(n,e)=>t=>{let s=n.get(t);if(s!==void 0)return s;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return s=new e(1,1,44100),n.set(t,s),s},sm=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},fi=()=>new DOMException("","InvalidAccessError"),rm=n=>{n.getFrequencyResponse=(e=>(t,s,r)=>{if(t.length!==s.length||s.length!==r.length)throw fi();return e.call(n,t,s,r)})(n.getFrequencyResponse)},im={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},om=(n,e,t,s,r,i)=>class extends n{constructor(a,c){const l=s(a),u=r(l),h={...im,...c},d=e(l,u?null:a.baseLatency,h),p=u?t(h.feedback,h.feedforward):null;super(a,!1,d,p),rm(d),this._nativeIIRFilterNode=d,i(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}},ql=(n,e,t,s,r,i,o,a,c,l,u)=>{const h=l.length;let d=a;for(let p=0;p<h;p+=1){let f=t[0]*l[p];for(let v=1;v<r;v+=1){const g=d-v&c-1;f+=t[v]*i[g],f-=n[v]*o[g]}for(let v=r;v<s;v+=1)f+=t[v]*i[d-v&c-1];for(let v=r;v<e;v+=1)f-=n[v]*o[d-v&c-1];i[d]=l[p],o[d]=f,d=d+1&c-1,u[p]=f}return d},am=(n,e,t,s)=>{const r=t instanceof Float64Array?t:new Float64Array(t),i=s instanceof Float64Array?s:new Float64Array(s),o=r.length,a=i.length,c=Math.min(o,a);if(r[0]!==1){for(let f=0;f<o;f+=1)i[f]/=r[0];for(let f=1;f<a;f+=1)r[f]/=r[0]}const l=32,u=new Float32Array(l),h=new Float32Array(l),d=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),p=n.numberOfChannels;for(let f=0;f<p;f+=1){const v=n.getChannelData(f),g=d.getChannelData(f);u.fill(0),h.fill(0),ql(r,o,i,a,c,u,h,0,l,v,g)}return d},cm=(n,e,t,s,r)=>(i,o)=>{const a=new WeakMap;let c=null;const l=async(u,h)=>{let d=null,p=e(u);const f=vt(p,h);if(h.createIIRFilter===void 0?d=n(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(p=h.createIIRFilter(o,i)),a.set(h,d===null?p:d),d!==null){if(c===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const g=new t(u.context.destination.channelCount,u.context.length,h.sampleRate);c=(async()=>{await s(u,g,g.destination);const y=await r(g);return am(y,h,i,o)})()}const v=await c;return d.buffer=v,d.start(0),d}return await s(u,h,p),p};return{render(u,h){const d=a.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},lm=(n,e,t,s,r,i)=>o=>(a,c)=>{const l=n.get(a);if(l===void 0){if(!o&&i(a)){const u=s(a),{outputs:h}=t(a);for(const d of h)if(mr(d)){const p=s(d[0]);e(u,p,d[1],d[2])}else{const p=r(d[0]);u.disconnect(p,d[1])}}n.set(a,c)}else n.set(a,l+c)},um=(n,e)=>t=>{const s=n.get(t);return e(s)||e(t)},hm=(n,e)=>t=>n.has(t)||e(t),dm=(n,e)=>t=>n.has(t)||e(t),fm=(n,e)=>t=>{const s=n.get(t);return e(s)||e(t)},pm=n=>e=>n!==null&&e instanceof n,mm=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,gm=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,vm=(n,e)=>t=>n(t)||e(t),_m=n=>e=>n!==null&&e instanceof n,ym=n=>n!==null&&n.isSecureContext,bm=(n,e,t,s)=>class extends n{constructor(i,o){const a=t(i),c=e(a,o);if(s(a))throw TypeError();super(i,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},wm={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Tm=(n,e,t,s)=>class extends n{constructor(i,o){const a=t(i);if(s(a))throw new TypeError;const c={...wm,...o},l=e(a,c);super(i,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},xm=(n,e,t,s)=>class extends n{constructor(i,o){const a=t(i),c=e(a,o);if(s(a))throw new TypeError;super(i,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},km=(n,e,t)=>class extends n{constructor(r,i){const o=t(r),a=e(o,i);super(r,!0,a,null)}},Cm=(n,e,t,s,r,i)=>class extends t{constructor(a,c){super(a),this._nativeContext=a,hi.set(this,a),s(a)&&r.set(a,new Set),this._destination=new n(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?i(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},or=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},Sm=(n,e)=>(t,s,r)=>{const i=new Set;return t.connect=(o=>(a,c=0,l=0)=>{const u=i.size===0;if(e(a))return o.call(t,a,c,l),n(i,[a,c,l],h=>h[0]===a&&h[1]===c&&h[2]===l,!0),u&&s(),a;o.call(t,a,c),n(i,[a,c],h=>h[0]===a&&h[1]===c,!0),u&&s()})(t.connect),t.disconnect=(o=>(a,c,l)=>{const u=i.size>0;if(a===void 0)o.apply(t),i.clear();else if(typeof a=="number"){o.call(t,a);for(const d of i)d[1]===a&&i.delete(d)}else{e(a)?o.call(t,a,c,l):o.call(t,a,c);for(const d of i)d[0]===a&&(c===void 0||d[1]===c)&&(l===void 0||d[2]===l)&&i.delete(d)}const h=i.size===0;u&&h&&r()})(t.disconnect),t},je=(n,e,t)=>{const s=e[t];s!==void 0&&s!==n[t]&&(n[t]=s)},it=(n,e)=>{je(n,e,"channelCount"),je(n,e,"channelCountMode"),je(n,e,"channelInterpretation")},Pc=n=>typeof n.getFloatTimeDomainData=="function",Am=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const s=Math.max(t.length,n.fftSize);for(let r=0;r<s;r+=1)e[r]=(t[r]-128)*.0078125;return e}},Om=(n,e)=>(t,s)=>{const r=t.createAnalyser();if(it(r,s),!(s.maxDecibels>s.minDecibels))throw e();return je(r,s,"fftSize"),je(r,s,"maxDecibels"),je(r,s,"minDecibels"),je(r,s,"smoothingTimeConstant"),n(Pc,()=>Pc(r))||Am(r),r},Im=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,Ze=(n,e,t)=>{const s=e[t];s!==void 0&&s!==n[t].value&&(n[t].value=s)},Nm=n=>{n.start=(e=>{let t=!1;return(s=0,r=0,i)=>{if(t)throw ct();e.call(n,s,r,i),t=!0}})(n.start)},$o=n=>{n.start=(e=>(t=0,s=0,r)=>{if(typeof r=="number"&&r<0||s<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,s,r)})(n.start)},Ko=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},Em=(n,e,t,s,r,i,o,a,c,l,u)=>(h,d)=>{const p=h.createBufferSource();return it(p,d),Ze(p,d,"playbackRate"),je(p,d,"buffer"),je(p,d,"loop"),je(p,d,"loopEnd"),je(p,d,"loopStart"),e(t,()=>t(h))||Nm(p),e(s,()=>s(h))||c(p),e(r,()=>r(h))||l(p,h),e(i,()=>i(h))||$o(p),e(o,()=>o(h))||u(p,h),e(a,()=>a(h))||Ko(p),n(h,p),p},Mm=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,Dm=(n,e)=>(t,s,r)=>{const i=t.destination;if(i.channelCount!==s)try{i.channelCount=s}catch{}r&&i.channelCountMode!=="explicit"&&(i.channelCountMode="explicit"),i.maxChannelCount===0&&Object.defineProperty(i,"maxChannelCount",{value:s});const o=n(t,{channelCount:s,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>c=>{a.call(o,c);try{i.channelCount=c}catch(l){if(c>i.maxChannelCount)throw l}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>c=>{a.call(o,c),i.channelCountMode=c}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>c=>{a.call(o,c),i.channelInterpretation=c}),Object.defineProperty(o,"maxChannelCount",{get:()=>i.maxChannelCount}),o.connect(i),o},Pm=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,Rm=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},Fm=(n,e,t,s,r)=>(i,o,a,c,l,u)=>{if(a!==null)try{const h=new a(i,c,u),d=new Map;let p=null;if(Object.defineProperties(h,{channelCount:{get:()=>u.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>p,set:f=>{typeof p=="function"&&h.removeEventListener("processorerror",p),p=typeof f=="function"?f:null,typeof p=="function"&&h.addEventListener("processorerror",p)}}}),h.addEventListener=(f=>(...v)=>{if(v[0]==="processorerror"){const g=typeof v[1]=="function"?v[1]:typeof v[1]=="object"&&v[1]!==null&&typeof v[1].handleEvent=="function"?v[1].handleEvent:null;if(g!==null){const y=d.get(v[1]);y!==void 0?v[1]=y:(v[1]=x=>{x.type==="error"?(Object.defineProperties(x,{type:{value:"processorerror"}}),g(x)):g(new ErrorEvent(v[0],{...x}))},d.set(g,v[1]))}}return f.call(h,"error",v[1],v[2]),f.call(h,...v)})(h.addEventListener),h.removeEventListener=(f=>(...v)=>{if(v[0]==="processorerror"){const g=d.get(v[1]);g!==void 0&&(d.delete(v[1]),v[1]=g)}return f.call(h,"error",v[1],v[2]),f.call(h,v[0],v[1],v[2])})(h.removeEventListener),u.numberOfOutputs!==0){const f=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(f).connect(i.destination),r(h,()=>f.disconnect(),()=>f.connect(i.destination))}return h}catch(h){throw h.code===11?s():h}if(l===void 0)throw s();return Rm(u),e(i,o,l,u)},Wl=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),Vm=n=>new Promise((e,t)=>{const{port1:s,port2:r}=new MessageChannel;s.onmessage=({data:i})=>{s.close(),r.close(),e(i)},s.onmessageerror=({data:i})=>{s.close(),r.close(),t(i)},r.postMessage(n)}),Lm=async(n,e)=>{const t=await Vm(e);return new n(t)},Bm=(n,e,t,s)=>{let r=xo.get(n);r===void 0&&(r=new WeakMap,xo.set(n,r));const i=Lm(t,s);return r.set(e,i),i},Um=(n,e,t,s,r,i,o,a,c,l,u,h,d)=>(p,f,v,g)=>{if(g.numberOfInputs===0&&g.numberOfOutputs===0)throw c();const y=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(y.some(B=>B<1))throw c();if(y.length!==g.numberOfOutputs)throw e();if(g.channelCountMode!=="explicit")throw c();const x=g.channelCount*g.numberOfInputs,T=y.reduce((B,Y)=>B+Y,0),m=v.parameterDescriptors===void 0?0:v.parameterDescriptors.length;if(x+m>6||T>6)throw c();const b=new MessageChannel,w=[],C=[];for(let B=0;B<g.numberOfInputs;B+=1)w.push(o(p,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),C.push(r(p,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const k=[];if(v.parameterDescriptors!==void 0)for(const{defaultValue:B,maxValue:Y,minValue:ke,name:fe}of v.parameterDescriptors){const le=i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:g.parameterData[fe]!==void 0?g.parameterData[fe]:B===void 0?0:B});Object.defineProperties(le.offset,{defaultValue:{get:()=>B===void 0?0:B},maxValue:{get:()=>Y===void 0?bt:Y},minValue:{get:()=>ke===void 0?St:ke}}),k.push(le)}const M=s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,x+m)}),O=Wl(f,p.sampleRate),N=a(p,O,x+m,Math.max(1,T)),I=r(p,{channelCount:Math.max(1,T),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,T)}),P=[];for(let B=0;B<g.numberOfOutputs;B+=1)P.push(s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:y[B]}));for(let B=0;B<g.numberOfInputs;B+=1){w[B].connect(C[B]);for(let Y=0;Y<g.channelCount;Y+=1)C[B].connect(M,Y,B*g.channelCount+Y)}const R=new Bl(v.parameterDescriptors===void 0?[]:v.parameterDescriptors.map(({name:B},Y)=>{const ke=k[Y];return ke.connect(M,0,x+Y),ke.start(0),[B,ke.offset]}));M.connect(N);let V=g.channelInterpretation,L=null;const F=g.numberOfOutputs===0?[N]:P,K={get bufferSize(){return O},get channelCount(){return g.channelCount},set channelCount(B){throw t()},get channelCountMode(){return g.channelCountMode},set channelCountMode(B){throw t()},get channelInterpretation(){return V},set channelInterpretation(B){for(const Y of w)Y.channelInterpretation=B;V=B},get context(){return N.context},get inputs(){return w},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return L},set onprocessorerror(B){typeof L=="function"&&K.removeEventListener("processorerror",L),L=typeof B=="function"?B:null,typeof L=="function"&&K.addEventListener("processorerror",L)},get parameters(){return R},get port(){return b.port2},addEventListener(...B){return N.addEventListener(B[0],B[1],B[2])},connect:n.bind(null,F),disconnect:l.bind(null,F),dispatchEvent(...B){return N.dispatchEvent(B[0])},removeEventListener(...B){return N.removeEventListener(B[0],B[1],B[2])}},z=new Map;b.port1.addEventListener=(B=>(...Y)=>{if(Y[0]==="message"){const ke=typeof Y[1]=="function"?Y[1]:typeof Y[1]=="object"&&Y[1]!==null&&typeof Y[1].handleEvent=="function"?Y[1].handleEvent:null;if(ke!==null){const fe=z.get(Y[1]);fe!==void 0?Y[1]=fe:(Y[1]=le=>{u(p.currentTime,p.sampleRate,()=>ke(le))},z.set(ke,Y[1]))}}return B.call(b.port1,Y[0],Y[1],Y[2])})(b.port1.addEventListener),b.port1.removeEventListener=(B=>(...Y)=>{if(Y[0]==="message"){const ke=z.get(Y[1]);ke!==void 0&&(z.delete(Y[1]),Y[1]=ke)}return B.call(b.port1,Y[0],Y[1],Y[2])})(b.port1.removeEventListener);let Z=null;Object.defineProperty(b.port1,"onmessage",{get:()=>Z,set:B=>{typeof Z=="function"&&b.port1.removeEventListener("message",Z),Z=typeof B=="function"?B:null,typeof Z=="function"&&(b.port1.addEventListener("message",Z),b.port1.start())}}),v.prototype.port=b.port1;let G=null;Bm(p,K,v,g).then(B=>G=B);const ce=ti(g.numberOfInputs,g.channelCount),me=ti(g.numberOfOutputs,y),ee=v.parameterDescriptors===void 0?[]:v.parameterDescriptors.reduce((B,{name:Y})=>({...B,[Y]:new Float32Array(128)}),{});let ne=!0;const _e=()=>{g.numberOfOutputs>0&&N.disconnect(I);for(let B=0,Y=0;B<g.numberOfOutputs;B+=1){const ke=P[B];for(let fe=0;fe<y[B];fe+=1)I.disconnect(ke,Y+fe,fe);Y+=y[B]}},q=new Map;N.onaudioprocess=({inputBuffer:B,outputBuffer:Y})=>{if(G!==null){const ke=h(K);for(let fe=0;fe<O;fe+=128){for(let le=0;le<g.numberOfInputs;le+=1)for(let ge=0;ge<g.channelCount;ge+=1)ei(B,ce[le],ge,ge,fe);v.parameterDescriptors!==void 0&&v.parameterDescriptors.forEach(({name:le},ge)=>{ei(B,ee,le,x+ge,fe)});for(let le=0;le<g.numberOfInputs;le+=1)for(let ge=0;ge<y[le];ge+=1)me[le][ge].byteLength===0&&(me[le][ge]=new Float32Array(128));try{const le=ce.map((Ie,De)=>{if(ke[De].size>0)return q.set(De,O/128),Ie;const nt=q.get(De);return nt===void 0?[]:(Ie.every(Et=>Et.every(at=>at===0))&&(nt===1?q.delete(De):q.set(De,nt-1)),Ie)});ne=u(p.currentTime+fe/p.sampleRate,p.sampleRate,()=>G.process(le,me,ee));for(let Ie=0,De=0;Ie<g.numberOfOutputs;Ie+=1){for(let Pe=0;Pe<y[Ie];Pe+=1)Ul(Y,me[Ie],Pe,De+Pe,fe);De+=y[Ie]}}catch(le){ne=!1,K.dispatchEvent(new ErrorEvent("processorerror",{colno:le.colno,filename:le.filename,lineno:le.lineno,message:le.message}))}if(!ne){for(let le=0;le<g.numberOfInputs;le+=1){w[le].disconnect(C[le]);for(let ge=0;ge<g.channelCount;ge+=1)C[fe].disconnect(M,ge,le*g.channelCount+ge)}if(v.parameterDescriptors!==void 0){const le=v.parameterDescriptors.length;for(let ge=0;ge<le;ge+=1){const Ie=k[ge];Ie.disconnect(M,0,x+ge),Ie.stop()}}M.disconnect(N),N.onaudioprocess=null,xe?_e():he();break}}}};let xe=!1;const Oe=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),ve=()=>N.connect(Oe).connect(p.destination),he=()=>{N.disconnect(Oe),Oe.disconnect()},$e=()=>{if(ne){he(),g.numberOfOutputs>0&&N.connect(I);for(let B=0,Y=0;B<g.numberOfOutputs;B+=1){const ke=P[B];for(let fe=0;fe<y[B];fe+=1)I.connect(ke,Y+fe,fe);Y+=y[B]}}xe=!0},kt=()=>{ne&&(ve(),_e()),xe=!1};return ve(),d(K,$e,kt)},jl=(n,e)=>{const t=n.createBiquadFilter();return it(t,e),Ze(t,e,"Q"),Ze(t,e,"detune"),Ze(t,e,"frequency"),Ze(t,e,"gain"),je(t,e,"type"),t},qm=(n,e)=>(t,s)=>{const r=t.createChannelMerger(s.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,r),it(r,s),r},Wm=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw ct()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw ct()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw ct()}})},gr=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return it(t,e),Wm(t),t},jm=(n,e,t,s,r)=>(i,o)=>{if(i.createConstantSource===void 0)return t(i,o);const a=i.createConstantSource();return it(a,o),Ze(a,o,"offset"),e(s,()=>s(i))||$o(a),e(r,()=>r(i))||Ko(a),n(i,a),a},Ms=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),zm=(n,e,t,s)=>(r,{offset:i,...o})=>{const a=r.createBuffer(1,2,44100),c=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=t(r,{...o,gain:i}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const h={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(f){l.channelCount=f},get channelCountMode(){return l.channelCountMode},set channelCountMode(f){l.channelCountMode=f},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(f){l.channelInterpretation=f},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(f){c.onended=f},addEventListener(...f){return c.addEventListener(f[0],f[1],f[2])},dispatchEvent(...f){return c.dispatchEvent(f[0])},removeEventListener(...f){return c.removeEventListener(f[0],f[1],f[2])},start(f=0){c.start.call(c,f)},stop(f=0){c.stop.call(c,f)}},d=()=>c.connect(l),p=()=>c.disconnect(l);return n(r,c),s(Ms(h,l),d,p)},Hm=(n,e)=>(t,s)=>{const r=t.createConvolver();if(it(r,s),s.disableNormalization===r.normalize&&(r.normalize=!s.disableNormalization),je(r,s,"buffer"),s.channelCount>2||(e(r,"channelCount",i=>()=>i.call(r),i=>o=>{if(o>2)throw n();return i.call(r,o)}),s.channelCountMode==="max"))throw n();return e(r,"channelCountMode",i=>()=>i.call(r),i=>o=>{if(o==="max")throw n();return i.call(r,o)}),r},zl=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return it(t,e),Ze(t,e,"delayTime"),t},Gm=n=>(e,t)=>{const s=e.createDynamicsCompressor();if(it(s,t),t.channelCount>2||t.channelCountMode==="max")throw n();return Ze(s,t,"attack"),Ze(s,t,"knee"),Ze(s,t,"ratio"),Ze(s,t,"release"),Ze(s,t,"threshold"),s},Nt=(n,e)=>{const t=n.createGain();return it(t,e),Ze(t,e,"gain"),t},Xm=n=>(e,t,s)=>{if(e.createIIRFilter===void 0)return n(e,t,s);const r=e.createIIRFilter(s.feedforward,s.feedback);return it(r,s),r};function Zm(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function Ym(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function Rc(n,e){let t=[0,0];for(let s=n.length-1;s>=0;s-=1)t=Ym(t,e),t[0]+=n[s];return t}const $m=(n,e,t,s)=>(r,i,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const h=Wl(i,r.sampleRate),d=l instanceof Float64Array?l:new Float64Array(l),p=u instanceof Float64Array?u:new Float64Array(u),f=d.length,v=p.length,g=Math.min(f,v);if(f===0||f>20)throw s();if(d[0]===0)throw e();if(v===0||v>20)throw s();if(p[0]===0)throw e();if(d[0]!==1){for(let k=0;k<v;k+=1)p[k]/=d[0];for(let k=1;k<f;k+=1)d[k]/=d[0]}const y=t(r,h,o,o);y.channelCount=o,y.channelCountMode=a,y.channelInterpretation=c;const x=32,T=[],m=[],b=[];for(let k=0;k<o;k+=1){T.push(0);const M=new Float32Array(x),O=new Float32Array(x);M.fill(0),O.fill(0),m.push(M),b.push(O)}y.onaudioprocess=k=>{const M=k.inputBuffer,O=k.outputBuffer,N=M.numberOfChannels;for(let I=0;I<N;I+=1){const P=M.getChannelData(I),R=O.getChannelData(I);T[I]=ql(d,f,p,v,g,m[I],b[I],T[I],x,P,R)}};const w=r.sampleRate/2;return Ms({get bufferSize(){return h},get channelCount(){return y.channelCount},set channelCount(k){y.channelCount=k},get channelCountMode(){return y.channelCountMode},set channelCountMode(k){y.channelCountMode=k},get channelInterpretation(){return y.channelInterpretation},set channelInterpretation(k){y.channelInterpretation=k},get context(){return y.context},get inputs(){return[y]},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},addEventListener(...k){return y.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return y.dispatchEvent(k[0])},getFrequencyResponse(k,M,O){if(k.length!==M.length||M.length!==O.length)throw n();const N=k.length;for(let I=0;I<N;I+=1){const P=-Math.PI*(k[I]/w),R=[Math.cos(P),Math.sin(P)],V=Rc(p,R),L=Rc(d,R),F=Zm(V,L);M[I]=Math.sqrt(F[0]*F[0]+F[1]*F[1]),O[I]=Math.atan2(F[1],F[0])}},removeEventListener(...k){return y.removeEventListener(k[0],k[1],k[2])}},y)},Km=(n,e)=>n.createMediaElementSource(e.mediaElement),Jm=(n,e)=>{const t=n.createMediaStreamDestination();return it(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},Qm=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((i,o)=>i.id<o.id?-1:i.id>o.id?1:0);const s=t.slice(0,1),r=n.createMediaStreamSource(new MediaStream(s));return Object.defineProperty(r,"mediaStream",{value:e}),r},eg=(n,e)=>(t,{mediaStreamTrack:s})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(s);const r=new MediaStream([s]),i=t.createMediaStreamSource(r);if(s.kind!=="audio")throw n();if(e(t))throw new TypeError;return i},tg=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,ng=(n,e,t,s,r,i)=>(o,a)=>{const c=o.createOscillator();return it(c,a),Ze(c,a,"detune"),Ze(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):je(c,a,"type"),e(t,()=>t(o))||$o(c),e(s,()=>s(o))||i(c,o),e(r,()=>r(o))||Ko(c),n(o,c),c},sg=n=>(e,t)=>{const s=e.createPanner();return s.orientationX===void 0?n(e,t):(it(s,t),Ze(s,t,"orientationX"),Ze(s,t,"orientationY"),Ze(s,t,"orientationZ"),Ze(s,t,"positionX"),Ze(s,t,"positionY"),Ze(s,t,"positionZ"),je(s,t,"coneInnerAngle"),je(s,t,"coneOuterAngle"),je(s,t,"coneOuterGain"),je(s,t,"distanceModel"),je(s,t,"maxDistance"),je(s,t,"panningModel"),je(s,t,"refDistance"),je(s,t,"rolloffFactor"),s)},rg=(n,e,t,s,r,i,o,a,c,l)=>(u,{coneInnerAngle:h,coneOuterAngle:d,coneOuterGain:p,distanceModel:f,maxDistance:v,orientationX:g,orientationY:y,orientationZ:x,panningModel:T,positionX:m,positionY:b,positionZ:w,refDistance:C,rolloffFactor:k,...M})=>{const O=u.createPanner();if(M.channelCount>2||M.channelCountMode==="max")throw o();it(O,M);const N={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},I=t(u,{...N,channelInterpretation:"speakers",numberOfInputs:6}),P=s(u,{...M,gain:1}),R=s(u,{...N,gain:1}),V=s(u,{...N,gain:0}),L=s(u,{...N,gain:0}),F=s(u,{...N,gain:0}),K=s(u,{...N,gain:0}),z=s(u,{...N,gain:0}),Z=r(u,256,6,1),G=i(u,{...N,curve:new Float32Array([1,1]),oversample:"none"});let X=[g,y,x],ce=[m,b,w];const me=new Float32Array(1);Z.onaudioprocess=({inputBuffer:q})=>{const xe=[c(q,me,0),c(q,me,1),c(q,me,2)];xe.some((ve,he)=>ve!==X[he])&&(O.setOrientation(...xe),X=xe);const Oe=[c(q,me,3),c(q,me,4),c(q,me,5)];Oe.some((ve,he)=>ve!==ce[he])&&(O.setPosition(...Oe),ce=Oe)},Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(L.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0}),Object.defineProperty(K.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0});const ee={get bufferSize(){},get channelCount(){return O.channelCount},set channelCount(q){if(q>2)throw o();P.channelCount=q,O.channelCount=q},get channelCountMode(){return O.channelCountMode},set channelCountMode(q){if(q==="max")throw o();P.channelCountMode=q,O.channelCountMode=q},get channelInterpretation(){return O.channelInterpretation},set channelInterpretation(q){P.channelInterpretation=q,O.channelInterpretation=q},get coneInnerAngle(){return O.coneInnerAngle},set coneInnerAngle(q){O.coneInnerAngle=q},get coneOuterAngle(){return O.coneOuterAngle},set coneOuterAngle(q){O.coneOuterAngle=q},get coneOuterGain(){return O.coneOuterGain},set coneOuterGain(q){if(q<0||q>1)throw e();O.coneOuterGain=q},get context(){return O.context},get distanceModel(){return O.distanceModel},set distanceModel(q){O.distanceModel=q},get inputs(){return[P]},get maxDistance(){return O.maxDistance},set maxDistance(q){if(q<0)throw new RangeError;O.maxDistance=q},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},get orientationX(){return R.gain},get orientationY(){return V.gain},get orientationZ(){return L.gain},get panningModel(){return O.panningModel},set panningModel(q){O.panningModel=q},get positionX(){return F.gain},get positionY(){return K.gain},get positionZ(){return z.gain},get refDistance(){return O.refDistance},set refDistance(q){if(q<0)throw new RangeError;O.refDistance=q},get rolloffFactor(){return O.rolloffFactor},set rolloffFactor(q){if(q<0)throw new RangeError;O.rolloffFactor=q},addEventListener(...q){return P.addEventListener(q[0],q[1],q[2])},dispatchEvent(...q){return P.dispatchEvent(q[0])},removeEventListener(...q){return P.removeEventListener(q[0],q[1],q[2])}};h!==ee.coneInnerAngle&&(ee.coneInnerAngle=h),d!==ee.coneOuterAngle&&(ee.coneOuterAngle=d),p!==ee.coneOuterGain&&(ee.coneOuterGain=p),f!==ee.distanceModel&&(ee.distanceModel=f),v!==ee.maxDistance&&(ee.maxDistance=v),g!==ee.orientationX.value&&(ee.orientationX.value=g),y!==ee.orientationY.value&&(ee.orientationY.value=y),x!==ee.orientationZ.value&&(ee.orientationZ.value=x),T!==ee.panningModel&&(ee.panningModel=T),m!==ee.positionX.value&&(ee.positionX.value=m),b!==ee.positionY.value&&(ee.positionY.value=b),w!==ee.positionZ.value&&(ee.positionZ.value=w),C!==ee.refDistance&&(ee.refDistance=C),k!==ee.rolloffFactor&&(ee.rolloffFactor=k),(X[0]!==1||X[1]!==0||X[2]!==0)&&O.setOrientation(...X),(ce[0]!==0||ce[1]!==0||ce[2]!==0)&&O.setPosition(...ce);const ne=()=>{P.connect(O),n(P,G,0,0),G.connect(R).connect(I,0,0),G.connect(V).connect(I,0,1),G.connect(L).connect(I,0,2),G.connect(F).connect(I,0,3),G.connect(K).connect(I,0,4),G.connect(z).connect(I,0,5),I.connect(Z).connect(u.destination)},_e=()=>{P.disconnect(O),a(P,G,0,0),G.disconnect(R),R.disconnect(I),G.disconnect(V),V.disconnect(I),G.disconnect(L),L.disconnect(I),G.disconnect(F),F.disconnect(I),G.disconnect(K),K.disconnect(I),G.disconnect(z),z.disconnect(I),I.disconnect(Z),Z.disconnect(u.destination)};return l(Ms(ee,O),ne,_e)},ig=n=>(e,{disableNormalization:t,imag:s,real:r})=>{const i=s instanceof Float32Array?s:new Float32Array(s),o=r instanceof Float32Array?r:new Float32Array(r),a=e.createPeriodicWave(o,i,{disableNormalization:t});if(Array.from(s).length<2)throw n();return a},vr=(n,e,t,s)=>n.createScriptProcessor(e,t,s),og=(n,e)=>(t,s)=>{const r=s.channelCountMode;if(r==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,s);const i=t.createStereoPanner();return it(i,s),Ze(i,s,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>r,set:o=>{if(o!==r)throw e()}}),i},ag=(n,e,t,s,r,i)=>{const a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},h=(f,v,g,y)=>{const x=new Float32Array(16385),T=new Float32Array(16385);for(let M=0;M<16385;M+=1){const O=M/16384*c;x[M]=Math.cos(O),T[M]=Math.sin(O)}const m=t(f,{...l,gain:0}),b=s(f,{...u,curve:x}),w=s(f,{...u,curve:a}),C=t(f,{...l,gain:0}),k=s(f,{...u,curve:T});return{connectGraph(){v.connect(m),v.connect(w.inputs===void 0?w:w.inputs[0]),v.connect(C),w.connect(g),g.connect(b.inputs===void 0?b:b.inputs[0]),g.connect(k.inputs===void 0?k:k.inputs[0]),b.connect(m.gain),k.connect(C.gain),m.connect(y,0,0),C.connect(y,0,1)},disconnectGraph(){v.disconnect(m),v.disconnect(w.inputs===void 0?w:w.inputs[0]),v.disconnect(C),w.disconnect(g),g.disconnect(b.inputs===void 0?b:b.inputs[0]),g.disconnect(k.inputs===void 0?k:k.inputs[0]),b.disconnect(m.gain),k.disconnect(C.gain),m.disconnect(y,0,0),C.disconnect(y,0,1)}}},d=(f,v,g,y)=>{const x=new Float32Array(16385),T=new Float32Array(16385),m=new Float32Array(16385),b=new Float32Array(16385),w=Math.floor(16385/2);for(let F=0;F<16385;F+=1)if(F>w){const K=(F-w)/(16384-w)*c;x[F]=Math.cos(K),T[F]=Math.sin(K),m[F]=0,b[F]=1}else{const K=F/(16384-w)*c;x[F]=1,T[F]=0,m[F]=Math.cos(K),b[F]=Math.sin(K)}const C=e(f,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),k=t(f,{...l,gain:0}),M=s(f,{...u,curve:x}),O=t(f,{...l,gain:0}),N=s(f,{...u,curve:T}),I=s(f,{...u,curve:a}),P=t(f,{...l,gain:0}),R=s(f,{...u,curve:m}),V=t(f,{...l,gain:0}),L=s(f,{...u,curve:b});return{connectGraph(){v.connect(C),v.connect(I.inputs===void 0?I:I.inputs[0]),C.connect(k,0),C.connect(O,0),C.connect(P,1),C.connect(V,1),I.connect(g),g.connect(M.inputs===void 0?M:M.inputs[0]),g.connect(N.inputs===void 0?N:N.inputs[0]),g.connect(R.inputs===void 0?R:R.inputs[0]),g.connect(L.inputs===void 0?L:L.inputs[0]),M.connect(k.gain),N.connect(O.gain),R.connect(P.gain),L.connect(V.gain),k.connect(y,0,0),P.connect(y,0,0),O.connect(y,0,1),V.connect(y,0,1)},disconnectGraph(){v.disconnect(C),v.disconnect(I.inputs===void 0?I:I.inputs[0]),C.disconnect(k,0),C.disconnect(O,0),C.disconnect(P,1),C.disconnect(V,1),I.disconnect(g),g.disconnect(M.inputs===void 0?M:M.inputs[0]),g.disconnect(N.inputs===void 0?N:N.inputs[0]),g.disconnect(R.inputs===void 0?R:R.inputs[0]),g.disconnect(L.inputs===void 0?L:L.inputs[0]),M.disconnect(k.gain),N.disconnect(O.gain),R.disconnect(P.gain),L.disconnect(V.gain),k.disconnect(y,0,0),P.disconnect(y,0,0),O.disconnect(y,0,1),V.disconnect(y,0,1)}}},p=(f,v,g,y,x)=>{if(v===1)return h(f,g,y,x);if(v===2)return d(f,g,y,x);throw r()};return(f,{channelCount:v,channelCountMode:g,pan:y,...x})=>{if(g==="max")throw r();const T=n(f,{...x,channelCount:1,channelCountMode:g,numberOfInputs:2}),m=t(f,{...x,channelCount:v,channelCountMode:g,gain:1}),b=t(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:y});let{connectGraph:w,disconnectGraph:C}=p(f,v,m,b,T);Object.defineProperty(b.gain,"defaultValue",{get:()=>0}),Object.defineProperty(b.gain,"maxValue",{get:()=>1}),Object.defineProperty(b.gain,"minValue",{get:()=>-1});const k={get bufferSize(){},get channelCount(){return m.channelCount},set channelCount(I){m.channelCount!==I&&(M&&C(),{connectGraph:w,disconnectGraph:C}=p(f,I,m,b,T),M&&w()),m.channelCount=I},get channelCountMode(){return m.channelCountMode},set channelCountMode(I){if(I==="clamped-max"||I==="max")throw r();m.channelCountMode=I},get channelInterpretation(){return m.channelInterpretation},set channelInterpretation(I){m.channelInterpretation=I},get context(){return m.context},get inputs(){return[m]},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},get pan(){return b.gain},addEventListener(...I){return m.addEventListener(I[0],I[1],I[2])},dispatchEvent(...I){return m.dispatchEvent(I[0])},removeEventListener(...I){return m.removeEventListener(I[0],I[1],I[2])}};let M=!1;const O=()=>{w(),M=!0},N=()=>{C(),M=!1};return i(Ms(k,T),O,N)}},cg=(n,e,t,s,r,i,o)=>(a,c)=>{const l=a.createWaveShaper();if(i!==null&&i.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return t(a,c);it(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();je(l,{curve:u},"curve"),je(l,c,"oversample");let h=null,d=!1;return o(l,"curve",v=>()=>v.call(l),v=>g=>(v.call(l,g),d&&(s(g)&&h===null?h=n(a,l):!s(g)&&h!==null&&(h(),h=null)),g)),r(l,()=>{d=!0,s(l.curve)&&(h=n(a,l))},()=>{d=!1,h!==null&&(h(),h=null)})},lg=(n,e,t,s,r)=>(i,{curve:o,oversample:a,...c})=>{const l=i.createWaveShaper(),u=i.createWaveShaper();it(l,c),it(u,c);const h=t(i,{...c,gain:1}),d=t(i,{...c,gain:-1}),p=t(i,{...c,gain:1}),f=t(i,{...c,gain:-1});let v=null,g=!1,y=null;const x={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(b){h.channelCount=b,d.channelCount=b,l.channelCount=b,p.channelCount=b,u.channelCount=b,f.channelCount=b},get channelCountMode(){return l.channelCountMode},set channelCountMode(b){h.channelCountMode=b,d.channelCountMode=b,l.channelCountMode=b,p.channelCountMode=b,u.channelCountMode=b,f.channelCountMode=b},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(b){h.channelInterpretation=b,d.channelInterpretation=b,l.channelInterpretation=b,p.channelInterpretation=b,u.channelInterpretation=b,f.channelInterpretation=b},get context(){return l.context},get curve(){return y},set curve(b){if(b!==null&&b.length<2)throw e();if(b===null)l.curve=b,u.curve=b;else{const w=b.length,C=new Float32Array(w+2-w%2),k=new Float32Array(w+2-w%2);C[0]=b[0],k[0]=-b[w-1];const M=Math.ceil((w+1)/2),O=(w+1)/2-1;for(let N=1;N<M;N+=1){const I=N/M*O,P=Math.floor(I),R=Math.ceil(I);C[N]=P===R?b[P]:(1-(I-P))*b[P]+(1-(R-I))*b[R],k[N]=P===R?-b[w-1-P]:-((1-(I-P))*b[w-1-P])-(1-(R-I))*b[w-1-R]}C[M]=w%2===1?b[M-1]:(b[M-2]+b[M-1])/2,l.curve=C,u.curve=k}y=b,g&&(s(y)&&v===null?v=n(i,h):v!==null&&(v(),v=null))},get inputs(){return[h]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(b){l.oversample=b,u.oversample=b},addEventListener(...b){return h.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return h.dispatchEvent(b[0])},removeEventListener(...b){return h.removeEventListener(b[0],b[1],b[2])}};o!==null&&(x.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==x.oversample&&(x.oversample=a);const T=()=>{h.connect(l).connect(p),h.connect(d).connect(u).connect(f).connect(p),g=!0,s(y)&&(v=n(i,h))},m=()=>{h.disconnect(l),l.disconnect(p),h.disconnect(d),d.disconnect(u),u.disconnect(f),f.disconnect(p),g=!1,v!==null&&(v(),v=null)};return r(Ms(x,p),T,m)},Tt=()=>new DOMException("","NotSupportedError"),ug={numberOfChannels:1},hg=(n,e,t,s,r)=>class extends n{constructor(o,a,c){let l;if(typeof o=="number"&&a!==void 0&&c!==void 0)l={length:a,numberOfChannels:o,sampleRate:c};else if(typeof o=="object")l=o;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:h,sampleRate:d}={...ug,...l},p=s(h,u,d);e(or,()=>or(p))||p.addEventListener("statechange",(()=>{let f=0;const v=g=>{this._state==="running"&&(f>0?(p.removeEventListener("statechange",v),g.stopImmediatePropagation(),this._waitForThePromiseToSettle(g)):f+=1)};return v})()),super(p,h),this._length=u,this._nativeOfflineAudioContext=p,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,Rl(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},dg={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},fg=(n,e,t,s,r,i,o)=>class extends n{constructor(c,l){const u=r(c),h={...dg,...l},d=t(u,h),p=i(u),f=p?s():null,v=c.sampleRate/2;super(c,!1,d,f),this._detune=e(this,p,d.detune,153600,-153600),this._frequency=e(this,p,d.frequency,v,-v),this._nativeOscillatorNode=d,this._onended=null,this._oscillatorNodeRenderer=f,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){ks(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),xn(this)&&fr(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},pg=(n,e,t,s,r)=>()=>{const i=new WeakMap;let o=null,a=null,c=null;const l=async(u,h)=>{let d=t(u);const p=vt(d,h);if(!p){const f={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:o===null?void 0:o,type:d.type};d=e(h,f),a!==null&&d.start(a),c!==null&&d.stop(c)}return i.set(h,d),p?(await n(h,u.detune,d.detune),await n(h,u.frequency,d.frequency)):(await s(h,u.detune,d.detune),await s(h,u.frequency,d.frequency)),await r(u,h,d),d};return{set periodicWave(u){o=u},set start(u){a=u},set stop(u){c=u},render(u,h){const d=i.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},mg={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},gg=(n,e,t,s,r,i,o)=>class extends n{constructor(c,l){const u=r(c),h={...mg,...l},d=t(u,h),p=i(u),f=p?s():null;super(c,!1,d,f),this._nativePannerNode=d,this._orientationX=e(this,p,d.orientationX,bt,St),this._orientationY=e(this,p,d.orientationY,bt,St),this._orientationZ=e(this,p,d.orientationZ,bt,St),this._positionX=e(this,p,d.positionX,bt,St),this._positionY=e(this,p,d.positionY,bt,St),this._positionZ=e(this,p,d.positionZ,bt,St),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},vg=(n,e,t,s,r,i,o,a,c,l)=>()=>{const u=new WeakMap;let h=null;const d=async(p,f)=>{let v=null,g=i(p);const y={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation},x={...y,coneInnerAngle:g.coneInnerAngle,coneOuterAngle:g.coneOuterAngle,coneOuterGain:g.coneOuterGain,distanceModel:g.distanceModel,maxDistance:g.maxDistance,panningModel:g.panningModel,refDistance:g.refDistance,rolloffFactor:g.rolloffFactor},T=vt(g,f);if("bufferSize"in g)v=s(f,{...y,gain:1});else if(!T){const m={...x,orientationX:g.orientationX.value,orientationY:g.orientationY.value,orientationZ:g.orientationZ.value,positionX:g.positionX.value,positionY:g.positionY.value,positionZ:g.positionZ.value};g=r(f,m)}if(u.set(f,v===null?g:v),v!==null){if(h===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const N=new o(6,p.context.length,f.sampleRate),I=e(N,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});I.connect(N.destination),h=(async()=>{const P=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(async(R,V)=>{const L=t(N,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:V===0?1:0});return await a(N,R,L.offset),L}));for(let R=0;R<6;R+=1)P[R].connect(I,0,R),P[R].start(0);return l(N)})()}const m=await h,b=s(f,{...y,gain:1});await c(p,f,b);const w=[];for(let N=0;N<m.numberOfChannels;N+=1)w.push(m.getChannelData(N));let C=[w[0][0],w[1][0],w[2][0]],k=[w[3][0],w[4][0],w[5][0]],M=s(f,{...y,gain:1}),O=r(f,{...x,orientationX:C[0],orientationY:C[1],orientationZ:C[2],positionX:k[0],positionY:k[1],positionZ:k[2]});b.connect(M).connect(O.inputs[0]),O.connect(v);for(let N=128;N<m.length;N+=128){const I=[w[0][N],w[1][N],w[2][N]],P=[w[3][N],w[4][N],w[5][N]];if(I.some((R,V)=>R!==C[V])||P.some((R,V)=>R!==k[V])){C=I,k=P;const R=N/f.sampleRate;M.gain.setValueAtTime(0,R),M=s(f,{...y,gain:0}),O=r(f,{...x,orientationX:C[0],orientationY:C[1],orientationZ:C[2],positionX:k[0],positionY:k[1],positionZ:k[2]}),M.gain.setValueAtTime(1,R),b.connect(M).connect(O.inputs[0]),O.connect(v)}}return v}return T?(await n(f,p.orientationX,g.orientationX),await n(f,p.orientationY,g.orientationY),await n(f,p.orientationZ,g.orientationZ),await n(f,p.positionX,g.positionX),await n(f,p.positionY,g.positionY),await n(f,p.positionZ,g.positionZ)):(await a(f,p.orientationX,g.orientationX),await a(f,p.orientationY,g.orientationY),await a(f,p.orientationZ,g.orientationZ),await a(f,p.positionX,g.positionX),await a(f,p.positionY,g.positionY),await a(f,p.positionZ,g.positionZ)),Es(g)?await c(p,f,g.inputs[0]):await c(p,f,g),g};return{render(p,f){const v=u.get(f);return v!==void 0?Promise.resolve(v):d(p,f)}}},_g={disableNormalization:!1},yg=(n,e,t,s)=>class Hl{constructor(i,o){const a=e(i),c=s({..._g,...o}),l=n(a,c);return t.add(l),l}static[Symbol.hasInstance](i){return i!==null&&typeof i=="object"&&Object.getPrototypeOf(i)===Hl.prototype||t.has(i)}},bg=(n,e)=>(t,s,r)=>(n(s).replay(r),e(s,t,r)),wg=(n,e,t)=>async(s,r,i)=>{const o=n(s);await Promise.all(o.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const d=await e(l).render(l,r),p=s.context.destination;!t(l)&&(s!==p||!t(s))&&d.connect(i,u,c)})).reduce((a,c)=>[...a,...c],[]))},Tg=(n,e,t)=>async(s,r,i)=>{const o=e(s);await Promise.all(Array.from(o.activeInputs).map(async([a,c])=>{const u=await n(a).render(a,r);t(a)||u.connect(i,c)}))},xg=(n,e,t,s)=>r=>n(or,()=>or(r))?Promise.resolve(n(s,s)).then(i=>{if(!i){const o=t(r,512,0,1);r.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>r.currentTime,o.connect(r.destination)}return r.startRendering()}):new Promise(i=>{const o=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=a=>{o.disconnect(),i(a.renderedBuffer)},o.connect(r.destination),r.startRendering()}),kg=n=>(e,t)=>{n.set(e,t)},Cg=n=>(e,t)=>n.set(e,t),Sg=(n,e,t,s,r,i,o,a)=>(c,l)=>t(c).render(c,l).then(()=>Promise.all(Array.from(s(l)).map(u=>t(u).render(u,l)))).then(()=>r(l)).then(u=>(typeof u.copyFromChannel!="function"?(o(u),Xo(u)):e(i,()=>i(u))||a(u),n.add(u),u)),Ag={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Og=(n,e,t,s,r,i)=>class extends n{constructor(a,c){const l=r(a),u={...Ag,...c},h=t(l,u),d=i(l),p=d?s():null;super(a,!1,h,p),this._pan=e(this,d,h.pan)}get pan(){return this._pan}},Ig=(n,e,t,s,r)=>()=>{const i=new WeakMap,o=async(a,c)=>{let l=t(a);const u=vt(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,h)}return i.set(c,l),u?await n(c,a.pan,l.pan):await s(c,a.pan,l.pan),Es(l)?await r(a,c,l.inputs[0]):await r(a,c,l),l};return{render(a,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},Ng=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},Eg=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new e(1,128,44100),r=URL.createObjectURL(t);let i=!1,o=!1;try{await s.audioWorklet.addModule(r);const a=new n(s,"a",{numberOfOutputs:0}),c=s.createOscillator();a.port.onmessage=()=>i=!0,a.onprocessorerror=()=>o=!0,c.connect(a),c.start(0),await s.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(r)}return i&&!o},Mg=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),s=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(r=>{t.oncomplete=()=>{s.disconnect(),r(t.currentTime!==0)},t.startRendering()})},Dg=()=>new DOMException("","UnknownError"),Pg={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Rg=(n,e,t,s,r,i,o)=>class extends n{constructor(c,l){const u=r(c),h={...Pg,...l},d=t(u,h),f=i(u)?s():null;super(c,!0,d,f),this._isCurveNullified=!1,this._nativeWaveShaperNode=d,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},Fg=(n,e,t)=>()=>{const s=new WeakMap,r=async(i,o)=>{let a=e(i);if(!vt(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=n(o,l)}return s.set(o,a),Es(a)?await t(i,o,a.inputs[0]):await t(i,o,a),a};return{render(i,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},Vg=()=>typeof window>"u"?null:window,Lg=(n,e)=>t=>{t.copyFromChannel=(s,r,i=0)=>{const o=n(i),a=n(r);if(a>=t.numberOfChannels)throw e();const c=t.length,l=t.getChannelData(a),u=s.length;for(let h=o<0?-o:0;h+o<c&&h<u;h+=1)s[h]=l[h+o]},t.copyToChannel=(s,r,i=0)=>{const o=n(i),a=n(r);if(a>=t.numberOfChannels)throw e();const c=t.length,l=t.getChannelData(a),u=s.length;for(let h=o<0?-o:0;h+o<c&&h<u;h+=1)l[h+o]=s[h]}},Bg=n=>e=>{e.copyFromChannel=(t=>(s,r,i=0)=>{const o=n(i),a=n(r);if(o<e.length)return t.call(e,s,a,o)})(e.copyFromChannel),e.copyToChannel=(t=>(s,r,i=0)=>{const o=n(i),a=n(r);if(o<e.length)return t.call(e,s,a,o)})(e.copyToChannel)},Ug=n=>(e,t)=>{const s=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=s),n(e,"buffer",r=>()=>{const i=r.call(e);return i===s?null:i},r=>i=>r.call(e,i===null?s:i))},qg=(n,e)=>(t,s)=>{s.channelCount=1,s.channelCountMode="explicit",Object.defineProperty(s,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const r=t.createBufferSource();e(s,()=>{const a=s.numberOfInputs;for(let c=0;c<a;c+=1)r.connect(s,0,c)},()=>r.disconnect(s))},Gl=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),Xl=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},_r=(n,e,t,s)=>{let r=n;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:i,set:o}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(n,e,{get:t(i),set:s(o)})},Wg=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),jg=n=>({...n,channelCount:n.numberOfOutputs}),zg=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},Zl=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(s){if(s.code!==9)throw s;Zl(n,e,t+1e-7)}},Hg=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},Gg=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},Xg=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},Jo=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},Yl=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},Qo=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},Zg=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},Yg=n=>{n.start=(e=>(t=0,s=0,r)=>{const i=n.buffer,o=i===null?s:Math.min(i.duration,s);i!==null&&o>i.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,o,r)})(n.start)},$l=(n,e)=>{const t=e.createGain();n.connect(t);const s=(r=>()=>{r.call(n,t),n.removeEventListener("ended",s)})(n.disconnect);n.addEventListener("ended",s),Ms(n,t),n.stop=(r=>{let i=!1;return(o=0)=>{if(i)try{r.call(n,o)}catch{t.gain.setValueAtTime(0,o)}else r.call(n,o),i=!0}})(n.stop)},Ds=(n,e)=>t=>{const s={value:n};return Object.defineProperties(t,{currentTarget:s,target:s}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},$g=gf(ss),Kg=Tf(ss),Jg=Pp(di),Kl=new WeakMap,Qg=Jp(Kl),rn=up(new Map,new WeakMap),pn=Vg(),Jl=Om(rn,mn),ea=Kp(wt),pt=wg(wt,ea,Qn),ev=Af(Jl,qe,pt),Fe=tm(hi),Sn=tg(pn),Me=_m(Sn),Ql=new WeakMap,eu=zp(Ds),yr=Mm(pn),ta=pm(yr),na=mm(pn),tu=gm(pn),ar=Pm(pn),Je=Jf(vf(Ol),wf($g,Kg,Kr,Jg,Jr,wt,Qg,dr,qe,ss,xn,Qn,jr),rn,lm(wo,Jr,wt,qe,ir,xn),mn,fi,Tt,Np(Kr,wo,wt,qe,ir,Fe,xn,Me),Vp(Ql,wt,sn),eu,Fe,ta,na,tu,Me,ar),tv=Sf(Je,ev,mn,Jl,Fe,Me),sa=new WeakSet,Fc=Im(pn),nu=xp(new Uint32Array(1)),ra=Lg(nu,mn),ia=Bg(nu),su=If(sa,rn,Tt,Fc,Sn,Ng(Fc),ra,ia),pi=xf(Nt),ru=Tg(ea,pr,Qn),gn=vp(ru),Ps=Em(pi,rn,Hg,Gg,Xg,Jo,Yl,Qo,Yg,Ug(_r),$l),vn=bg(Qp(pr),ru),nv=Mf(gn,Ps,qe,vn,pt),on=Qf(_f(Il),Ql,Go,ep,uf,hf,df,ff,pf,_o,Sl,yr,Zl),sv=Ef(Je,nv,on,ct,Ps,Fe,Me,Ds),rv=qf(Je,Wf,mn,ct,Dm(Nt,_r),Fe,Me,pt),iv=lp(gn,jl,qe,vn,pt),rs=Cg(Kl),ov=cp(Je,on,iv,fi,jl,Fe,Me,rs),Un=Sm(ss,na),av=qg(ct,Un),qn=qm(yr,av),cv=fp(qn,qe,pt),lv=dp(Je,cv,qn,Fe,Me),uv=gp(gr,qe,pt),hv=mp(Je,uv,gr,Fe,Me,jg),dv=zm(pi,Ps,Nt,Un),Rs=jm(pi,rn,dv,Jo,Qo),fv=Tp(gn,Rs,qe,vn,pt),pv=wp(Je,on,fv,Rs,Fe,Me,Ds),iu=Hm(Tt,_r),mv=Sp(iu,qe,pt),gv=Cp(Je,mv,iu,Fe,Me,rs),vv=Dp(gn,zl,qe,vn,pt),_v=Mp(Je,on,vv,zl,Fe,Me,rs),ou=Gm(Tt),yv=qp(gn,ou,qe,vn,pt),bv=Up(Je,on,yv,ou,Tt,Fe,Me,rs),wv=Yp(gn,Nt,qe,vn,pt),Tv=Zp(Je,on,wv,Nt,Fe,Me),xv=$m(fi,ct,vr,Tt),mi=xg(rn,Nt,vr,Mg(Nt,Sn)),kv=cm(Ps,qe,Sn,pt,mi),Cv=Xm(xv),Sv=om(Je,Cv,kv,Fe,Me,rs),Av=jf(on,qn,Rs,vr,Tt,Gl,Me,_r),au=new WeakMap,Ov=Cm(rv,Av,eu,Me,au,Ds),cu=ng(pi,rn,Jo,Yl,Qo,$l),Iv=pg(gn,cu,qe,vn,pt),Nv=fg(Je,on,cu,Iv,Fe,Me,Ds),lu=yp(Ps),Ev=lg(lu,ct,Nt,Xl,Un),gi=cg(lu,ct,Ev,Xl,Un,yr,_r),Mv=rg(Kr,ct,qn,Nt,vr,gi,Tt,Jr,Gl,Un),uu=sg(Mv),Dv=vg(gn,qn,Rs,Nt,uu,qe,Sn,vn,pt,mi),Pv=gg(Je,on,uu,Dv,Fe,Me,rs),Rv=ig(mn),Fv=yg(Rv,Fe,new WeakSet,zg),Vv=ag(qn,gr,Nt,gi,Tt,Un),hu=og(Vv,Tt),Lv=Ig(gn,hu,qe,vn,pt),Bv=Og(Je,on,hu,Lv,Fe,Me),Uv=Fg(gi,qe,pt),qv=Rg(Je,ct,gi,Uv,Fe,Me,rs),du=ym(pn),oa=Hp(pn),fu=new WeakMap,Wv=nm(fu,Sn),jv=du?bf(rn,Tt,jp(pn),oa,Gp(mf),Fe,Wv,Me,ar,new WeakMap,new WeakMap,Eg(ar,Sn),pn):void 0,zv=vm(ta,Me),Hv=Ip(sa,rn,Op,Wp,new WeakSet,Fe,zv,Yr,or,ra,ia),pu=op(jv,tv,su,sv,ov,lv,hv,pv,gv,Hv,_v,bv,Tv,Sv,Ov,Nv,Pv,Fv,Bv,qv),Gv=bm(Je,Km,Fe,Me),Xv=Tm(Je,Jm,Fe,Me),Zv=xm(Je,Qm,Fe,Me),Yv=eg(ct,Me),$v=km(Je,Yv,Fe),Kv=Uf(pu,ct,Tt,Dg,Gv,Xv,Zv,$v,yr),aa=sm(au),Jv=kf(aa),mu=_p(mn),Qv=Rp(aa),gu=Lp(mn),vu=new WeakMap,e_=$p(vu,sn),t_=Um(mu,mn,ct,qn,gr,Rs,Nt,vr,Tt,gu,oa,e_,Un),n_=Fm(ct,t_,Nt,Tt,Un),s_=ip(gn,mu,Ps,qn,gr,Rs,Nt,Qv,gu,oa,qe,ar,Sn,vn,pt,mi),r_=em(fu),i_=kg(vu),Vc=du?np(Jv,Je,on,s_,n_,wt,r_,Fe,Me,ar,Wg,i_,Zg,Ds):void 0,o_=Ap(Tt,Sn),a_=Sg(sa,rn,ea,aa,mi,Yr,ra,ia),c_=hg(pu,rn,ct,o_,a_),l_=um(hi,ta),u_=hm(Ho,na),h_=dm(Go,tu),d_=fm(hi,Me);function zt(n){return n===void 0}function Te(n){return n!==void 0}function f_(n){return typeof n=="function"}function es(n){return typeof n=="number"}function Kn(n){return Object.prototype.toString.call(n)==="[object Object]"&&n.constructor===Object}function p_(n){return typeof n=="boolean"}function nn(n){return Array.isArray(n)}function Cn(n){return typeof n=="string"}function Dr(n){return Cn(n)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(n)}function pe(n,e){if(!n)throw new Error(e)}function Vn(n,e,t=1/0){if(!(e<=n&&n<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${n}`)}function _u(n){!n.isOffline&&n.state!=="running"&&ca('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let yu=!1,Lc=!1;function Bc(n){yu=n}function m_(n){zt(n)&&yu&&!Lc&&(Lc=!0,ca("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let bu=console;function g_(...n){bu.log(...n)}function ca(...n){bu.warn(...n)}function v_(n){return new Kv(n)}function __(n,e,t){return new c_(n,e,t)}const Rt=typeof self=="object"?self:null,y_=Rt&&(Rt.hasOwnProperty("AudioContext")||Rt.hasOwnProperty("webkitAudioContext"));function b_(n,e,t){return pe(Te(Vc),"AudioWorkletNode only works in a secure context (https or localhost)"),new(n instanceof(Rt==null?void 0:Rt.BaseAudioContext)?Rt==null?void 0:Rt.AudioWorkletNode:Vc)(n,e,t)}function an(n,e,t,s){var r=arguments.length,i=r<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,s);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(i=(r<3?o(i):r>3?o(e,t,i):o(e,t))||i);return r>3&&i&&Object.defineProperty(e,t,i),i}function tt(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(s.next(u))}catch(h){o(h)}}function c(u){try{l(s.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):r(u.value).then(a,c)}l((s=s.apply(n,e||[])).next())})}class w_{constructor(e,t,s,r){this._callback=e,this._type=t,this._minimumUpdateInterval=Math.max(128/(r||44100),.001),this.updateInterval=s,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),s=new Worker(t);s.onmessage=this._callback.bind(this),this._worker=s}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var t;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((t=this._worker)===null||t===void 0||t.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function ts(n){return h_(n)}function Rn(n){return u_(n)}function zr(n){return d_(n)}function hs(n){return l_(n)}function T_(n){return n instanceof su}function x_(n,e){return n==="value"||ts(e)||Rn(e)||T_(e)}function vs(n,...e){if(!e.length)return n;const t=e.shift();if(Kn(n)&&Kn(t))for(const s in t)x_(s,t[s])?n[s]=t[s]:Kn(t[s])?(n[s]||Object.assign(n,{[s]:{}}),vs(n[s],t[s])):Object.assign(n,{[s]:t[s]});return vs(n,...e)}function k_(n,e){return n.length===e.length&&n.every((t,s)=>e[s]===t)}function de(n,e,t=[],s){const r={},i=Array.from(e);if(Kn(i[0])&&s&&!Reflect.has(i[0],s)&&(Object.keys(i[0]).some(a=>Reflect.has(n,a))||(vs(r,{[s]:i[0]}),t.splice(t.indexOf(s),1),i.shift())),i.length===1&&Kn(i[0]))vs(r,i[0]);else for(let o=0;o<t.length;o++)Te(i[o])&&(r[t[o]]=i[o]);return vs(n,r)}function C_(n){return n.constructor.getDefaults()}function _s(n,e){return zt(n)?e:n}function Uc(n,e){return e.forEach(t=>{Reflect.has(n,t)&&delete n[t]}),n}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class An{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||Rt&&this.toString()===Rt.TONE_DEBUG_CLASS)&&g_(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}An.version=Cl;const la=1e-6;function Cs(n,e){return n>e+la}function So(n,e){return Cs(n,e)||Qt(n,e)}function ni(n,e){return n+la<e}function Qt(n,e){return Math.abs(n-e)<la}function S_(n,e,t){return Math.max(Math.min(n,t),e)}class Ht extends An{constructor(){super(),this.name="Timeline",this._timeline=[];const e=de(Ht.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(pe(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];pe(So(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const s=this._search(e,t);return s!==-1?this._timeline[s]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const s=this._search(e,t);return s+1<this._timeline.length?this._timeline[s+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const s=this._search(e);return s-1>=0?this._timeline[s-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(Qt(this._timeline[t].time,e)){for(let s=t;s>=0&&Qt(this._timeline[s].time,e);s--)t=s;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&So(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let s=0;const r=this._timeline.length;let i=r;if(r>0&&this._timeline[r-1][t]<=e)return r-1;for(;s<i;){let o=Math.floor(s+(i-s)/2);const a=this._timeline[o],c=this._timeline[o+1];if(Qt(a[t],e)){for(let l=o;l<this._timeline.length;l++){const u=this._timeline[l];if(Qt(u[t],e))o=l;else break}return o}else{if(ni(a[t],e)&&Cs(c[t],e))return o;Cs(a[t],e)?i=o:s=o+1}}return-1}_iterate(e,t=0,s=this._timeline.length-1){this._timeline.slice(t,s+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const s=this._search(e);return s!==-1&&this._iterate(t,0,s),this}forEachAfter(e,t){const s=this._search(e);return this._iterate(t,s+1),this}forEachBetween(e,t,s){let r=this._search(e),i=this._search(t);return r!==-1&&i!==-1?(this._timeline[r].time!==e&&(r+=1),this._timeline[i].time===t&&(i-=1),this._iterate(s,r,i)):r===-1&&this._iterate(s,0,i),this}forEachFrom(e,t){let s=this._search(e);for(;s>=0&&this._timeline[s].time>=e;)s--;return this._iterate(t,s+1),this}forEachAtTime(e,t){const s=this._search(e);if(s!==-1&&Qt(this._timeline[s].time,e)){let r=s;for(let i=s;i>=0&&Qt(this._timeline[i].time,e);i--)r=i;this._iterate(i=>{t(i)},r,s)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const wu=[];function vi(n){wu.push(n)}function A_(n){wu.forEach(e=>e(n))}const Tu=[];function _i(n){Tu.push(n)}function O_(n){Tu.forEach(e=>e(n))}class br extends An{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(r=>{zt(this._events)&&(this._events={}),this._events.hasOwnProperty(r)||(this._events[r]=[]),this._events[r].push(t)}),this}once(e,t){const s=(...r)=>{t(...r),this.off(e,s)};return this.on(e,s),this}off(e,t){return e.split(/\W+/).forEach(r=>{if(zt(this._events)&&(this._events={}),this._events.hasOwnProperty(r))if(zt(t))this._events[r]=[];else{const i=this._events[r];for(let o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const s=this._events[e].slice(0);for(let r=0,i=s.length;r<i;r++)s[r].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const s=Object.getOwnPropertyDescriptor(br.prototype,t);Object.defineProperty(e.prototype,t,s)})}dispose(){return super.dispose(),this._events=void 0,this}}class xu extends br{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class wr extends xu{constructor(){var e,t;super(),this.name="Context",this._constants=new Map,this._timeouts=new Ht,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const s=de(wr.getDefaults(),arguments,["context"]);s.context?(this._context=s.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=v_({latencyHint:s.latencyHint}),this._latencyHint=s.latencyHint),this._ticker=new w_(this.emit.bind(this,"tick"),s.clockSource,s.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((t=arguments[0])===null||t===void 0)&&t.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=s.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(A_(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,s){return this._context.createBuffer(e,t,s)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,s){return this._context.createPeriodicWave(e,t,s)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return pe(hs(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return pe(hs(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return pe(hs(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){pe(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){pe(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){pe(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){pe(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return b_(this.rawContext,e,t)}addAudioWorkletModule(e){return tt(this,void 0,void 0,function*(){pe(Te(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return tt(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return hs(this._context)?this._context.resume():Promise.resolve()}close(){return tt(this,void 0,void 0,function*(){hs(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&O_(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),s=t.getChannelData(0);for(let i=0;i<s.length;i++)s[i]=e;const r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=t,r.loop=!0,r.start(0),this._constants.set(e,r),r}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();let t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;const s=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:s+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const s=++this._timeoutIds,r=()=>{const i=this.now();this._timeouts.add({callback:()=>{e(),r()},id:s,time:i+t})};return r(),s}}class I_ extends xu{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,s){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,s){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return tt(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function Ye(n,e){nn(e)?e.forEach(t=>Ye(n,t)):Object.defineProperty(n,e,{enumerable:!0,writable:!1})}function ku(n,e){nn(e)?e.forEach(t=>ku(n,t)):Object.defineProperty(n,e,{writable:!0})}const Ee=()=>{};class Le extends An{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Ee;const e=de(Le.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,Cn(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:Ee,onload:Ee,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:qt().sampleRate}set(e){return e instanceof Le?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return tt(this,void 0,void 0,function*(){const t=Le.load(e).then(s=>{this.set(s),this.onload(this)});Le.downloads.push(t);try{yield t}finally{const s=Le.downloads.indexOf(t);Le.downloads.splice(s,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=nn(e)&&e[0].length>0,s=t?e.length:1,r=t?e[0].length:e.length,i=qt(),o=i.createBuffer(s,r,i.sampleRate),a=!t&&s===1?[e]:e;for(let c=0;c<s;c++)o.copyToChannel(a[c],c);return this._buffer=o,this}toMono(e){if(es(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const s=this.numberOfChannels;for(let r=0;r<s;r++){const i=this.toArray(r);for(let o=0;o<i.length;o++)t[o]+=i[o]}t=t.map(r=>r/s),this.fromArray(t)}return this}toArray(e){if(es(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let s=0;s<this.numberOfChannels;s++)t[s]=this.getChannelData(s);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){pe(this.loaded,"Buffer is not loaded");const s=Math.floor(e*this.sampleRate),r=Math.floor(t*this.sampleRate);pe(s<r,"The start time must be less than the end time");const i=r-s,o=qt().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(s,r),a);return new Le(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new Le().fromArray(e)}static fromUrl(e){return tt(this,void 0,void 0,function*(){return yield new Le().load(e)})}static load(e){return tt(this,void 0,void 0,function*(){const t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){const c=t[1].split("|");let l=c[0];for(const u of c)if(Le.supportsType(u)){l=u;break}e=e.replace(t[0],l)}const s=Le.baseUrl===""||Le.baseUrl.endsWith("/")?Le.baseUrl:Le.baseUrl+"/",r=document.createElement("a");r.href=s+e,r.pathname=(r.pathname+r.hash).split("/").map(encodeURIComponent).join("/");const i=yield fetch(r.href);if(!i.ok)throw new Error(`could not load url: ${e}`);const o=yield i.arrayBuffer();return yield qt().decodeAudioData(o)})}static supportsType(e){const t=e.split("."),s=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+s)!==""}static loaded(){return tt(this,void 0,void 0,function*(){for(yield Promise.resolve();Le.downloads.length;)yield Le.downloads[0]})}}Le.baseUrl="";Le.downloads=[];class ua extends wr{constructor(){super({clockSource:"offline",context:zr(arguments[0])?arguments[0]:__(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:zr(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=zr(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return tt(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const s=Math.floor(this.sampleRate/128);e&&t%s===0&&(yield new Promise(r=>setTimeout(r,1)))}})}render(){return tt(this,arguments,void 0,function*(e=!0){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new Le(t)})}close(){return Promise.resolve()}}const Cu=new I_;let Yn=Cu;function qt(){return Yn===Cu&&y_&&N_(new wr),Yn}function N_(n,e=!1){e&&Yn.dispose(),hs(n)?Yn=new wr(n):zr(n)?Yn=new ua(n):Yn=n}function E_(){return Yn.resume()}if(Rt&&!Rt.TONE_SILENCE_LOGGING){const e=` * Tone.js v${Cl} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function M_(n){return Math.pow(10,n/20)}function D_(n){return 20*(Math.log(n)/Math.LN10)}function Su(n){return Math.pow(2,n/12)}let yi=440;function P_(){return yi}function R_(n){yi=n}function Ao(n){return Math.round(Au(n))}function Au(n){return 69+12*Math.log2(n/yi)}function F_(n){return yi*Math.pow(2,(n-69)/12)}class ha extends An{constructor(e,t,s){super(),this.defaultUnits="s",this._val=t,this._units=s,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const s=parseInt(e,10),r=t==="."?1.5:1;return s===1?this._beatsToUnits(this._getTimeSignature())*r:this._beatsToUnits(4/s)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,s)=>{let r=0;return e&&e!=="0"&&(r+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(r+=this._beatsToUnits(parseFloat(t))),s&&s!=="0"&&(r+=this._beatsToUnits(parseFloat(s)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof ha&&this.fromType(this._val),zt(this._val))return this._noArg();if(Cn(this._val)&&zt(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(Kn(this._val)){let e=0;for(const t in this._val)if(Te(this._val[t])){const s=this._val[t],r=new this.constructor(this.context,t).valueOf()*s;e+=r}return e}if(Te(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return Cn(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class tn extends ha{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new tn(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const s=new this.constructor(this.context,e).valueOf(),r=this.valueOf(),a=Math.round(r/s)*s-r;return r+a*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let i=1;i<9;i++){const o=Math.pow(2,i);t.push(o+"n."),t.push(o+"n"),t.push(o+"t")}t.push("0");let s=t[0],r=new tn(this.context,t[0]).toSeconds();return t.forEach(i=>{const o=new tn(this.context,i).toSeconds();Math.abs(o-e)<Math.abs(r-e)&&(s=i,r=o)}),s}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const s=Math.floor(t/this._getTimeSignature());let r=t%1*4;t=Math.floor(t)%this._getTimeSignature();const i=r.toString();return i.length>3&&(r=parseFloat(parseFloat(i).toFixed(3))),[s,t,r].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return Ao(this.toFrequency())}_now(){return this.context.now()}}class Wt extends tn{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return P_()}static set A4(e){R_(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:Wt.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,t){const r=V_[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?r:Wt.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,s){let r=1;return e&&e!=="0"&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(r*=this._beatsToUnits(parseFloat(t))),s&&s!=="0"&&(r*=this._beatsToUnits(parseFloat(s)/4)),r}}})}transpose(e){return new Wt(this.context,this.valueOf()*Su(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return Ao(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/Wt.A4);let s=Math.round(12*t)+57;const r=Math.floor(s/12);return r<0&&(s+=-12*r),L_[s%12]+r.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return F_(e)}static ftom(e){return Ao(e)}}const V_={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},L_=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class tr extends tn{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class It extends An{constructor(){super();const e=de(It.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:qt()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return m_(e),new tn(this.context,e).toSeconds()}toFrequency(e){return new Wt(this.context,e).toFrequency()}toTicks(e){return new tr(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(s=>{zt(e[s])&&delete t[s]}),t}get(){const e=C_(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const s=this[t];Te(s)&&Te(s.value)&&Te(s.setValueAtTime)?e[t]=s.value:s instanceof It?e[t]=s._getPartialProperties(e[t]):nn(s)||es(s)||Cn(s)||p_(s)?e[t]=s:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&Te(this[t])&&(this[t]&&Te(this[t].value)&&Te(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof It?this[t].set(e[t]):this[t]=e[t])}),this}}class da extends Ht{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,s){return Vn(t,0),this.add(Object.assign({},s,{state:e,time:t})),this}getLastState(e,t){const s=this._search(t);for(let r=s;r>=0;r--){const i=this._timeline[r];if(i.state===e)return i}}getNextState(e,t){const s=this._search(t);if(s!==-1)for(let r=s;r<this._timeline.length;r++){const i=this._timeline[r];if(i.state===e)return i}}}class Xe extends It{constructor(){const e=de(Xe.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,pe(Te(e.param)&&(ts(e.param)||e.param instanceof Xe),"param must be an AudioParam");!ts(e.param);)e.param=e.param._param;this._swappable=Te(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new Ht(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,Te(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(It.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return Te(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Te(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return Te(this.maxValue)&&Te(this.minValue)&&Vn(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?M_(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?D_(e):e}setValueAtTime(e,t){const s=this.toSeconds(t),r=this._fromType(e);return pe(isFinite(r)&&isFinite(s),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(r),this.log(this.units,"setValueAtTime",e,s),this._events.add({time:s,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,s),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),s=this._events.getAfter(t),r=this._events.get(t);let i=this._initialValue;if(r===null)i=this._initialValue;else if(r.type==="setTargetAtTime"&&(s===null||s.type==="setValueAtTime")){const o=this._events.getBefore(r.time);let a;o===null?a=this._initialValue:a=o.value,r.type==="setTargetAtTime"&&(i=this._exponentialApproach(r.time,a,r.value,r.constant,t))}else if(s===null)i=r.value;else if(s.type==="linearRampToValueAtTime"||s.type==="exponentialRampToValueAtTime"){let o=r.value;if(r.type==="setTargetAtTime"){const a=this._events.getBefore(r.time);a===null?o=this._initialValue:o=a.value}s.type==="linearRampToValueAtTime"?i=this._linearInterpolate(r.time,o,s.time,s.value,t):i=this._exponentialInterpolate(r.time,o,s.time,s.value,t)}else i=r.value;return this._toType(i)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const s=this._fromType(e),r=this.toSeconds(t);return pe(isFinite(s)&&isFinite(r),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(s),this._events.add({time:r,type:"linearRampToValueAtTime",value:s}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(s,r),this}exponentialRampToValueAtTime(e,t){let s=this._fromType(e);s=Qt(s,0)?this._minOutput:s,this._assertRange(s);const r=this.toSeconds(t);return pe(isFinite(s)&&isFinite(r),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:s}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(s,r),this}exponentialRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialRampToValueAtTime(e,s+this.toSeconds(t)),this}linearRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.linearRampToValueAtTime(e,s+this.toSeconds(t)),this}targetRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialApproachValueAtTime(e,s,t),this}exponentialApproachValueAtTime(e,t,s){t=this.toSeconds(t),s=this.toSeconds(s);const r=Math.log(s+1)/Math.log(200);return this.setTargetAtTime(e,t,r),this.cancelAndHoldAtTime(t+s*.9),this.linearRampToValueAtTime(e,t+s),this}setTargetAtTime(e,t,s){const r=this._fromType(e);pe(isFinite(s)&&s>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(t);return this._assertRange(r),pe(isFinite(r)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:s,time:i,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,i,s),this._param.setTargetAtTime(r,i,s),this}setValueCurveAtTime(e,t,s,r=1){s=this.toSeconds(s),t=this.toSeconds(t);const i=this._fromType(e[0])*r;this.setValueAtTime(this._toType(i),t);const o=s/(e.length-1);for(let a=1;a<e.length;a++){const c=this._fromType(e[a])*r;this.linearRampToValueAtTime(this._toType(c),t+a*o)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return pe(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),s=this._fromType(this.getValueAtTime(t));pe(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+s);const r=this._events.get(t),i=this._events.getAfter(t);return r&&Qt(r.time,t)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),i.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(s),t):i.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(s),t)),this._events.add({time:t,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,t),this}rampTo(e,t=.1,s){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,s):this.linearRampTo(e,t,s),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const s=this._events.get(t);if(s&&s.type==="setTargetAtTime"){const r=this._events.getAfter(s.time),i=r?r.time:t+2,o=(i-t)/10;for(let a=t;a<i;a+=o)e.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,r=>{r.type==="cancelScheduledValues"?e.cancelScheduledValues(r.time):r.type==="setTargetAtTime"?e.setTargetAtTime(r.value,r.time,r.constant):e[r.type](r.value,r.time)}),this}setParam(e){pe(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,s,r,i){return s+(t-s)*Math.exp(-(i-e)/r)}_linearInterpolate(e,t,s,r,i){return t+(r-t)*((i-e)/(s-e))}_exponentialInterpolate(e,t,s,r,i){return t*Math.pow(r/t,(i-e)/(s-e))}}class ye extends It{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return Te(this.input)?ts(this.input)||this.input instanceof Xe?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Te(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return Te(e)&&(e instanceof ye||Rn(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(s=>{s.channelCount=e.channelCount,s.channelCountMode=e.channelCountMode,s.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();pe(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,s=0){return Fs(this,e,t,s),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return ca("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,s=0){return B_(this,e,t,s),this}chain(...e){return Oo(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),Te(this.input)&&(this.input instanceof ye?this.input.dispose():Rn(this.input)&&this.input.disconnect()),Te(this.output)&&(this.output instanceof ye?this.output.dispose():Rn(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Oo(...n){const e=n.shift();n.reduce((t,s)=>(t instanceof ye?t.connect(s):Rn(t)&&Fs(t,s),s),e)}function Fs(n,e,t=0,s=0){for(pe(Te(n),"Cannot connect from undefined node"),pe(Te(e),"Cannot connect to undefined node"),(e instanceof ye||Rn(e))&&pe(e.numberOfInputs>0,"Cannot connect to node with no inputs"),pe(n.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof ye||e instanceof Xe;)Te(e.input)&&(e=e.input);for(;n instanceof ye;)Te(n.output)&&(n=n.output);ts(e)?n.connect(e,t):n.connect(e,t,s)}function B_(n,e,t=0,s=0){if(Te(e))for(;e instanceof ye;)e=e.input;for(;!Rn(n);)Te(n.output)&&(n=n.output);ts(e)?n.disconnect(e,t):Rn(e)?n.disconnect(e,t,s):n.disconnect()}class gt extends ye{constructor(){const e=de(gt.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new Xe({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),Ye(this,"gain")}static getDefaults(){return Object.assign(ye.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Ss extends ye{constructor(e){super(e),this.onended=Ee,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new gt({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const s=this.toSeconds(t);return this._startTime!==-1&&s>=this._startTime&&(this._stopTime===-1||s<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(ye.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Ee})}_startGain(e,t=1){pe(this._startTime===-1,"Source cannot be started more than once");const s=this.toSeconds(this._fadeIn);return this._startTime=e+s,this._startTime=Math.max(this._startTime,this.context.currentTime),s>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+s):this._gainNode.gain.exponentialApproachValueAtTime(t,e,s)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){pe(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.now()),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const s=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+s),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Ee&&(this.onended(this),this.onended=Ee,!this.context.isOffline)){const e=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),pe(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Ee,this}}class fa extends Ss{constructor(){const e=de(fa.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),Fs(this._source,this._gainNode),this.offset=new Xe({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(Ss.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class lt extends ye{constructor(){const e=de(lt.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new fa({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(ye.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,s=0){return pa(this,e,t,s),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,s){return this._param.exponentialRampTo(e,t,s),this}linearRampTo(e,t,s){return this._param.linearRampTo(e,t,s),this}targetRampTo(e,t,s){return this._param.targetRampTo(e,t,s),this}exponentialApproachValueAtTime(e,t,s){return this._param.exponentialApproachValueAtTime(e,t,s),this}setTargetAtTime(e,t,s){return this._param.setTargetAtTime(e,t,s),this}setValueCurveAtTime(e,t,s,r){return this._param.setValueCurveAtTime(e,t,s,r),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,s){return this._param.rampTo(e,t,s),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function pa(n,e,t,s){(e instanceof Xe||ts(e)||e instanceof lt&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof lt&&(e.overridden=!0)),Fs(n,e,t,s)}class ma extends Xe{constructor(){const e=de(ma.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new Ht(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Xe.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,s){t=this.toSeconds(t),this.setRampPoint(t);const r=this._fromType(e),i=this._events.get(t),o=Math.round(Math.max(1/s,1));for(let a=0;a<=o;a++){const c=s*a+t,l=this._exponentialApproach(i.time,i.value,r,s,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}setValueAtTime(e,t){const s=this.toSeconds(t);super.setValueAtTime(e,t);const r=this._events.get(s),i=this._events.previousEvent(r),o=this._getTicksUntilEvent(i,s);return r.ticks=Math.max(o,0),this}linearRampToValueAtTime(e,t){const s=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const r=this._events.get(s),i=this._events.previousEvent(r),o=this._getTicksUntilEvent(i,s);return r.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const s=this._fromType(e),r=this._events.get(t),i=Math.round(Math.max((t-r.time)*10,1)),o=(t-r.time)/i;for(let a=0;a<=i;a++){const c=o*a+r.time,l=this._exponentialInterpolate(r.time,r.value,t,s,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(zt(e.ticks)){const o=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(o,e.time)}const s=this._fromType(this.getValueAtTime(e.time));let r=this._fromType(this.getValueAtTime(t));const i=this._events.get(t);return i&&i.time===t&&i.type==="setValueAtTime"&&(r=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(s+r)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),s=this._events.get(t);return Math.max(this._getTicksUntilEvent(s,t),0)}getDurationOfTicks(e,t){const s=this.toSeconds(t),r=this.getTicksAtTime(t);return this.getTimeOfTick(r+e)-s}getTimeOfTick(e){const t=this._events.get(e,"ticks"),s=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&s&&s.type==="linearRampToValueAtTime"&&t.value!==s.value){const r=this._fromType(this.getValueAtTime(t.time)),o=(this._fromType(this.getValueAtTime(s.time))-r)/(s.time-t.time),a=Math.sqrt(Math.pow(r,2)-2*o*(t.ticks-e)),c=(-r+a)/o,l=(-r-a)/o;return(c>0?c:l)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const s=this.toSeconds(t),r=this.toSeconds(e),i=this.getTicksAtTime(s);return this.getTicksAtTime(s+r)-i}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class ga extends lt{constructor(){const e=de(ga.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new ma({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(lt.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class va extends It{constructor(){const e=de(va.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new da,this._tickOffset=new Ht,this._ticksAtTime=new Ht,this._secondsAtTime=new Ht,this.frequency=new ga({context:this.context,units:e.units,value:e.frequency}),Ye(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},It.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const s=this.toSeconds(e);return this._state.getValueAtTime(s)!=="started"&&(this._state.setStateAtTime("started",s),Te(t)&&this.setTicksAtTime(t,s),this._ticksAtTime.cancel(s),this._secondsAtTime.cancel(s)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const s=this._state.get(t);s&&s.time>0&&(this._tickOffset.cancel(s.time),this._state.cancel(s.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),s=this._state.getLastState("stopped",t),r=this._ticksAtTime.get(t),i={state:"paused",time:t};this._state.add(i);let o=r||s,a=r?r.ticks:0,c=null;return this._state.forEachBetween(o.time,t+this.sampleTime,l=>{let u=o.time;const h=this._tickOffset.get(l.time);h&&h.time>=o.time&&(a=h.ticks,u=h.time),o.state==="started"&&l.state!=="started"&&(a+=this.frequency.getTicksAtTime(l.time)-this.frequency.getTicksAtTime(u),l.time!==i.time&&(c={state:l.state,time:l.time,ticks:a})),o=l}),this._state.remove(i),c&&this._ticksAtTime.add(c),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),s=this.frequency.timeToTicks(e,t);this.setTicksAtTime(s,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),s={state:"paused",time:e};this._state.add(s);const r=this._secondsAtTime.get(e);let i=r||t,o=r?r.seconds:0,a=null;return this._state.forEachBetween(i.time,e+this.sampleTime,c=>{let l=i.time;const u=this._tickOffset.get(c.time);u&&u.time>=i.time&&(o=u.seconds,l=u.time),i.state==="started"&&c.state!=="started"&&(o+=c.time-l,c.time!==s.time&&(a={state:c.state,time:c.time,seconds:o})),i=c}),this._state.remove(s),a&&this._secondsAtTime.add(a),o}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const s=this._tickOffset.get(t),r=this._state.get(t),i=Math.max(s.time,r.time),o=this.frequency.getTicksAtTime(i)+e-s.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(e,t,s){let r=this._state.get(e);this._state.forEachBetween(e,t,o=>{r&&r.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(r.time,e),o.time-this.sampleTime,s),r=o});let i=null;if(r&&r.state==="started"){const o=Math.max(r.time,e),a=this.frequency.getTicksAtTime(o),c=this.frequency.getTicksAtTime(r.time),l=a-c;let u=Math.ceil(l)-l;u=Qt(u,1)?0:u;let h=this.frequency.getTimeOfTick(a+u);for(;h<t;){try{s(h,Math.round(this.getTicksAtTime(h)))}catch(d){i=d;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class bi extends It{constructor(){const e=de(bi.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=Ee,this._lastUpdate=0,this._state=new da("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new va({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Ye(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(It.getDefaults(),{callback:Ee,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){_u(this.context);const s=this.toSeconds(e);return this.log("start",s),this._state.getValueAtTime(s)!=="started"&&(this._state.setStateAtTime("started",s),this._tickSource.start(s,t),s<this._lastUpdate&&this.emit("start",s,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const s=this.toSeconds(t),r=this.getTicksAtTime(s);return this._tickSource.getTimeOfTick(r+e,s)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,s=>{switch(s.state){case"started":const r=this._tickSource.getTicksAtTime(s.time);this.emit("start",s.time,r);break;case"stopped":s.time!==0&&this.emit("stop",s.time);break;case"paused":this.emit("pause",s.time);break}}),this._tickSource.forEachTickBetween(e,t,(s,r)=>{this.callback(s,r)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}br.mixin(bi);class is extends ye{constructor(){const e=de(is.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new gt({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,Ye(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(ye.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class _a extends ye{constructor(){const e=de(_a.getDefaults(),arguments);super(e),this.name="Destination",this.input=new is({context:this.context}),this.output=new gt({context:this.context}),this.volume=this.input.volume,Oo(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(ye.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),Oo(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}vi(n=>{n.destination=new _a({context:n})});_i(n=>{n.destination.dispose()});class U_ extends ye{constructor(){super(...arguments),this.name="Listener",this.positionX=new Xe({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Xe({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Xe({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Xe({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Xe({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Xe({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Xe({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Xe({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Xe({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(ye.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}vi(n=>{n.listener=new U_({context:n})});_i(n=>{n.listener.dispose()});class ya extends An{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=de(ya.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const s=e.urls[t];this.add(t,s,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Ee,onload:Ee,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return pe(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,s=Ee,r=Ee){return Cn(t)?(this.baseUrl&&t.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new Le(this.baseUrl+t,s,r))):this._buffers.set(e.toString(),new Le(t,s,r)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class fs extends tr{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class q_ extends It{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Ht,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){const t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}vi(n=>{n.draw=new q_({context:n})});_i(n=>{n.draw.dispose()});class W_ extends An{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){pe(Te(e.time),"Events must have a time property"),pe(Te(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new j_(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const s of t)if(s.event===e){this._removeNode(s),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let s,r=null;if(t>0)if(e.left.right===null)s=e.left,s.right=e.right,r=s;else{for(s=e.left.right;s.right!==null;)s=s.right;s.parent&&(s.parent.right=s.left,r=s.parent,s.left=e.left,s.right=e.right)}else if(e.right.left===null)s=e.right,s.left=e.left,r=s;else{for(s=e.right.left;s.left!==null;)s=s.left;s.parent&&(s.parent.left=s.right,r=s.parent,s.left=e.left,s.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=s:e.parent.right=s:this._setRoot(s),r&&this._rebalance(r)}e.dispose()}_rotateLeft(e){const t=e.parent,s=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),t!==null?s?t.left=r:t.right=r:this._setRoot(r)}_rotateRight(e){const t=e.parent,s=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),t!==null?s?t.left=r:t.right=r:this._setRoot(r)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let s=t[0];for(let r=1;r<t.length;r++)t[r].low>s.low&&(s=t[r]);return s.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(s=>t.push(s)),t.forEach(s=>{s.event&&e(s.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const s=[];this._root.search(e,s),s.forEach(r=>{r.event&&t(r.event)})}return this}forEachFrom(e,t){if(this._root!==null){const s=[];this._root.searchAfter(e,s),s.forEach(r=>{r.event&&t(r.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class j_{constructor(e,t,s){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=s,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class z_ extends An{constructor(e){super(),this.name="TimelineValue",this._timeline=new Ht({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class As extends ye{constructor(){super(de(As.getDefaults(),arguments,["context"]))}connect(e,t=0,s=0){return pa(this,e,t,s),this}}class Tr extends As{constructor(){const e=de(Tr.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,nn(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):f_(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(lt.getDefaults(),{length:1024})}setMap(e,t=1024){const s=new Float32Array(t);for(let r=0,i=t;r<i;r++){const o=r/(i-1)*2-1;s[r]=e(o,r)}return this.curve=s,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(s=>s.includes(e));pe(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class ba extends As{constructor(){const e=de(ba.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new Tr({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(As.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Ln{constructor(e,t){this.id=Ln._eventId++,this._remainderTime=0;const s=Object.assign(Ln.getDefaults(),t);this.transport=e,this.callback=s.callback,this._once=s.once,this.time=Math.floor(s.time),this._remainderTime=s.time-this.time}static getDefaults(){return{callback:Ee,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const t=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*t),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}Ln._eventId=0;class wa extends Ln{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const s=Object.assign(wa.getDefaults(),t);this.duration=s.duration,this._interval=s.interval,this._nextTick=s.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Ln.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return ni(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new fs(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){ni(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new fs(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const t=this.transport.getTicksAtTime(e);Cs(t,this.time)&&(this._nextTick=this.floatTime+Math.ceil((t-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class wi extends It{constructor(){const e=de(wi.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new z_(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Ht,this._repeatedEvents=new W_,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new bi({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),Ye(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(It.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const s=t%(this._swingTicks*2)/(this._swingTicks*2),r=Math.sin(s*Math.PI)*this._swingAmount;e+=new fs(this.context,this._swingTicks*2/3).toSeconds()*r}Bc(!0),this._timeline.forEachAtTime(t,s=>s.invoke(e)),Bc(!1)}schedule(e,t){const s=new Ln(this,{callback:e,time:new tr(this.context,t).toTicks()});return this._addEvent(s,this._timeline)}scheduleRepeat(e,t,s,r=1/0){const i=new wa(this,{callback:e,duration:new tn(this.context,r).toTicks(),interval:new tn(this.context,t).toTicks(),time:new tr(this.context,s).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(e,t){const s=new Ln(this,{callback:e,once:!0,time:new tr(this.context,t).toTicks()});return this._addEvent(s,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,s=>this.clear(s.id)),this._repeatedEvents.forEachFrom(t,s=>this.clear(s.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new fs(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){this.context.resume();let s;return Te(t)&&(s=this.toTicks(t)),this._clock.start(e,s),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){nn(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new tn(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new tn(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new fs(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new fs(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),s=this._clock.frequency.timeToTicks(e,t);this.ticks=s}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const s=this._clock.getTicksAtTime(t),r=this._clock.frequency.getDurationOfTicks(Math.ceil(s)-s,t),i=t+r;this.emit("stop",i),this._clock.setTicksAtTime(e,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this.emit("ticks",t),this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),s=this.getTicksAtTime(t),r=e-s%e;return this._clock.nextTickTime(r,t)}}syncSignal(e,t){const s=this.now();let r=this.bpm,i=1/(60/r.getValueAtTime(s)/this.PPQ),o=[];if(e.units==="time"){const c=.015625/i,l=new gt(c),u=new ba(-1),h=new gt(c);r.chain(l,u,h),r=h,i=1/i,o=[l,u,h]}t||(e.getValueAtTime(s)!==0?t=e.getValueAtTime(s)/i:t=0);const a=new gt(t);return r.connect(a),a.connect(e._param),o.push(a),this._syncedSignals.push({initial:e.value,nodes:o,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const s=this._syncedSignals[t];s.signal===e&&(s.nodes.forEach(r=>r.dispose()),s.signal.value=s.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),ku(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}br.mixin(wi);vi(n=>{n.transport=new wi({context:n})});_i(n=>{n.transport.dispose()});class Vt extends ye{constructor(e){super(e),this.input=void 0,this._state=new da("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Ee,this._syncedStop=Ee,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new is({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,Ye(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(ye.getDefaults(),{mute:!1,onstop:Ee,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,s){let r=zt(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(r=this._clampToCurrentTime(r),!this._synced&&this._state.getValueAtTime(r)==="started")pe(Cs(r,this._state.get(r).time),"Start time must be strictly greater than previous start time"),this._state.cancel(r),this._state.setStateAtTime("started",r),this.log("restart",r),this.restart(r,t,s);else if(this.log("start",r),this._state.setStateAtTime("started",r),this._synced){const i=this._state.get(r);i&&(i.offset=this.toSeconds(_s(t,0)),i.duration=s?this.toSeconds(s):void 0);const o=this.context.transport.schedule(a=>{this._start(a,t,s)},r);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>r&&this._syncedStart(this.now(),this.context.transport.seconds)}else _u(this.context),this._start(r,t,s);return this}stop(e){let t=zt(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||Te(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const s=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(s)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,s){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,s)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(Cs(t,0)){const s=this._state.get(t);if(s&&s.state==="started"&&s.time!==t){const r=t-this.toSeconds(s.time);let i;s.duration&&(i=this.toSeconds(s.duration)-r),this._start(e,this.toSeconds(s.offset)+r,i)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Ee,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Ti extends Ss{constructor(){const e=de(Ti.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,Fs(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Xe({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Le(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Ss.getDefaults(),{url:new Le,loop:!1,loopEnd:0,loopStart:0,onload:Ee,onerror:Ee,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,s,r=1){pe(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(e);this._startGain(i,r),this.loop?t=_s(t,this.loopStart):t=_s(t,0);let o=Math.max(this.toSeconds(t),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),l=a-c;So(o,a)&&(o=(o-c)%l+c),Qt(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,ni(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),Te(s)){let a=this.toSeconds(s);a=Math.max(a,0),this.stop(i+a)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function os(n,e){return tt(this,void 0,void 0,function*(){const t=e/n.context.sampleRate,s=new ua(1,t,n.context.sampleRate);return new n.constructor(Object.assign(n.get(),{frequency:2/t,detune:0,context:s})).toDestination().start(0),(yield s.render()).getChannelData(0)})}class Ta extends Ss{constructor(){const e=de(Ta.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],Fs(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Xe({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Xe({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),Ye(this,["frequency","detune"])}static getDefaults(){return Object.assign(Ss.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class et extends Vt{constructor(){const e=de(et.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new lt({context:this.context,units:"frequency",value:e.frequency}),Ye(this,"frequency"),this.detune=new lt({context:this.context,units:"cents",value:e.detune}),Ye(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Vt.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),s=new Ta({context:this.context,onended:()=>this.onstop(this)});this._oscillator=s,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return et._periodicWaveCache.find(t=>t.phase===this._phase&&k_(t.partials,this._partials));{const e=et._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const s=this._getCachedPeriodicWave();if(Te(s)){const{partials:r,wave:i}=s;this._wave=i,this._partials=r,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[r,i]=this._getRealImaginary(e,this._phase),o=this.context.createPeriodicWave(r,i);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),et._periodicWaveCache.push({imag:i,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:r,type:this._type,wave:this._wave}),et._periodicWaveCache.length>100&&et._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){Vn(e,0);let t=this._type;const s=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(s&&(t=s[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const r=new Float32Array(e);this._partials.forEach((i,o)=>r[o]=i),this._partials=Array.from(r),this.type=this._type}}_getRealImaginary(e,t){let r=2048;const i=new Float32Array(r),o=new Float32Array(r);let a=1;if(e==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,r=a,this._partials.length===0)return[i,o]}else{const c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);c?(a=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),e=c[1],a=Math.max(a,2),r=a):this._partialCount=0,this._partials=[]}for(let c=1;c<r;++c){const l=2/(c*Math.PI);let u;switch(e){case"sine":u=c<=a?1:0,this._partials[c-1]=u;break;case"square":u=c&1?2*l:0,this._partials[c-1]=u;break;case"sawtooth":u=l*(c&1?1:-1),this._partials[c-1]=u;break;case"triangle":c&1?u=2*(l*l)*(c-1>>1&1?-1:1):u=0,this._partials[c-1]=u;break;case"custom":u=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(i[c]=-u*Math.sin(t*c),o[c]=u*Math.cos(t*c)):(i[c]=0,o[c]=0)}return[i,o]}_inverseFFT(e,t,s){let r=0;const i=e.length;for(let o=0;o<i;o++)r+=e[o]*Math.cos(o*s)+t[o]*Math.sin(o*s);return r}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let s=0;const r=Math.PI*2,i=32;for(let o=0;o<i;o++)s=Math.max(this._inverseFFT(e,t,o/i*r),s);return S_(-this._inverseFFT(e,t,this._phase)/s,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return tt(this,arguments,void 0,function*(e=1024){return os(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}et._periodicWaveCache=[];class H_ extends As{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Tr({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Os extends lt{constructor(){const e=de(Os.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new gt({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(lt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class xi extends Vt{constructor(){const e=de(xi.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new H_({context:this.context}),this._modulationNode=new gt({context:this.context}),this._carrier=new et({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new et({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Os({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Ye(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(et.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return tt(this,arguments,void 0,function*(e=1024){return os(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class ki extends Vt{constructor(){const e=de(ki.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new gt({context:this.context,gain:0}),this._carrier=new et({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new lt({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new et({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Os({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Os({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Ye(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(et.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return tt(this,arguments,void 0,function*(e=1024){return os(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class xr extends Vt{constructor(){const e=de(xr.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new gt({context:this.context,gain:0}),this._thresh=new Tr({context:this.context,mapping:t=>t<=0?-1:1}),this.width=new lt({context:this.context,units:"audioRange",value:e.width}),this._triangle=new et({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Ye(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Vt.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return tt(this,arguments,void 0,function*(e=1024){return os(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Ci extends Vt{constructor(){const e=de(Ci.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new lt({context:this.context,units:"frequency",value:e.frequency}),this.detune=new lt({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,Ye(this,["frequency","detune"])}static getDefaults(){return Object.assign(et.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,s=e/(this._oscillators.length-1);this._forEach((r,i)=>r.detune.value=t+s*i)}}get count(){return this._oscillators.length}set count(e){if(Vn(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const s=new et({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):Ee});this.type==="custom"&&(s.partials=this._partials),this.frequency.connect(s.frequency),this.detune.connect(s.detune),s.detune.overridden=!1,s.connect(this.output),this._oscillators[t]=s}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,s)=>t.phase=this._phase+s/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(){return tt(this,arguments,void 0,function*(e=1024){return os(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class Si extends Vt{constructor(){const e=de(Si.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Os({context:this.context,value:2}),this._pulse=new xr({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new et({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Ye(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Vt.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return tt(this,arguments,void 0,function*(e=1024){return os(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const qc={am:xi,fat:Ci,fm:ki,oscillator:et,pulse:xr,pwm:Si};class si extends Vt{constructor(){const e=de(si.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new lt({context:this.context,units:"frequency",value:e.frequency}),this.detune=new lt({context:this.context,units:"cents",value:e.detune}),Ye(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(et.getDefaults(),ki.getDefaults(),xi.getDefaults(),Ci.getDefaults(),xr.getDefaults(),Si.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=qc[e],s=this.now();if(this._oscillator){const r=this._oscillator;r.stop(s),this.context.setTimeout(()=>r.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(s)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof qc[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&es(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&es(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Cn(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return tt(this,arguments,void 0,function*(e=1024){return os(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function Ou(n,e=1/0){const t=new WeakMap;return function(s,r){Reflect.defineProperty(s,r,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){Vn(i,n,e),t.set(this,i)}})}}function On(n,e=1/0){const t=new WeakMap;return function(s,r){Reflect.defineProperty(s,r,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){Vn(this.toSeconds(i),n,e),t.set(this,i)}})}}class Ai extends Vt{constructor(){const e=de(Ai.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new Le({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Vt.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Ee,onerror:Ee,playbackRate:1,reverse:!1})}load(e){return tt(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=Ee){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,s){return super.start(e,t,s),this}_start(e,t,s){this._loop?t=_s(t,this._loopStart):t=_s(t,0);const r=this.toSeconds(t),i=s;s=_s(s,Math.max(this._buffer.duration-r,0));let o=this.toSeconds(s);o=o/this._playbackRate,e=this.toSeconds(e);const a=new Ti({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&zt(i)?a.start(e,r):a.start(e,r,o-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(s=>s.stop(t))}restart(e,t,s){return super.restart(e,t,s),this}_restart(e,t,s){var r;(r=[...this._activeSources].pop())===null||r===void 0||r.stop(e),this._start(e,t,s)}seek(e,t){const s=this.toSeconds(t);if(this._state.getValueAtTime(s)==="started"){const r=this.toSeconds(e);this._stop(s),this._start(s,r)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&Vn(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&Vn(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),s=this._state.getNextState("stopped",t);s&&s.implicitEnd&&(this._state.cancel(s.time),this._activeSources.forEach(r=>r.cancelStop())),this._activeSources.forEach(r=>{r.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}an([On(0)],Ai.prototype,"fadeIn",void 0);an([On(0)],Ai.prototype,"fadeOut",void 0);class Wn extends ye{constructor(){const e=de(Wn.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new lt({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(ye.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(Cn(e))return e;{let s;for(s in Pr)if(Pr[s][t]===e)return s;return e}}_setCurve(e,t,s){if(Cn(s)&&Reflect.has(Pr,s)){const r=Pr[s];Kn(r)?e!=="_decayCurve"&&(this[e]=r[t]):this[e]=r}else if(nn(s)&&e!=="_decayCurve")this[e]=s;else throw new Error("Envelope: invalid curve: "+s)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let r=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),o=this.getValueAtTime(e);if(o>0){const a=1/r;r=(1-o)/a}if(r<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,r,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,r,e);else{this._sig.cancelAndHoldAtTime(e);let a=this._attackCurve;for(let c=1;c<a.length;c++)if(a[c-1]<=o&&o<=a[c]){a=this._attackCurve.slice(c),a[0]=o;break}this._sig.setValueCurveAtTime(a,e,r,t)}if(i&&this.sustain<1){const a=t*this.sustain,c=e+r;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,i+c):this._sig.exponentialApproachValueAtTime(a,c,i)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const s=this.toSeconds(this.release);s<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,s,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,s,e):(pe(nn(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,s,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,s=1){return t=this.toSeconds(t),this.triggerAttack(t,s),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,s=0){return pa(this,e,t,s),this}asArray(){return tt(this,arguments,void 0,function*(e=1024){const t=e/this.context.sampleRate,s=new ua(1,t,this.context.sampleRate),r=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=r+this.toSeconds(this.release),o=i*.1,a=i+o,c=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/a,decay:t*this.toSeconds(this.decay)/a,release:t*this.toSeconds(this.release)/a,context:s}));return c._sig.toDestination(),c.triggerAttackRelease(t*(r+o)/a,0),(yield s.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}an([On(0)],Wn.prototype,"attack",void 0);an([On(0)],Wn.prototype,"decay",void 0);an([Ou(0,1)],Wn.prototype,"sustain",void 0);an([On(0)],Wn.prototype,"release",void 0);const Pr=(()=>{let e,t;const s=[];for(e=0;e<128;e++)s[e]=Math.sin(e/127*(Math.PI/2));const r=[],i=6.4;for(e=0;e<127;e++){t=e/127;const d=Math.sin(t*(Math.PI*2)*i-Math.PI/2)+1;r[e]=d/10+t*.83}r[127]=1;const o=[],a=5;for(e=0;e<128;e++)o[e]=Math.ceil(e/127*a)/a;const c=[];for(e=0;e<128;e++)t=e/127,c[e]=.5*(1-Math.cos(Math.PI*t));const l=[];for(e=0;e<128;e++){t=e/127;const d=Math.pow(t,3)*4+.2,p=Math.cos(d*Math.PI*2*t);l[e]=Math.abs(p*(1-t))}function u(d){const p=new Array(d.length);for(let f=0;f<d.length;f++)p[f]=1-d[f];return p}function h(d){return d.slice(0).reverse()}return{bounce:{In:u(l),Out:l},cosine:{In:s,Out:h(s)},exponential:"exponential",linear:"linear",ripple:{In:r,Out:u(r)},sine:{In:c,Out:u(c)},step:{In:o,Out:u(o)}}})();let ri=class Iu extends ye{constructor(){const e=de(Iu.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t),this._volume=this.output=new is({context:this.context,volume:e.volume}),this.volume=this._volume.volume,Ye(this,"volume")}static getDefaults(){return Object.assign(ye.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const s=this["_original_"+e]=this[e];this[e]=(...r)=>{const i=r[t],o=this.context.transport.schedule(a=>{r[t]=a,s.apply(this,r)},i);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,t,s,r){const i=this.toSeconds(s),o=this.toSeconds(t);return this.triggerAttack(e,i,r),this.triggerRelease(i+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}};class Is extends ri{constructor(){const e=de(Is.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(ri.getDefaults(),{detune:0,onsilence:Ee,portamento:0})}triggerAttack(e,t,s=1){this.log("triggerAttack",e,t,s);const r=this.toSeconds(t);return this._triggerEnvelopeAttack(r,s),this.setNote(e,r),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const s=this.toSeconds(t),r=e instanceof Wt?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(s)>.05){const i=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,i,s)}else this.frequency.setValueAtTime(r,s);return this}}an([On(0)],Is.prototype,"portamento",void 0);class xa extends Wn{constructor(){super(de(xa.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new gt({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class ii extends Is{constructor(){const e=de(ii.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new si(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new xa(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),Ye(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Is.getDefaults(),{envelope:Object.assign(Uc(Wn.getDefaults(),Object.keys(ye.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Uc(si.getDefaults(),[...Object.keys(Vt.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const s=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+s+r)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Oi extends ii{constructor(){const e=de(Oi.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,Ye(this,["oscillator","envelope"])}static getDefaults(){return vs(Is.getDefaults(),ii.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const s=this.toSeconds(t),r=this.toFrequency(e instanceof Wt?e.toFrequency():e),i=r*this.octaves;return this.oscillator.frequency.setValueAtTime(i,s),this.oscillator.frequency.exponentialRampToValueAtTime(r,s+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}an([Ou(0)],Oi.prototype,"octaves",void 0);an([On(0)],Oi.prototype,"pitchDecay",void 0);const Nu=new Set;function ka(n){Nu.add(n)}function Eu(n,e){const t=`registerProcessor("${n}", ${e})`;Nu.add(t)}const G_=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;ka(G_);const X_=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;ka(X_);const Z_=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;ka(Z_);const Y_="feedback-comb-filter",$_=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;Eu(Y_,$_);class Ns extends ri{constructor(){const e=de(Ns.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const t={};Object.keys(e.urls).forEach(s=>{const r=parseInt(s,10);if(pe(Dr(s)||es(r)&&isFinite(r),`url key is neither a note or midi pitch: ${s}`),Dr(s)){const i=new Wt(this.context,s).toMidi();t[i]=e.urls[s]}else es(r)&&isFinite(r)&&(t[r]=e.urls[r])}),this._buffers=new ya({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(ri.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Ee,onerror:Ee,release:.1,urls:{}})}_findClosest(e){let s=0;for(;s<96;){if(this._buffers.has(e+s))return-s;if(this._buffers.has(e-s))return s;s++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,s=1){return this.log("triggerAttack",e,t,s),Array.isArray(e)||(e=[e]),e.forEach(r=>{const i=Au(new Wt(this.context,r).toFrequency()),o=Math.round(i),a=i-o,c=this._findClosest(o),l=o-c,u=this._buffers.get(l),h=Su(c+a),d=new Ti({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);d.start(t,0,u.duration/h,s),nn(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(d),d.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const p=this._activeSources.get(o),f=p.indexOf(d);f!==-1&&p.splice(f,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(s=>{const r=new Wt(this.context,s).toMidi();if(this._activeSources.has(r)&&this._activeSources.get(r).length){const i=this._activeSources.get(r);t=this.toSeconds(t),i.forEach(o=>{o.stop(t)}),this._activeSources.set(r,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(s=>{for(;s.length;)s.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,s,r=1){const i=this.toSeconds(s);return this.triggerAttack(e,i,r),nn(t)?(pe(nn(e),"notes must be an array when duration is array"),e.forEach((o,a)=>{const c=t[Math.min(a,t.length-1)];this.triggerRelease(o,i+this.toSeconds(c))})):this.triggerRelease(e,i+this.toSeconds(t)),this}add(e,t,s){if(pe(Dr(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Dr(e)){const r=new Wt(this.context,e).toMidi();this._buffers.add(r,t,s)}else this._buffers.add(e,t,s);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}an([On(0)],Ns.prototype,"attack",void 0);an([On(0)],Ns.prototype,"release",void 0);class Ca extends ye{constructor(){const e=de(Ca.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new Xe({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",Ye(this,"pan")}static getDefaults(){return Object.assign(ye.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const K_="bit-crusher",J_=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;Eu(K_,J_);class Qe extends ye{constructor(){const e=de(Qe.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new gt({context:this.context}),Qe._allSolos.has(this.context)||Qe._allSolos.set(this.context,new Set),Qe._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(ye.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),Qe._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){Qe._soloed.has(this.context)||Qe._soloed.set(this.context,new Set),Qe._soloed.get(this.context).add(this)}_removeSolo(){Qe._soloed.has(this.context)&&Qe._soloed.get(this.context).delete(this)}_isSoloed(){return Qe._soloed.has(this.context)&&Qe._soloed.get(this.context).has(this)}_noSolos(){return!Qe._soloed.has(this.context)||Qe._soloed.has(this.context)&&Qe._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Qe._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Qe._allSolos=new Map;Qe._soloed=new Map;class Sa extends ye{constructor(){const e=de(Sa.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new Ca({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new is({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,Ye(this,["pan","volume"])}static getDefaults(){return Object.assign(ye.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class ps extends ye{constructor(){const e=de(ps.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new Qe({solo:e.solo,context:this.context}),this._panVol=this.output=new Sa({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Ye(this,["pan","volume"])}static getDefaults(){return Object.assign(ye.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return ps.buses.has(e)||ps.buses.set(e,new gt({context:this.context})),ps.buses.get(e)}send(e,t=0){const s=this._getBus(e),r=new gt({context:this.context,units:"decibels",gain:t});return this.connect(r),r.connect(s),r}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}ps.buses=new Map;qt().transport;function En(){return qt().transport}qt().destination;qt().destination;qt().listener;qt().draw;qt();var ms=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Q_(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var Aa={},Ii={};function e0(n){var e=new xt(n),t=e.readChunk();if(t.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+t.id+"'";for(var s=t0(t.data),r=[],i=0;!e.eof()&&i<s.numTracks;i++){var o=e.readChunk();if(o.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+o.id+"'";var a=n0(o.data);r.push(a)}return{header:s,tracks:r}}function t0(n){var e=new xt(n),t=e.readUInt16(),s=e.readUInt16(),r={format:t,numTracks:s},i=e.readUInt16();return i&32768?(r.framesPerSecond=256-(i>>8),r.ticksPerFrame=i&255):r.ticksPerBeat=i,r}function n0(n){for(var e=new xt(n),t=[];!e.eof();){var s=i();t.push(s)}return t;var r;function i(){var o={};o.deltaTime=e.readVarInt();var a=e.readUInt8();if((a&240)===240)if(a===255){o.meta=!0;var c=e.readUInt8(),l=e.readVarInt();switch(c){case 0:if(o.type="sequenceNumber",l!==2)throw"Expected length for sequenceNumber event is 2, got "+l;return o.number=e.readUInt16(),o;case 1:return o.type="text",o.text=e.readString(l),o;case 2:return o.type="copyrightNotice",o.text=e.readString(l),o;case 3:return o.type="trackName",o.text=e.readString(l),o;case 4:return o.type="instrumentName",o.text=e.readString(l),o;case 5:return o.type="lyrics",o.text=e.readString(l),o;case 6:return o.type="marker",o.text=e.readString(l),o;case 7:return o.type="cuePoint",o.text=e.readString(l),o;case 32:if(o.type="channelPrefix",l!=1)throw"Expected length for channelPrefix event is 1, got "+l;return o.channel=e.readUInt8(),o;case 33:if(o.type="portPrefix",l!=1)throw"Expected length for portPrefix event is 1, got "+l;return o.port=e.readUInt8(),o;case 47:if(o.type="endOfTrack",l!=0)throw"Expected length for endOfTrack event is 0, got "+l;return o;case 81:if(o.type="setTempo",l!=3)throw"Expected length for setTempo event is 3, got "+l;return o.microsecondsPerBeat=e.readUInt24(),o;case 84:if(o.type="smpteOffset",l!=5)throw"Expected length for smpteOffset event is 5, got "+l;var u=e.readUInt8(),h={0:24,32:25,64:29,96:30};return o.frameRate=h[u&96],o.hour=u&31,o.min=e.readUInt8(),o.sec=e.readUInt8(),o.frame=e.readUInt8(),o.subFrame=e.readUInt8(),o;case 88:if(o.type="timeSignature",l!=2&&l!=4)throw"Expected length for timeSignature event is 4 or 2, got "+l;return o.numerator=e.readUInt8(),o.denominator=1<<e.readUInt8(),l===4?(o.metronome=e.readUInt8(),o.thirtyseconds=e.readUInt8()):(o.metronome=36,o.thirtyseconds=8),o;case 89:if(o.type="keySignature",l!=2)throw"Expected length for keySignature event is 2, got "+l;return o.key=e.readInt8(),o.scale=e.readUInt8(),o;case 127:return o.type="sequencerSpecific",o.data=e.readBytes(l),o;default:return o.type="unknownMeta",o.data=e.readBytes(l),o.metatypeByte=c,o}}else if(a==240){o.type="sysEx";var l=e.readVarInt();return o.data=e.readBytes(l),o}else if(a==247){o.type="endSysEx";var l=e.readVarInt();return o.data=e.readBytes(l),o}else throw"Unrecognised MIDI event type byte: "+a;else{var d;if(a&128)d=e.readUInt8(),r=a;else{if(r===null)throw"Running status byte encountered before status byte";d=a,a=r,o.running=!0}var p=a>>4;switch(o.channel=a&15,p){case 8:return o.type="noteOff",o.noteNumber=d,o.velocity=e.readUInt8(),o;case 9:var f=e.readUInt8();return o.type=f===0?"noteOff":"noteOn",o.noteNumber=d,o.velocity=f,f===0&&(o.byte9=!0),o;case 10:return o.type="noteAftertouch",o.noteNumber=d,o.amount=e.readUInt8(),o;case 11:return o.type="controller",o.controllerType=d,o.value=e.readUInt8(),o;case 12:return o.type="programChange",o.programNumber=d,o;case 13:return o.type="channelAftertouch",o.amount=d,o;case 14:return o.type="pitchBend",o.value=d+(e.readUInt8()<<7)-8192,o;default:throw"Unrecognised MIDI event type: "+p}}}}function xt(n){this.buffer=n,this.bufferLen=this.buffer.length,this.pos=0}xt.prototype.eof=function(){return this.pos>=this.bufferLen};xt.prototype.readUInt8=function(){var n=this.buffer[this.pos];return this.pos+=1,n};xt.prototype.readInt8=function(){var n=this.readUInt8();return n&128?n-256:n};xt.prototype.readUInt16=function(){var n=this.readUInt8(),e=this.readUInt8();return(n<<8)+e};xt.prototype.readInt16=function(){var n=this.readUInt16();return n&32768?n-65536:n};xt.prototype.readUInt24=function(){var n=this.readUInt8(),e=this.readUInt8(),t=this.readUInt8();return(n<<16)+(e<<8)+t};xt.prototype.readInt24=function(){var n=this.readUInt24();return n&8388608?n-16777216:n};xt.prototype.readUInt32=function(){var n=this.readUInt8(),e=this.readUInt8(),t=this.readUInt8(),s=this.readUInt8();return(n<<24)+(e<<16)+(t<<8)+s};xt.prototype.readBytes=function(n){var e=this.buffer.slice(this.pos,this.pos+n);return this.pos+=n,e};xt.prototype.readString=function(n){var e=this.readBytes(n);return String.fromCharCode.apply(null,e)};xt.prototype.readVarInt=function(){for(var n=0;!this.eof();){var e=this.readUInt8();if(e&128)n+=e&127,n<<=7;else return n+e}return n};xt.prototype.readChunk=function(){var n=this.readString(4),e=this.readUInt32(),t=this.readBytes(e);return{id:n,length:e,data:t}};var s0=e0;function r0(n,e){if(typeof n!="object")throw"Invalid MIDI data";e=e||{};var t=n.header||{},s=n.tracks||[],r,i=s.length,o=new ot;for(i0(o,t,i),r=0;r<i;r++)o0(o,s[r],e);return o.buffer}function i0(n,e,t){var s=e.format==null?1:e.format,r=128;e.timeDivision?r=e.timeDivision:e.ticksPerFrame&&e.framesPerSecond?r=-(e.framesPerSecond&255)<<8|e.ticksPerFrame&255:e.ticksPerBeat&&(r=e.ticksPerBeat&32767);var i=new ot;i.writeUInt16(s),i.writeUInt16(t),i.writeUInt16(r),n.writeChunk("MThd",i.buffer)}function o0(n,e,t){var s=new ot,r,i=e.length,o=null;for(r=0;r<i;r++)(t.running===!1||!t.running&&!e[r].running)&&(o=null),o=a0(s,e[r],o,t.useByte9ForNoteOff);n.writeChunk("MTrk",s.buffer)}function a0(n,e,t,s){var r=e.type,i=e.deltaTime,o=e.text||"",a=e.data||[],c=null;switch(n.writeVarInt(i),r){case"sequenceNumber":n.writeUInt8(255),n.writeUInt8(0),n.writeVarInt(2),n.writeUInt16(e.number);break;case"text":n.writeUInt8(255),n.writeUInt8(1),n.writeVarInt(o.length),n.writeString(o);break;case"copyrightNotice":n.writeUInt8(255),n.writeUInt8(2),n.writeVarInt(o.length),n.writeString(o);break;case"trackName":n.writeUInt8(255),n.writeUInt8(3),n.writeVarInt(o.length),n.writeString(o);break;case"instrumentName":n.writeUInt8(255),n.writeUInt8(4),n.writeVarInt(o.length),n.writeString(o);break;case"lyrics":n.writeUInt8(255),n.writeUInt8(5),n.writeVarInt(o.length),n.writeString(o);break;case"marker":n.writeUInt8(255),n.writeUInt8(6),n.writeVarInt(o.length),n.writeString(o);break;case"cuePoint":n.writeUInt8(255),n.writeUInt8(7),n.writeVarInt(o.length),n.writeString(o);break;case"channelPrefix":n.writeUInt8(255),n.writeUInt8(32),n.writeVarInt(1),n.writeUInt8(e.channel);break;case"portPrefix":n.writeUInt8(255),n.writeUInt8(33),n.writeVarInt(1),n.writeUInt8(e.port);break;case"endOfTrack":n.writeUInt8(255),n.writeUInt8(47),n.writeVarInt(0);break;case"setTempo":n.writeUInt8(255),n.writeUInt8(81),n.writeVarInt(3),n.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":n.writeUInt8(255),n.writeUInt8(84),n.writeVarInt(5);var l={24:0,25:32,29:64,30:96},u=e.hour&31|l[e.frameRate];n.writeUInt8(u),n.writeUInt8(e.min),n.writeUInt8(e.sec),n.writeUInt8(e.frame),n.writeUInt8(e.subFrame);break;case"timeSignature":n.writeUInt8(255),n.writeUInt8(88),n.writeVarInt(4),n.writeUInt8(e.numerator);var h=Math.floor(Math.log(e.denominator)/Math.LN2)&255;n.writeUInt8(h),n.writeUInt8(e.metronome),n.writeUInt8(e.thirtyseconds||8);break;case"keySignature":n.writeUInt8(255),n.writeUInt8(89),n.writeVarInt(2),n.writeInt8(e.key),n.writeUInt8(e.scale);break;case"sequencerSpecific":n.writeUInt8(255),n.writeUInt8(127),n.writeVarInt(a.length),n.writeBytes(a);break;case"unknownMeta":e.metatypeByte!=null&&(n.writeUInt8(255),n.writeUInt8(e.metatypeByte),n.writeVarInt(a.length),n.writeBytes(a));break;case"sysEx":n.writeUInt8(240),n.writeVarInt(a.length),n.writeBytes(a);break;case"endSysEx":n.writeUInt8(247),n.writeVarInt(a.length),n.writeBytes(a);break;case"noteOff":var d=s!==!1&&e.byte9||s&&e.velocity==0?144:128;c=d|e.channel,c!==t&&n.writeUInt8(c),n.writeUInt8(e.noteNumber),n.writeUInt8(e.velocity);break;case"noteOn":c=144|e.channel,c!==t&&n.writeUInt8(c),n.writeUInt8(e.noteNumber),n.writeUInt8(e.velocity);break;case"noteAftertouch":c=160|e.channel,c!==t&&n.writeUInt8(c),n.writeUInt8(e.noteNumber),n.writeUInt8(e.amount);break;case"controller":c=176|e.channel,c!==t&&n.writeUInt8(c),n.writeUInt8(e.controllerType),n.writeUInt8(e.value);break;case"programChange":c=192|e.channel,c!==t&&n.writeUInt8(c),n.writeUInt8(e.programNumber);break;case"channelAftertouch":c=208|e.channel,c!==t&&n.writeUInt8(c),n.writeUInt8(e.amount);break;case"pitchBend":c=224|e.channel,c!==t&&n.writeUInt8(c);var p=8192+e.value,f=p&127,v=p>>7&127;n.writeUInt8(f),n.writeUInt8(v);break;default:throw"Unrecognized event type: "+r}return c}function ot(){this.buffer=[]}ot.prototype.writeUInt8=function(n){this.buffer.push(n&255)};ot.prototype.writeInt8=ot.prototype.writeUInt8;ot.prototype.writeUInt16=function(n){var e=n>>8&255,t=n&255;this.writeUInt8(e),this.writeUInt8(t)};ot.prototype.writeInt16=ot.prototype.writeUInt16;ot.prototype.writeUInt24=function(n){var e=n>>16&255,t=n>>8&255,s=n&255;this.writeUInt8(e),this.writeUInt8(t),this.writeUInt8(s)};ot.prototype.writeInt24=ot.prototype.writeUInt24;ot.prototype.writeUInt32=function(n){var e=n>>24&255,t=n>>16&255,s=n>>8&255,r=n&255;this.writeUInt8(e),this.writeUInt8(t),this.writeUInt8(s),this.writeUInt8(r)};ot.prototype.writeInt32=ot.prototype.writeUInt32;ot.prototype.writeBytes=function(n){this.buffer=this.buffer.concat(Array.prototype.slice.call(n,0))};ot.prototype.writeString=function(n){var e,t=n.length,s=[];for(e=0;e<t;e++)s.push(n.codePointAt(e));this.writeBytes(s)};ot.prototype.writeVarInt=function(n){if(n<0)throw"Cannot write negative variable-length integer";if(n<=127)this.writeUInt8(n);else{var e=n,t=[];for(t.push(e&127),e>>=7;e;){var s=e&127|128;t.push(s),e>>=7}this.writeBytes(t.reverse())}};ot.prototype.writeChunk=function(n,e){this.writeString(n),this.writeUInt32(e.length),this.writeBytes(e)};var c0=r0;Ii.parseMidi=s0;Ii.writeMidi=c0;var oi={},ns={};Object.defineProperty(ns,"__esModule",{value:!0});ns.insert=ns.search=void 0;function Mu(n,e,t){t===void 0&&(t="ticks");var s=0,r=n.length,i=r;if(r>0&&n[r-1][t]<=e)return r-1;for(;s<i;){var o=Math.floor(s+(i-s)/2),a=n[o],c=n[o+1];if(a[t]===e){for(var l=o;l<n.length;l++){var u=n[l];u[t]===e&&(o=l)}return o}else{if(a[t]<e&&c[t]>e)return o;a[t]>e?i=o:a[t]<e&&(s=o+1)}}return-1}ns.search=Mu;function l0(n,e,t){if(t===void 0&&(t="ticks"),n.length){var s=Mu(n,e[t],t);n.splice(s+1,0,e)}else n.push(e)}ns.insert=l0;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Header=n.keySignatureKeys=void 0;var e=ns,t=new WeakMap;n.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var s=function(){function r(i){var o=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",t.set(this,480),i){t.set(this,i.header.ticksPerBeat),i.tracks.forEach(function(c){c.forEach(function(l){l.meta&&(l.type==="timeSignature"?o.timeSignatures.push({ticks:l.absoluteTime,timeSignature:[l.numerator,l.denominator]}):l.type==="setTempo"?o.tempos.push({bpm:6e7/l.microsecondsPerBeat,ticks:l.absoluteTime}):l.type==="keySignature"&&o.keySignatures.push({key:n.keySignatureKeys[l.key+7],scale:l.scale===0?"major":"minor",ticks:l.absoluteTime}))})});var a=0;i.tracks[0].forEach(function(c){a+=c.deltaTime,c.meta&&(c.type==="trackName"?o.name=c.text:(c.type==="text"||c.type==="cuePoint"||c.type==="marker"||c.type==="lyrics")&&o.meta.push({text:c.text,ticks:a,type:c.type}))}),this.update()}}return r.prototype.update=function(){var i=this,o=0,a=0;this.tempos.sort(function(c,l){return c.ticks-l.ticks}),this.tempos.forEach(function(c,l){var u=l>0?i.tempos[l-1].bpm:i.tempos[0].bpm,h=c.ticks/i.ppq-a,d=60/u*h;c.time=d+o,o=c.time,a+=h}),this.timeSignatures.sort(function(c,l){return c.ticks-l.ticks}),this.timeSignatures.forEach(function(c,l){var u=l>0?i.timeSignatures[l-1]:i.timeSignatures[0],h=(c.ticks-u.ticks)/i.ppq,d=h/u.timeSignature[0]/(u.timeSignature[1]/4);u.measures=u.measures||0,c.measures=d+u.measures})},r.prototype.ticksToSeconds=function(i){var o=(0,e.search)(this.tempos,i);if(o!==-1){var a=this.tempos[o],c=a.time,l=(i-a.ticks)/this.ppq;return c+60/a.bpm*l}else{var u=i/this.ppq;return 60/120*u}},r.prototype.ticksToMeasures=function(i){var o=(0,e.search)(this.timeSignatures,i);if(o!==-1){var a=this.timeSignatures[o],c=(i-a.ticks)/this.ppq;return a.measures+c/(a.timeSignature[0]/a.timeSignature[1])/4}else return i/this.ppq/4},Object.defineProperty(r.prototype,"ppq",{get:function(){return t.get(this)},enumerable:!1,configurable:!0}),r.prototype.secondsToTicks=function(i){var o=(0,e.search)(this.tempos,i,"time");if(o!==-1){var a=this.tempos[o],c=a.time,l=i-c,u=l/(60/a.bpm);return Math.round(a.ticks+u*this.ppq)}else{var h=i/.5;return Math.round(h*this.ppq)}},r.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(i){return{bpm:i.bpm,ticks:i.ticks}}),timeSignatures:this.timeSignatures}},r.prototype.fromJSON=function(i){this.name=i.name,this.tempos=i.tempos.map(function(o){return Object.assign({},o)}),this.timeSignatures=i.timeSignatures.map(function(o){return Object.assign({},o)}),this.keySignatures=i.keySignatures.map(function(o){return Object.assign({},o)}),this.meta=i.meta.map(function(o){return Object.assign({},o)}),t.set(this,i.ppq),this.update()},r.prototype.setTempo=function(i){this.tempos=[{bpm:i,ticks:0}],this.update()},r}();n.Header=s})(oi);var cr={},Oa={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ControlChange=n.controlChangeIds=n.controlChangeNames=void 0,n.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},n.controlChangeIds=Object.keys(n.controlChangeNames).reduce(function(r,i){return r[n.controlChangeNames[i]]=i,r},{});var e=new WeakMap,t=new WeakMap,s=function(){function r(i,o){e.set(this,o),t.set(this,i.controllerType),this.ticks=i.absoluteTime,this.value=i.value}return Object.defineProperty(r.prototype,"number",{get:function(){return t.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"name",{get:function(){return n.controlChangeNames[this.number]?n.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"time",{get:function(){var i=e.get(this);return i.ticksToSeconds(this.ticks)},set:function(i){var o=e.get(this);this.ticks=o.secondsToTicks(i)},enumerable:!1,configurable:!0}),r.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},r}();n.ControlChange=s})(Oa);var Ni={};Object.defineProperty(Ni,"__esModule",{value:!0});Ni.createControlChanges=void 0;var Rr=Oa;function u0(){return new Proxy({},{get:function(n,e){if(n[e])return n[e];if(Rr.controlChangeIds.hasOwnProperty(e))return n[Rr.controlChangeIds[e]]},set:function(n,e,t){return Rr.controlChangeIds.hasOwnProperty(e)?n[Rr.controlChangeIds[e]]=t:n[e]=t,!0}})}Ni.createControlChanges=u0;var Ei={};Object.defineProperty(Ei,"__esModule",{value:!0});Ei.PitchBend=void 0;var co=new WeakMap,h0=function(){function n(e,t){co.set(this,t),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(n.prototype,"time",{get:function(){var e=co.get(this);return e.ticksToSeconds(this.ticks)},set:function(e){var t=co.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},n}();Ei.PitchBend=h0;var Mi={},Fn={};Object.defineProperty(Fn,"__esModule",{value:!0});Fn.DrumKitByPatchID=Fn.InstrumentFamilyByID=Fn.instrumentByPatchID=void 0;Fn.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"];Fn.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"];Fn.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"};Object.defineProperty(Mi,"__esModule",{value:!0});Mi.Instrument=void 0;var Fr=Fn,Wc=new WeakMap,d0=function(){function n(e,t){if(this.number=0,Wc.set(this,t),this.number=0,e){var s=e.find(function(r){return r.type==="programChange"});s&&(this.number=s.programNumber)}}return Object.defineProperty(n.prototype,"name",{get:function(){return this.percussion?Fr.DrumKitByPatchID[this.number]:Fr.instrumentByPatchID[this.number]},set:function(e){var t=Fr.instrumentByPatchID.indexOf(e);t!==-1&&(this.number=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"family",{get:function(){return this.percussion?"drums":Fr.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"percussion",{get:function(){var e=Wc.get(this);return e.channel===9},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},n.prototype.fromJSON=function(e){this.number=e.number},n}();Mi.Instrument=d0;var Di={};Object.defineProperty(Di,"__esModule",{value:!0});Di.Note=void 0;function f0(n){var e=Math.floor(n/12)-1;return Du(n)+e.toString()}function Du(n){var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],t=n%12;return e[t]}function p0(n){var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return e.indexOf(n)}var m0=function(){var n=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,e={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(t){var s=n.exec(t),r=s[1],i=s[2],o=e[r.toLowerCase()];return o+(parseInt(i,10)+1)*12}}(),cs=new WeakMap,g0=function(){function n(e,t,s){cs.set(this,s),this.midi=e.midi,this.velocity=e.velocity,this.noteOffVelocity=t.velocity,this.ticks=e.ticks,this.durationTicks=t.ticks-e.ticks}return Object.defineProperty(n.prototype,"name",{get:function(){return f0(this.midi)},set:function(e){this.midi=m0(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(e){var t=e-this.octave;this.midi+=t*12},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pitch",{get:function(){return Du(this.midi)},set:function(e){this.midi=12*(this.octave+1)+p0(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){var e=cs.get(this);return e.ticksToSeconds(this.ticks+this.durationTicks)-e.ticksToSeconds(this.ticks)},set:function(e){var t=cs.get(this),s=t.secondsToTicks(this.time+e);this.durationTicks=s-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){var e=cs.get(this);return e.ticksToSeconds(this.ticks)},set:function(e){var t=cs.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bars",{get:function(){var e=cs.get(this);return e.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},n}();Di.Note=g0;Object.defineProperty(cr,"__esModule",{value:!0});cr.Track=void 0;var lo=ns,v0=Oa,_0=Ni,y0=Ei,jc=Mi,b0=Di,Vr=new WeakMap,w0=function(){function n(e,t){var s=this;if(this.name="",this.notes=[],this.controlChanges=(0,_0.createControlChanges)(),this.pitchBends=[],Vr.set(this,t),e){var r=e.find(function(d){return d.type==="trackName"});this.name=r?r.text:""}if(this.instrument=new jc.Instrument(e,this),this.channel=0,e){for(var i=e.filter(function(d){return d.type==="noteOn"}),o=e.filter(function(d){return d.type==="noteOff"}),a=function(){var d=i.shift();c.channel=d.channel;var p=o.findIndex(function(v){return v.noteNumber===d.noteNumber&&v.absoluteTime>=d.absoluteTime});if(p!==-1){var f=o.splice(p,1)[0];c.addNote({durationTicks:f.absoluteTime-d.absoluteTime,midi:d.noteNumber,noteOffVelocity:f.velocity/127,ticks:d.absoluteTime,velocity:d.velocity/127})}},c=this;i.length;)a();var l=e.filter(function(d){return d.type==="controller"});l.forEach(function(d){s.addCC({number:d.controllerType,ticks:d.absoluteTime,value:d.value/127})});var u=e.filter(function(d){return d.type==="pitchBend"});u.forEach(function(d){s.addPitchBend({ticks:d.absoluteTime,value:d.value/Math.pow(2,13)})});var h=e.find(function(d){return d.type==="endOfTrack"});this.endOfTrackTicks=h!==void 0?h.absoluteTime:void 0}}return n.prototype.addNote=function(e){var t=Vr.get(this),s=new b0.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},t);return Object.assign(s,e),(0,lo.insert)(this.notes,s,"ticks"),this},n.prototype.addCC=function(e){var t=Vr.get(this),s=new v0.ControlChange({controllerType:e.number},t);return delete e.number,Object.assign(s,e),Array.isArray(this.controlChanges[s.number])||(this.controlChanges[s.number]=[]),(0,lo.insert)(this.controlChanges[s.number],s,"ticks"),this},n.prototype.addPitchBend=function(e){var t=Vr.get(this),s=new y0.PitchBend({},t);return Object.assign(s,e),(0,lo.insert)(this.pitchBends,s,"ticks"),this},Object.defineProperty(n.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,t=0;t<this.notes.length-1;t++){var s=this.notes[t].time+this.notes[t].duration;e<s&&(e=s)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,t=0;t<this.notes.length-1;t++){var s=this.notes[t].ticks+this.notes[t].durationTicks;e<s&&(e=s)}return e},enumerable:!1,configurable:!0}),n.prototype.fromJSON=function(e){var t=this;this.name=e.name,this.channel=e.channel,this.instrument=new jc.Instrument(void 0,this),this.instrument.fromJSON(e.instrument),e.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=e.endOfTrackTicks);for(var s in e.controlChanges)e.controlChanges[s]&&e.controlChanges[s].forEach(function(r){t.addCC({number:r.number,ticks:r.ticks,value:r.value})});e.notes.forEach(function(r){t.addNote({durationTicks:r.durationTicks,midi:r.midi,ticks:r.ticks,velocity:r.velocity})})},n.prototype.toJSON=function(){for(var e={},t=0;t<127;t++)this.controlChanges.hasOwnProperty(t)&&(e[t]=this.controlChanges[t].map(function(r){return r.toJSON()}));var s={channel:this.channel,controlChanges:e,pitchBends:this.pitchBends.map(function(r){return r.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(r){return r.toJSON()})};return this.endOfTrackTicks!==void 0&&(s.endOfTrackTicks=this.endOfTrackTicks),s},n}();cr.Track=w0;var Pi={};function T0(n){var e=[];return Pu(n,e),e}function Pu(n,e){for(var t=0;t<n.length;t++){var s=n[t];Array.isArray(s)?Pu(s,e):e.push(s)}}const x0=Object.freeze(Object.defineProperty({__proto__:null,flatten:T0},Symbol.toStringTag,{value:"Module"})),k0=Q_(x0);var Mn=ms&&ms.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return n.concat(i||Array.prototype.slice.call(e))};Object.defineProperty(Pi,"__esModule",{value:!0});Pi.encode=void 0;var C0=Ii,S0=oi,A0=k0;function O0(n,e){return[{absoluteTime:n.ticks,channel:e,deltaTime:0,noteNumber:n.midi,type:"noteOn",velocity:Math.floor(n.velocity*127)},{absoluteTime:n.ticks+n.durationTicks,channel:e,deltaTime:0,noteNumber:n.midi,type:"noteOff",velocity:Math.floor(n.noteOffVelocity*127)}]}function I0(n){return(0,A0.flatten)(n.notes.map(function(e){return O0(e,n.channel)}))}function N0(n,e){return{absoluteTime:n.ticks,channel:e,controllerType:n.number,deltaTime:0,type:"controller",value:Math.floor(n.value*127)}}function E0(n){for(var e=[],t=0;t<127;t++)n.controlChanges.hasOwnProperty(t)&&n.controlChanges[t].forEach(function(s){e.push(N0(s,n.channel))});return e}function M0(n,e){return{absoluteTime:n.ticks,channel:e,deltaTime:0,type:"pitchBend",value:n.value}}function D0(n){var e=[];return n.pitchBends.forEach(function(t){e.push(M0(t,n.channel))}),e}function P0(n){return{absoluteTime:0,channel:n.channel,deltaTime:0,programNumber:n.instrument.number,type:"programChange"}}function R0(n){return{absoluteTime:0,deltaTime:0,meta:!0,text:n,type:"trackName"}}function F0(n){return{absoluteTime:n.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/n.bpm),type:"setTempo"}}function V0(n){return{absoluteTime:n.ticks,deltaTime:0,denominator:n.timeSignature[1],meta:!0,metronome:24,numerator:n.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function L0(n){var e=S0.keySignatureKeys.indexOf(n.key);return{absoluteTime:n.ticks,deltaTime:0,key:e+7,meta:!0,scale:n.scale==="major"?0:1,type:"keySignature"}}function B0(n){return{absoluteTime:n.ticks,deltaTime:0,meta:!0,text:n.text,type:n.type}}function U0(n){var e={header:{format:1,numTracks:n.tracks.length+1,ticksPerBeat:n.header.ppq},tracks:Mn([Mn(Mn(Mn(Mn([{absoluteTime:0,deltaTime:0,meta:!0,text:n.header.name,type:"trackName"}],n.header.keySignatures.map(function(t){return L0(t)}),!0),n.header.meta.map(function(t){return B0(t)}),!0),n.header.tempos.map(function(t){return F0(t)}),!0),n.header.timeSignatures.map(function(t){return V0(t)}),!0)],n.tracks.map(function(t){return Mn(Mn(Mn([R0(t.name),P0(t)],I0(t),!0),E0(t),!0),D0(t),!0)}),!0)};return e.tracks=e.tracks.map(function(t){t=t.sort(function(r,i){return r.absoluteTime-i.absoluteTime});var s=0;return t.forEach(function(r){r.deltaTime=r.absoluteTime-s,s=r.absoluteTime,delete r.absoluteTime}),t.push({deltaTime:0,meta:!0,type:"endOfTrack"}),t}),new Uint8Array((0,C0.writeMidi)(e))}Pi.encode=U0;(function(n){var e=ms&&ms.__awaiter||function(h,d,p,f){function v(g){return g instanceof p?g:new p(function(y){y(g)})}return new(p||(p=Promise))(function(g,y){function x(b){try{m(f.next(b))}catch(w){y(w)}}function T(b){try{m(f.throw(b))}catch(w){y(w)}}function m(b){b.done?g(b.value):v(b.value).then(x,T)}m((f=f.apply(h,d||[])).next())})},t=ms&&ms.__generator||function(h,d){var p={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,v,g,y;return y={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function x(m){return function(b){return T([m,b])}}function T(m){if(f)throw new TypeError("Generator is already executing.");for(;p;)try{if(f=1,v&&(g=m[0]&2?v.return:m[0]?v.throw||((g=v.return)&&g.call(v),0):v.next)&&!(g=g.call(v,m[1])).done)return g;switch(v=0,g&&(m=[m[0]&2,g.value]),m[0]){case 0:case 1:g=m;break;case 4:return p.label++,{value:m[1],done:!1};case 5:p.label++,v=m[1],m=[0];continue;case 7:m=p.ops.pop(),p.trys.pop();continue;default:if(g=p.trys,!(g=g.length>0&&g[g.length-1])&&(m[0]===6||m[0]===2)){p=0;continue}if(m[0]===3&&(!g||m[1]>g[0]&&m[1]<g[3])){p.label=m[1];break}if(m[0]===6&&p.label<g[1]){p.label=g[1],g=m;break}if(g&&p.label<g[2]){p.label=g[2],p.ops.push(m);break}g[2]&&p.ops.pop(),p.trys.pop();continue}m=d.call(h,p)}catch(b){m=[6,b],v=0}finally{f=g=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.Header=n.Track=n.Midi=void 0;var s=Ii,r=oi,i=cr,o=Pi,a=function(){function h(d){var p=this,f=null;if(d){var v=d instanceof ArrayBuffer?new Uint8Array(d):d;f=(0,s.parseMidi)(v),f.tracks.forEach(function(g){var y=0;g.forEach(function(x){y+=x.deltaTime,x.absoluteTime=y})}),f.tracks=u(f.tracks)}this.header=new r.Header(f),this.tracks=[],d&&(this.tracks=f.tracks.map(function(g){return new i.Track(g,p.header)}),f.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return h.fromUrl=function(d){return e(this,void 0,void 0,function(){var p,f;return t(this,function(v){switch(v.label){case 0:return[4,fetch(d)];case 1:return p=v.sent(),p.ok?[4,p.arrayBuffer()]:[3,3];case 2:return f=v.sent(),[2,new h(f)];case 3:throw new Error("Could not load '".concat(d,"'"))}})})},Object.defineProperty(h.prototype,"name",{get:function(){return this.header.name},set:function(d){this.header.name=d},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"duration",{get:function(){var d=this.tracks.map(function(p){return p.duration});return Math.max.apply(Math,d)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"durationTicks",{get:function(){var d=this.tracks.map(function(p){return p.durationTicks});return Math.max.apply(Math,d)},enumerable:!1,configurable:!0}),h.prototype.addTrack=function(){var d=new i.Track(void 0,this.header);return this.tracks.push(d),d},h.prototype.toArray=function(){return(0,o.encode)(this)},h.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(d){return d.toJSON()})}},h.prototype.fromJSON=function(d){var p=this;this.header=new r.Header,this.header.fromJSON(d.header),this.tracks=d.tracks.map(function(f){var v=new i.Track(void 0,p.header);return v.fromJSON(f),v})},h.prototype.clone=function(){var d=new h;return d.fromJSON(this.toJSON()),d},h}();n.Midi=a;var c=cr;Object.defineProperty(n,"Track",{enumerable:!0,get:function(){return c.Track}});var l=oi;Object.defineProperty(n,"Header",{enumerable:!0,get:function(){return l.Header}});function u(h){for(var d=[],p=0;p<h.length;p++)for(var f=d.length,v=new Map,g=Array(16).fill(0),y=0,x=h[p];y<x.length;y++){var T=x[y],m=f,b=T.channel;if(b!==void 0){T.type==="programChange"&&(g[b]=T.programNumber);var w=g[b],C="".concat(w," ").concat(b);v.has(C)?m=v.get(C):(m=f+v.size,v.set(C,m))}d[m]||d.push([]),d[m].push(T)}return d}})(Aa);function zc(n){return Object.prototype.toString.call(n)==="[object Date]"}function Io(n,e,t,s){if(typeof t=="number"||zc(t)){const r=s-t,i=(t-e)/(n.dt||1/60),o=n.opts.stiffness*r,a=n.opts.damping*i,c=(o-a)*n.inv_mass,l=(i+c)*n.dt;return Math.abs(l)<n.opts.precision&&Math.abs(r)<n.opts.precision?s:(n.settled=!1,zc(t)?new Date(t.getTime()+l):t+l)}else{if(Array.isArray(t))return t.map((r,i)=>Io(n,e[i],t[i],s[i]));if(typeof t=="object"){const r={};for(const i in t)r[i]=Io(n,e[i],t[i],s[i]);return r}else throw new Error(`Cannot spring ${typeof t} values`)}}function q0(n,e={}){const t=bh(n),{stiffness:s=.15,damping:r=.8,precision:i=.01}=e;let o,a,c,l=n,u=n,h=1,d=0,p=!1;function f(g,y={}){u=g;const x=c={};return n==null||y.hard||v.stiffness>=1&&v.damping>=1?(p=!0,o=hn.now(),l=g,t.set(n=u),Promise.resolve()):(y.soft&&(d=1/((y.soft===!0?.5:+y.soft)*60),h=0),a||(o=hn.now(),p=!1,a=Oh(T=>{if(p)return p=!1,a=null,!1;h=Math.min(h+d,1);const m={inv_mass:h,opts:v,settled:!0,dt:(T-o)*60/1e3},b=Io(m,l,n,u);return o=T,l=n,t.set(n=b),m.settled&&(a=null),!m.settled})),new Promise(T=>{a.promise.then(()=>{x===c&&T()})}))}const v={set:f,update:(g,y)=>f(g(u,n),y),subscribe:t.subscribe,stiffness:s,damping:r,precision:i};return v}const rt=(n,e=2)=>parseFloat((+n).toFixed(e)),No=function(n,e,t){return n<=e?e:n>=t?t:n},gs=function(n,e,t,s=2){let r=(n-e)/(t-e)*100;return isNaN(r)||r<=0?0:r>=100?100:rt(r,s)},ls=function(n,e,t,s,r=2){if(n<=e)return rt(e,r);if(n>=t)return rt(t,r);n=rt(n,r);let i=(n-e)%s,o=n-i;return Math.abs(i)*2>=s&&(o+=i>0?s:-s),o=No(o,e,t),rt(o,r)},W0=(n="")=>`${n}`.replace(/<[^>]*>/g,""),nr=n=>{const{clientX:e,clientY:t}="touches"in n?n.touches[0]||n.changedTouches[0]:n;return{x:e,y:t}},Hc=n=>{if(!n)return-1;for(var e=0;n=n.previousElementSibling;)e++;return e},uo=(n,e,t)=>{if(t==="min")return e[0]>n;if(t==="max")return e[0]<n;if(t)return e[0]<n&&e[1]>n},ho=(n,e,t=2)=>e.some(s=>rt(s,t)===rt(n,t)),j0=(n,e,t,s,r,i=2)=>rt(e+n*r*s,i);var z0=ze('<span class="pipVal-prefix"> </span>'),H0=ze('<span class="pipVal-suffix"> </span>'),G0=ze('<span class="pipVal"><!> <!> <!></span>'),X0=ze('<span class="pip first"><!></span>'),Z0=ze('<span class="pipVal-prefix"> </span>'),Y0=ze('<span class="pipVal-suffix"> </span>'),$0=ze('<span class="pipVal"><!> <!> <!></span>'),K0=ze('<span class="pip"><!></span>'),J0=ze('<span class="pipVal-prefix"> </span>'),Q0=ze('<span class="pipVal-suffix"> </span>'),ey=ze('<span class="pipVal"><!> <!> <!></span>'),ty=ze('<span class="pip last"><!></span>'),ny=ze('<div class="rangePips"><!> <!> <!></div>');function sy(n,e){ai(e,!1);const t=Pt(),s=Pt(),r=Pt(),i=Pt(),o=Pt(),a=Pt();let c=$(e,"range",8,!1),l=$(e,"min",8,0),u=$(e,"max",8,100),h=$(e,"step",8,1),d=$(e,"value",24,()=>(u()+l())/2),p=$(e,"values",24,()=>[d()]),f=$(e,"vertical",8,!1),v=$(e,"reversed",8,!1),g=$(e,"hoverable",8,!0),y=$(e,"disabled",8,!1),x=$(e,"pipstep",24,()=>{}),T=$(e,"all",8,!0),m=$(e,"first",24,()=>{}),b=$(e,"last",24,()=>{}),w=$(e,"rest",24,()=>{}),C=$(e,"prefix",8,""),k=$(e,"suffix",8,""),M=$(e,"formatter",8,(G,X,ce)=>G),O=$(e,"precision",8,2),N=$(e,"focus",8),I=$(e,"orientationStart",8),P=$(e,"moveHandle",8),R=null;function V(G){R=nr(G)}function L(G,X){const ce=nr(X);!y()&&R&&(Math.sqrt(Math.pow(R.x-ce.x,2)+Math.pow(R.y-ce.y,2))<=5&&P()(null,G),R=null)}Ut(()=>Be(f()),()=>{ie(t,f()?50:100)}),Ut(()=>(Be(u()),Be(l()),Be(h()),_(t)),()=>{ie(s,(u()-l())/h()>=_(t))}),Ut(()=>Be(f()),()=>{ie(r,f()?10:20)}),Ut(()=>(Be(u()),Be(l()),_(r)),()=>{ie(i,(u()-l())/_(r))}),Ut(()=>(Be(x()),_(s),_(i)),()=>{ie(o,x()??(_(s)?_(i):1))}),Ut(()=>(Be(u()),Be(l()),Be(h()),_(o)),()=>{ie(a,Math.floor((u()-l())/(h()*_(o))))}),el(),Ro();var F=ny(),K=oe(F);Ue(K,()=>T()&&m()!==!1||m(),G=>{var X=X0();we(()=>j(X,"data-val",rt(l(),O())));const ce=ft(()=>ho(l(),p(),O())),me=ft(()=>uo(l(),p(),c()));var ee=oe(X);Ue(ee,()=>T()==="label"||m()==="label",ne=>{var _e=G0(),q=oe(_e);Ue(q,C,ve=>{var he=z0(),$e=oe(he,!0);ae(he),we(()=>ln($e,C())),ue(ve,he)});var xe=te(q,2);qr(xe,()=>M()(rt(l(),O()),0,0));var Oe=te(xe,2);Ue(Oe,k,ve=>{var he=H0(),$e=oe(he,!0);ae(he),we(()=>ln($e,k())),ue(ve,he)}),ae(_e),ue(ne,_e)}),ae(X),we(()=>{j(X,"style",`${I()??""}: 0%;`),We(X,"selected",_(ce)),We(X,"in-range",_(me))}),Re("pointerdown",X,ne=>{V(ne)}),Re("pointerup",X,ne=>{L(l(),ne)}),ue(G,X)});var z=te(K,2);Ue(z,()=>T()&&w()!==!1||w(),G=>{var X=cn(),ce=Dt(X);dt(ce,1,()=>Array(_(a)+1),ht,(me,ee,ne)=>{var _e=cn();const q=ft(()=>j0(ne,l(),u(),_(o),h(),O()));var xe=Dt(_e);Ue(xe,()=>_(q)!==l()&&_(q)!==u(),Oe=>{var ve=K0();const he=ft(()=>`${I()??""}: ${gs(_(q),l(),u(),O())??""}%;`),$e=ft(()=>ho(_(q),p(),O())),kt=ft(()=>uo(_(q),p(),c()));var B=oe(ve);Ue(B,()=>T()==="label"||w()==="label",Y=>{var ke=$0(),fe=oe(ke);Ue(fe,()=>!0,Ie=>{var De=Z0(),Pe=oe(De,!0);ae(De),we(()=>ln(Pe,C())),ue(Ie,De)});var le=te(fe,2);qr(le,()=>M()(_(q),ne,gs(_(q),l(),u(),O())));var ge=te(le,2);Ue(ge,()=>!0,Ie=>{var De=Y0(),Pe=oe(De,!0);ae(De),we(()=>ln(Pe,k())),ue(Ie,De)}),ae(ke),ue(Y,ke)}),ae(ve),we(()=>{j(ve,"style",_(he)),j(ve,"data-val",_(q)),We(ve,"selected",_($e)),We(ve,"in-range",_(kt))}),Re("pointerdown",ve,Y=>{V(Y)}),Re("pointerup",ve,Y=>{L(_(q),Y)}),ue(Oe,ve)}),ue(me,_e)}),ue(G,X)});var Z=te(z,2);Ue(Z,()=>T()&&b()!==!1||b(),G=>{var X=ty();we(()=>j(X,"data-val",rt(u(),O())));const ce=ft(()=>ho(u(),p(),O())),me=ft(()=>uo(u(),p(),c()));var ee=oe(X);Ue(ee,()=>T()==="label"||b()==="label",ne=>{var _e=ey(),q=oe(_e);Ue(q,C,ve=>{var he=J0(),$e=oe(he,!0);ae(he),we(()=>ln($e,C())),ue(ve,he)});var xe=te(q,2);qr(xe,()=>M()(rt(u(),O()),_(a),100));var Oe=te(xe,2);Ue(Oe,k,ve=>{var he=Q0(),$e=oe(he,!0);ae(he),we(()=>ln($e,k())),ue(ve,he)}),ae(_e),ue(ne,_e)}),ae(X),we(()=>{j(X,"style",`${I()??""}: 100%;`),We(X,"selected",_(ce)),We(X,"in-range",_(me))}),Re("pointerdown",X,ne=>{V(ne)}),Re("pointerup",X,ne=>{L(u(),ne)}),ue(G,X)}),ae(F),we(()=>{We(F,"disabled",y()),We(F,"hoverable",g()),We(F,"vertical",f()),We(F,"reversed",v()),We(F,"focus",N())}),ue(n,F),ci()}var ry=ze('<span class="rangeFloat-prefix"> </span>'),iy=ze('<span class="rangeFloat-suffix"> </span>'),oy=ze('<span class="rangeFloat"><!><!><!></span>'),ay=ze('<span role="slider" class="rangeHandle"><span class="rangeNub"></span> <!></span>'),cy=ze('<span class="rangeBar"></span>'),ly=ze('<div role="none" class="rangeSlider"><!> <!> <!></div>');function uy(n,e){ai(e,!1);const t=fh(),s=()=>mh(_(ne),"$springPositions",t),r=Pt(),i=Pt();let o=$(e,"slider",28,()=>{}),a=$(e,"range",8,!1),c=$(e,"pushy",8,!1),l=$(e,"min",8,0),u=$(e,"max",8,100),h=$(e,"step",8,1),d=$(e,"values",28,()=>[(u()+l())/2]),p=$(e,"value",28,()=>d()[0]),f=$(e,"vertical",8,!1),v=$(e,"float",8,!1),g=$(e,"reversed",8,!1),y=$(e,"hoverable",8,!0),x=$(e,"disabled",8,!1),T=$(e,"pips",8,!1),m=$(e,"pipstep",24,()=>{}),b=$(e,"all",8,!0),w=$(e,"first",24,()=>{}),C=$(e,"last",24,()=>{}),k=$(e,"rest",24,()=>{}),M=$(e,"id",24,()=>{}),O=$(e,"prefix",8,""),N=$(e,"suffix",8,""),I=$(e,"formatter",8,(D,U,se)=>D),P=$(e,"handleFormatter",24,I),R=$(e,"ariaLabels",24,()=>[]),V=$(e,"precision",8,2),L=$(e,"springValues",24,()=>({stiffness:.15,damping:.4}));const F=_h();let K=Pt(0),z=Pt(!1),Z=!1,G=Pt(!1),X=!1,ce=Pt(d().length-1),me,ee,ne=Pt();const _e=()=>{Oe(),d()[0]!==p()&&d(d()[0]=p(),!0)},q=()=>{xe(),p()!==d()[0]&&p(d()[0])},xe=()=>{typeof p()!="number"&&(p((u()+l())/2),console.error("'value' prop should be a Number"))},Oe=()=>{Array.isArray(d())||(d([p()]),console.error("'values' prop should be an Array"))},ve=()=>{d().length>1&&!Array.isArray(R())&&console.warn("'ariaLabels' prop should be an Array")};xe(),Oe();function he(D){if(!o())return!1;const U=o().querySelectorAll(".handle"),se=Array.prototype.includes.call(U,D),Q=Array.prototype.some.call(U,He=>He.contains(D));return se||Q}function $e(D){return a()==="min"||a()==="max"?D.slice(0,1):a()?D.slice(0,2):D}function kt(D){if(!o())return 0;const U=o().getBoundingClientRect();let se=0,Q=0,He=0;f()?(se=D.y-U.top,Q=se/U.height*100,Q=g()?Q:100-Q):(se=D.x-U.left,Q=se/U.width*100,Q=g()?100-Q:Q),He=(u()-l())/100*Q+l();let ut;return a()===!0&&d()[0]===d()[1]?He>d()[1]?1:0:(ut=d().indexOf([...d()].sort((Kt,Lt)=>Math.abs(He-Kt)-Math.abs(He-Lt))[0]),ut)}function B(D){if(!o())return;const U=o().getBoundingClientRect();let se=0,Q=0,He=0;f()?(se=D.y-U.top,Q=se/U.height*100,Q=g()?Q:100-Q):(se=D.x-U.left,Q=se/U.width*100,Q=g()?100-Q:Q),He=(u()-l())/100*Q+l(),Y(_(ce),He)}function Y(D,U){return U=ls(U,l(),u(),h(),V()),D===null&&(D=_(ce)),a()&&(D===0&&U>d()[1]?c()?d(d()[1]=U,!0):U=d()[1]:D===1&&U<d()[0]&&(c()?d(d()[0]=U,!0):U=d()[0])),d()[D]!==U&&d(d()[D]=U,!0),ee!==U&&(zn(),ee=U),U}function ke(D){return a()==="min"?0:D[0]}function fe(D){return a()==="max"?0:a()==="min"?100-D[0]:100-D[1]}function le(D){D.target,X&&(ie(z,!1),Z=!1,ie(G,!1))}function ge(D){const U=D.target;x()||(ie(ce,Hc(U)),ie(z,!0))}function Ie(D){if(!x()){let U=!1;const se=Hc(D.target);let Q=h();switch(D.ctrlKey||D.metaKey?Q=No((u()-l())/h()/100,rt(Q,V()),rt((u()-l())/100,V())):D.shiftKey&&(Q=No((u()-l())/h()/10,rt(Q,V()),rt((u()-l())/10,V()))),D.key){case"PageDown":Q*=10;case"ArrowRight":case"ArrowUp":Y(se,d()[se]+rt(Q,V())),U=!0;break;case"PageUp":Q*=10;case"ArrowLeft":case"ArrowDown":Y(se,d()[se]-rt(Q,V())),U=!0;break;case"Home":Y(se,l()),U=!0;break;case"End":Y(se,u()),U=!0;break}U&&(D.preventDefault(),D.stopPropagation())}}function De(D){if(!x()){const U=D.target,se=nr(D);ie(z,!0),Z=!0,ie(G,!0),ie(ce,kt(se)),me=ee=ls(d()[_(ce)],l(),u(),h(),V()),In(),D.type==="touchstart"&&!U.matches(".pipVal")&&B(se)}}function Pe(D){D.type==="touchend"&&jn(),ie(G,!1)}function nt(D){const U=D.target;X=!1,o()&&_(z)&&U!==o()&&!o().contains(U)&&ie(z,!1)}function Et(D){x()||Z&&B(nr(D))}function at(D){if(!x()){const U=D.target;Z&&(o()&&(U===o()||o().contains(U))&&(ie(z,!0),!he(U)&&!U.matches(".pipVal")&&B(nr(D))),jn())}Z=!1,ie(G,!1)}function Yt(D){Z=!1,ie(G,!1)}function $t(D){const U=D.target;!x()&&o()&&(U===o()||o().contains(U))&&(X=!0)}function In(){!x()&&F("start",{activeHandle:_(ce),value:me,values:d().map(D=>ls(D,l(),u(),h(),V()))})}function jn(){!x()&&F("stop",{activeHandle:_(ce),startValue:me,value:d()[_(ce)],values:d().map(D=>ls(D,l(),u(),h(),V()))})}function zn(){!x()&&F("change",{activeHandle:_(ce),startValue:me,previousValue:typeof ee>"u"?me:ee,value:d()[_(ce)],values:d().map(D=>ls(D,l(),u(),h(),V()))})}function Vs(D,U){const se=gs(D,l(),u(),V()),Q=P()(D,U,se),He=W0(String(Q));return`${O()}${He}${N()}`}Ut(()=>Be(p()),()=>{p(),_e()}),Ut(()=>(Be(d()),Be(l()),Be(u()),Be(h()),Be(V()),_(K),_(ne),Be(L())),()=>{const D=$e(d().map(U=>ls(U,l(),u(),h(),V())));(d().length!==D.length||!d().every((U,se)=>rt(U,V())===D[se]))&&d(D),_(K)!==d().length?ph(ie(ne,q0(d().map(U=>gs(U,l(),u())),L())),"$springPositions",t):_(ne).set(d().map(U=>gs(U,l(),u()))),ie(K,d().length)}),Ut(()=>Be(d()),()=>{d(),q()}),Ut(()=>Be(R()),()=>{R(),ve()}),Ut(()=>(Be(f()),Be(g())),()=>{ie(r,f()?g()?"top":"bottom":g()?"right":"left")}),Ut(()=>(Be(f()),Be(g())),()=>{ie(i,f()?g()?"bottom":"top":g()?"left":"right")}),el(),Ro();var Ve=ly();Re("mousedown",wn,nt),Re("touchstart",wn,nt),Re("mousemove",wn,Et),Re("touchmove",wn,Et),Re("mouseup",wn,at),Re("touchend",wn,Yt),Re("keydown",wn,$t),Ur(Ve,D=>o(D),()=>o());var E=oe(Ve);dt(E,1,d,ht,(D,U,se)=>{var Q=ay();const He=ft(()=>`z-index: ${_(ce)===se?3:2};`),ut=ft(()=>`${_(r)}: ${s()[se]}%;`);j(Q,"data-handle",se),we(()=>j(Q,"aria-valuetext",Vs(_(U),se)));var Kt=te(oe(Q),2);Ue(Kt,v,Lt=>{var Mt=oy();const Hn=ft(()=>gs(_(U),l(),u(),V())),_n=ft(()=>P()(_(U),se,_(Hn)));var yn=oe(Mt);Ue(yn,O,Bs=>{var Jt=ry(),Gn=oe(Jt,!0);ae(Jt),we(()=>ln(Gn,O())),ue(Bs,Jt)});var Ls=te(yn);qr(Ls,()=>_(_n));var kr=te(Ls);Ue(kr,N,Bs=>{var Jt=iy(),Gn=oe(Jt,!0);ae(Jt),we(()=>ln(Gn,N())),ue(Bs,Jt)}),ae(Mt),ue(Lt,Mt)}),ae(Q),we(()=>{j(Q,"style",`${_(ut)??""} ${_(He)??""}`),j(Q,"aria-label",R()[se]),j(Q,"aria-valuemin",a()===!0&&se===1?d()[0]:l()),j(Q,"aria-valuemax",a()===!0&&se===0?d()[1]:u()),j(Q,"aria-valuenow",_(U)),j(Q,"aria-orientation",f()?"vertical":"horizontal"),j(Q,"aria-disabled",x()),j(Q,"tabindex",x()?-1:0),We(Q,"active",_(z)&&_(ce)===se),We(Q,"press",_(G)&&_(ce)===se)}),Re("blur",Q,le),Re("focus",Q,ge),Re("keydown",Q,Ie),ue(D,Q)});var re=te(E,2);Ue(re,a,D=>{var U=cy();const se=ft(()=>_(r)??""),Q=ft(()=>ke(s())??""),He=ft(()=>_(i)??""),ut=ft(()=>fe(s())??""),Kt=ft(()=>`${_(se)}: ${_(Q)}%; 
             ${_(He)}: ${_(ut)}%;`);we(()=>j(U,"style",_(Kt))),ue(D,U)});var Ce=te(re,2);Ue(Ce,T,D=>{sy(D,{get values(){return d()},get min(){return l()},get max(){return u()},get step(){return h()},get range(){return a()},get vertical(){return f()},get reversed(){return g()},get orientationStart(){return _(r)},get hoverable(){return y()},get disabled(){return x()},get all(){return b()},get first(){return w()},get last(){return C()},get rest(){return k()},get pipstep(){return m()},get prefix(){return O()},get suffix(){return N()},get formatter(){return I()},get precision(){return V()},get focus(){return _(z)},moveHandle:Y})}),ae(Ve),we(()=>{j(Ve,"id",M()),We(Ve,"range",a()),We(Ve,"disabled",x()),We(Ve,"hoverable",y()),We(Ve,"vertical",f()),We(Ve,"reversed",g()),We(Ve,"focus",_(z)),We(Ve,"min",a()==="min"),We(Ve,"max",a()==="max"),We(Ve,"pips",T()),We(Ve,"pip-labels",b()==="label"||w()==="label"||C()==="label"||k()==="label")}),Re("mousedown",Ve,De),Re("mouseup",Ve,Pe),Re("touchstart",Ve,nc(De)),Re("touchend",Ve,nc(Pe)),ue(n,Ve),ci()}function hy(n,e){let t=$(e,"min_val",8,0),s=$(e,"max_val",8,100),r=$(e,"values",28,()=>[t(),s()]);uy(n,{get values(){return r()},set values(i){r(i)},get min(){return t()},get max(){return s()},range:!0,$$legacy:!0})}var dy=(n,e)=>e(n,!1),fy=Zt('<line stroke="var(--very-light)" stroke-width="14" cursor="pointer"></line>'),py=(n,e)=>e(n,!0),my=Zt('<svg><!><line stroke="var(--green)" stroke-width="10" cursor="pointer"></line><line stroke="var(--background-dark)" stroke-width="3" cursor="col-resize"></line></svg>');function gy(n,e){ai(e,!1);let t=$(e,"note_x_px",8,100),s=$(e,"note_y_px",8,100),r=$(e,"note_length",8,100),i=$(e,"selected",8,!1);function o(g,y){g.stopPropagation(),g.button===0?(l()(g.shiftKey),y?h()(g.clientX):u()(g.clientX,g.clientY)):g.button===2&&(g.preventDefault(),c()())}function a(g){g.buttons===2&&c()()}let c=$(e,"removeNote",8),l=$(e,"selectNote",8),u=$(e,"startDragging",8),h=$(e,"startResizing",8);Ro();var d=my();d.__mousedown=[dy,o];var p=oe(d);Ue(p,i,g=>{var y=fy();we(()=>{j(y,"x1",t()-2),j(y,"y1",s()),j(y,"x2",t()+r()+2),j(y,"y2",s())}),ue(g,y)});var f=te(p),v=te(f);v.__mousedown=[py,o],ae(d),we(()=>{j(f,"x1",t()),j(f,"y1",s()),j(f,"x2",t()+r()),j(f,"y2",s()),j(v,"x1",t()+r()-5),j(v,"y1",s()+3),j(v,"x2",t()+r()-5),j(v,"y2",s()-3)}),Re("mouseenter",d,a),ue(n,d),ci()}tl(["mousedown"]);var vy=Zt('<line stroke="var(--background-dark)" stroke-width="1.5"></line><text text-anchor="middle"> </text>',1),_y=Zt('<line stroke="var(--background-dark)" stroke-width="1.5"></line>'),yy=Zt("<svg><!></svg>");function Lr(n,e){let t=$(e,"y_px",8,0),s=$(e,"len_px",8,0),r=$(e,"cents",8,0),i=$(e,"keyboard",8,!0),o=$(e,"text_shift",8,0),a=$(e,"is_played",8,!1);var c=yy(),l=oe(c);Ue(l,i,u=>{var h=vy(),d=Dt(h);j(d,"x2",120);var p=te(d),f=oe(p,!0);we(()=>ln(f,Math.round(r()))),ae(p),we(()=>{j(d,"x1",120-s()),j(d,"y1",t()),j(d,"y2",t()),j(p,"x",120-s()-20+o()),j(p,"y",t()+5),j(p,"fill",a()?"var(--green)":"var(--light)")}),ue(u,h)},u=>{var h=_y();j(h,"x1",0),we(()=>{j(h,"y1",t()),j(h,"x2",s()),j(h,"y2",t())}),ue(u,h)}),ae(c),ue(n,c)}var by=ze('<aside class="absolute w-full h-full bg-gray-200 shadow-lg svelte-vwd7ic"><h1 style="text-align: center; margin-bottom: 10px">INTERACTIONS WITH NOTES</h1> <p>1. Click LMB on the panel to create a note.</p> <p>2. Click LMB on a note to select it, click SHIFT+LMB to select several notes. Click ESCAPE to remove selection.</p> <p>3. Click RMB on a note to delete it. Click DELETE to delete selected note(-s).</p> <p>4. You can drag or resize selected note(-s) using LMB.</p> <p>5. When note(-s) is(are) selected, you can set the number of cents (use "0-9", ".", BACKSPACE, then hit ENTER)</p> <p>6. Use Ctrl+A to select all notes.</p> <p>7. Press ArrowUp and ArrowDown to shift note(-s) up or down by a cent.</p> <p>7. Press SHIFT+ArrowUp and SHIFT+ArrowDown to shift note(-s) up or down by an octave.</p> <h1 style="text-align: center; margin-bottom: 10px; margin-top: 10px">OTHER</h1> <p>1. Use Ctrl+Scroll to zoom in/out.</p> <p>2. Use Spacebar to play/stop.</p> <p>3. Press "Z", "X", "C", ..., "A", "S", "D", ..., "Q", "W", "E", ... buttons while in "Define keys" mode to play notes.</p></aside>');function wy(n,e){let t=$(e,"open",8,!1);var s=by();we(()=>We(s,"open",t())),ue(n,s)}function Ty(n,e,t,s,r){const o=n.target.files;if(!o)return;const a=Array.from(o),c=a.find(u=>u.name.endsWith(".mid")),l=a.find(u=>u.name.endsWith(".scl"));if(c&&l){let u;const h=new FileReader;h.onload=function(d){if(!d.target)return;const p=d.target.result;if(!p)return;u=p.substring(p.lastIndexOf("!")+1).trim().split(/\s+/).map(Number);const f=new FileReader;f.onload=function(v){if(!v.target)return;const g=v.target.result;if(!g)return;const y=new Aa.Midi(g);ie(e,yt(y.header.tempos[0].bpm)),ie(t,yt(y.header.timeSignatures[0].timeSignature[0])),ie(s,yt(y.tracks.flatMap(x=>x.notes.map(T=>({octave:Math.floor(T.midi/u.length),cents:u[T.midi%u.length],time:r(T.time),duration:r(T.duration),selected:!1})))))},f.readAsArrayBuffer(c)},h.readAsText(l)}}var xy=ze('<link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">'),ky=ze('<svg xmlns="http://www.w3.org/2000/svg" width="30" height="28" fill="var(--green)" viewBox="0 0 30 28"><path d="M0 0 14 28 16 28 30 0 0 0"></path></svg>'),Cy=ze('<div class="measure svelte-166zlhl"></div>'),Sy=Zt('<line x1="0" stroke="var(--very-dark)" stroke-width="3"></line>'),Ay=Zt('<text x="18" fill="var(--very-dark)" text-anchor="middle"></text>'),Oy=n=>{n.preventDefault()},Iy=Zt('<line x1="0" stroke="var(--very-dark)" stroke-width="3"></line>'),Ny=Zt('<line stroke="var(--very-dark)" stroke-width="3"></line>'),Ey=Zt('<line stroke="var(--background-dark)" stroke-width="1"></line>'),My=Zt('<line stroke="var(--background-dark)" stroke-width="2"></line><!>',1),Dy=Zt('<line stroke="var(--green)" stroke-width="2"></line>'),Py=(n,e)=>{ie(e,!_(e))},Ry=(n,e,t,s)=>{ie(e,!_(e)),_(e)&&(ie(t,!1),ie(s,!1))},Fy=(n,e,t)=>{ie(e,!_(e)),_(e)&&ie(t,!1)},Vy=(n,e)=>{ie(e,!_(e))},Ly=(n,e)=>{ie(e,!_(e))},By=()=>{var n;(n=document.getElementById("import_files"))==null||n.click()},Uy=(n,e)=>{e()},qy=ze('<div id="entered_number_sign" class="svelte-166zlhl"> </div> <!> <div id="sequencer"><div id="scale_zones_and_timeline_wrapper" class="svelte-166zlhl"><div id="blank" class="svelte-166zlhl"><div style="margin-top: 15px; margin-left: 5px; cursor: pointer;"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="none" viewBox="0 0 24 24"><path stroke="var(--light)" stroke-width="2" stroke-linejoin="round"></path></svg></div> <div style="margin-top: 15px; margin-left: 5px;"><input id="min_freq_input" type="number" min="1" max="9999" class="svelte-166zlhl"></div></div> <div id="scale_zones_and_timeline_movable"><div id="scale_zone_slider_wrapper" class="svelte-166zlhl"><!></div> <div id="timeline" class="svelte-166zlhl"><!> <!></div></div></div> <div id="keyboard_and_panel_wrapper" class="svelte-166zlhl"><div id="keyboard_wrapper" class="svelte-166zlhl"><div id="keyboard" class="svelte-166zlhl"><svg><!><!><!></svg></div></div> <div id="panel_raw_wrapper" class="svelte-166zlhl"><div id="panel" class="svelte-166zlhl"><svg role="presentation"><!><!><!><!><!><!></svg></div></div></div>  <div id="bottom_panel_wrapper" class="svelte-166zlhl"><div class="bottom_panel_button svelte-166zlhl"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"></path><path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286m1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94"></path></svg></div> <div class="bottom_panel_button svelte-166zlhl"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" viewBox="0 0 20 20"><path d="M18-.0004c1.104 0 2 .896 2 2v16c0 1.0004-.896 2-2 2H2c-1.104 0-2-.895-2-2v-16c0-1.104.896-2 2-2h16m-16 3v2.201l3.272-3.201H3c-.552 0-1 .448-1 1Zm0 5.03v2.828l8.929-8.858h-2.828l-6.101 6.03Zm0 5.657v2.828l14.586-14.515h-2.829L2 13.6866Zm16 3.313v-2.343l-3.272 3.343H17c.552 0 1-.447 1-1Zm0-5.171v-2.829l-8.929 9h2.828l6.101-6.171Zm0-5.657v-2.828l-14.586 14.656h2.829L18 6.1716Z"></path></svg></div> <span class="vertical_separator svelte-166zlhl"></span> <h style="margin-right: 15px;">Define keys:</h> <div class="bottom_panel_button svelte-166zlhl"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" viewBox="0 0 30 21"><path d="M0 3 7 3 7 0 23 0 23 3 30 3 30 5 23 5 23 8 7 8 7 5 0 5M0 17 7 17 7 14 23 14 23 17 30 17 30 19 23 19 23 22 7 22 7 19 0 19"></path></svg></div> <span class="vertical_separator svelte-166zlhl"></span> <h style="margin-right: 15px;">Time:</h> <div class="bottom_panel_element svelte-166zlhl"><h>Signature:</h> <select id="beats_per_measure_select" class="svelte-166zlhl"><option>2/4</option><option>3/4</option><option>4/4</option><option>5/4</option></select></div> <div class="bottom_panel_element svelte-166zlhl"><h>Grid:</h> <select id="divisions_of_beat_select" class="svelte-166zlhl"><option>1</option><option>1/2</option><option>1/3</option><option>1/4</option><option>1/6</option><option>1/8</option><option>1/12</option><option>1/16</option></select></div> <div class="bottom_panel_button svelte-166zlhl"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" viewBox="0 0 30 30"><path d="M6 0 6 7 0 7 0 9 6 9 6 21 0 21 0 23 6 23 6 30 8 30 8 23 14 23 14 30 16 30 16 23 22 23 22 30 24 30 24 23 30 23 30 21 24 21 24 9 30 9 30 7 24 7 24 0 22 0 22 7 16 7 16 0 14 0 14 7 8 7 8 0M8 9 14 9 14 21 8 21M16 9 22 9 22 21 16 21"></path></svg></div> <div class="bottom_panel_button svelte-166zlhl"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" viewBox="0 0 30 30"><path d="M6 0 6 4 0 4 0 12 6 12 6 21 0 21 0 23 6 23 6 30 8 30 8 23 14 23 14 30 16 30 16 26 22 26 22 30 24 30 24 23 30 23 30 21 24 21 24 9 30 9 30 7 24 7 24 0 22 0 22 7 16 7 16 0 14 0 14 4 8 4 8 0M8 12 14 12 14 21 8 21M16 9 22 9 22 18 16 18"></path></svg></div> <div class="bottom_panel_element svelte-166zlhl"><h>BPM:</h> <input id="bpm_input" type="number" min="1" max="999" class="svelte-166zlhl"></div> <span class="vertical_separator svelte-166zlhl"></span> <h style="margin-right: 15px;">File:</h> <div class="bottom_panel_button svelte-166zlhl"><input id="import_files" type="file" accept=".mid,.scl" multiple style="display: none;"> <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" viewBox="0 0 24 24"><path d="m19.949,5.536l-3.484-3.486c-1.323-1.322-3.081-2.05-4.95-2.05h-4.515C4.243,0,2,2.243,2,5v6c0,.552.447,1,1,1s1-.448,1-1v-6c0-1.654,1.346-3,3-3h4.515c.163,0,.325.008.485.023v4.977c0,1.654,1.346,3,3,3h4.977c.015.16.023.322.023.485v8.515c0,1.654-1.346,3-3,3H7c-1.654,0-3-1.346-3-3,0-.552-.447-1-1-1s-1,.448-1,1c0,2.757,2.243,5,5,5h10c2.757,0,5-2.243,5-5v-8.515c0-1.871-.729-3.628-2.051-4.95Zm-4.949,2.464c-.552,0-1-.449-1-1V2.659c.38.218.733.487,1.051.805l3.484,3.486c.318.317.587.67.805,1.05h-4.341Zm-4.602,8H1c-.553,0-1-.448-1-1s.447-1,1-1h9.398l-1.293-1.293c-.391-.391-.391-1.024,0-1.414.391-.391,1.023-.391,1.414,0l1.613,1.614c1.154,1.154,1.154,3.032,0,4.187l-1.613,1.614c-.195.195-.451.293-.707.293s-.512-.098-.707-.293c-.391-.39-.391-1.023,0-1.414l1.293-1.293Z"></path></svg></div> <div class="bottom_panel_button svelte-166zlhl"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" viewBox="0 0 24 24"><path d="M18.66,20.9c-.41-.37-1.05-.33-1.41,.09-.57,.65-1.39,1.02-2.25,1.02H5c-1.65,0-3-1.35-3-3V5c0-1.65,1.35-3,3-3h4.51c.16,0,.33,0,.49,.02V7c0,1.65,1.35,3,3,3h5.81c.31,0,.6-.14,.79-.39s.25-.56,.18-.86c-.31-1.22-.94-2.33-1.83-3.22l-3.48-3.48c-1.32-1.32-3.08-2.05-4.95-2.05H5C2.24,0,0,2.24,0,5v14c0,2.76,2.24,5,5,5H15c1.43,0,2.8-.62,3.75-1.69,.37-.41,.33-1.05-.09-1.41ZM12,2.66c.38,.22,.73,.49,1.05,.81l3.48,3.48c.31,.31,.58,.67,.8,1.05h-4.34c-.55,0-1-.45-1-1V2.66Zm11.13,15.43l-1.61,1.61c-.2,.2-.45,.29-.71,.29s-.51-.1-.71-.29c-.39-.39-.39-1.02,0-1.41l1.29-1.29h-7.4c-.55,0-1-.45-1-1s.45-1,1-1h7.4l-1.29-1.29c-.39-.39-.39-1.02,0-1.41s1.02-.39,1.41,0l1.61,1.61c1.15,1.15,1.15,3.03,0,4.19Z"></path></svg></div> <span class="vertical_separator svelte-166zlhl"></span> <div class="bottom_panel_element svelte-166zlhl"><h>Volume:</h> <input id="volume_input" type="range" min="0" max="1" step=".01" class="svelte-166zlhl"></div></div></div>',1);function k1(n,e){ai(e,!0);const t=6,s=300,r=6,i=300;let o=st(1),a=_t(()=>i*_(o)),c=_t(()=>s*_(o));const l=1/32;let u=1/4,h=st(4),d=st(4),p=st(110),f=st(yt([]));function v(S,A){return A!==void 0?(t-(A+S/1200))*_(c):(t-S/1200)*_(c)}function g(S){return(t*_(c)-S)%_(c)*1200/_(c)}function y(S){return Math.floor((t*_(c)-S)/_(c))}function x(S){return S*_(a)}function T(S){return S/_(a)}function m(S){return S*_(h)/_(p)*60}function b(S){return S/_(h)*_(p)/60}let w=_t(()=>Math.max(r,Math.floor(_(f).reduce((S,A)=>x(A.time)>S?x(A.time):S,0)/_(a))+3)),C=_t(()=>_(f).filter(S=>x(S.time+S.duration)>_(le)*_(fe)[0]&&x(S.time)<_(le)*_(fe)[1]).filter((S,A,H)=>A===H.findIndex(W=>W.cents===S.cents)).map(S=>S.cents).sort((S,A)=>S-A)),k=st(yt([]));Ya(()=>{ie(k,yt(Array.from({length:t},()=>Array(_(C).length).fill(!1))))});let M,O,N;function I(){const S=N.scrollLeft;M.style.transform=`translateX(${-S}px)`;const A=N.scrollTop;O.style.transform=`translateY(${-A}px)`}function P(S){if(S.ctrlKey){S.preventDefault();const A=S.deltaY;ie(o,_(o)+A*-.001),ie(o,yt(Math.min(Math.max(.125,_(o)),4)))}}const R=(S,A)=>S.reduce((H,W)=>Math.abs(W-A)<Math.abs(H-A)?W:H);function V(S){if(S.button==0){_(f).forEach(be=>be.selected=!1);const H=S.currentTarget.getBoundingClientRect();let W=S.clientX-H.left;const Ae=S.clientY-H.top;if(_(B)){const be=_(a)/(_(d)*_(h));W=Math.floor(W/be)*be}if(_(he)&&_(C).length!=0){const be=g(Ae),Se=R(_(C),be),Ge=y(Ae);_(f).push({octave:Ge,cents:Se,time:T(W),duration:u,selected:!1})}else _(f).push({octave:y(Ae),cents:g(Ae),time:T(W),duration:u,selected:!1})}}function L(S){_(f).splice(S,1)}function F(S,A){_(f)[S].selected||(_(f)[S].selected=!0,A||_(f).forEach((H,W)=>{W!=S&&(H.selected=!1)}))}function K(S,A,H){const W=_(f).filter(Se=>Se.selected);function Ae(Se){const Ge=Se.clientX-A,Ke=Se.clientY-H;W.forEach(Ne=>{if(Ne.time=T(x(Ne.time)+Ge),Ne.time<0&&(Ne.time=0),!_(he)){const Bt=v(Ne.cents,Ne.octave)+Ke;Ne.cents=g(Bt),Ne.octave=y(Bt),Ne.octave<0?(Ne.octave=0,Ne.cents=0):Ne.octave>t-1&&(Ne.octave=t-1,Ne.cents=1199)}}),A=Se.clientX,H=Se.clientY}function be(){_(B)&&W.forEach(Se=>{const Ge=_(a)/(_(d)*_(h));Se.time=T(Math.floor(x(Se.time)/Ge)*Ge)}),window.removeEventListener("mousemove",Ae),window.removeEventListener("mouseup",be)}window.addEventListener("mousemove",Ae),window.addEventListener("mouseup",be)}function z(S,A){const H=_(f).filter(be=>be.selected);function W(be){const Se=be.clientX-A;H.forEach(Ge=>{Ge.duration+=T(Se),Ge.duration<l&&(Ge.duration=l),u=Ge.duration}),A=be.clientX}function Ae(){_(B)&&H.forEach(be=>{const Se=_(a)/(_(d)*_(h));be.duration=T(Math.max(Math.floor(x(be.duration)/Se),1)*Se),u=be.duration}),window.removeEventListener("mousemove",W),window.removeEventListener("mouseup",Ae)}window.addEventListener("mousemove",W),window.addEventListener("mouseup",Ae)}let Z=st(""),G=st(!1),X;const ce=["KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight"],me=1;function ee(){ie(G,!1),clearTimeout(X),ie(Z,"")}function ne(){ie(G,!0),clearTimeout(X),X=setTimeout(()=>{ee()},3e3)}function _e(S){if(S.code==="Delete"&&ie(f,yt(_(f).filter(A=>!A.selected))),S.code=="Escape"&&(_(f).forEach(A=>A.selected=!1),ee()),S.ctrlKey&&S.keyCode===65&&(S.preventDefault(),_(f).forEach(A=>A.selected=!0)),S.key==" "&&(S.preventDefault(),Ve()),_(f).some(A=>A.selected)){if((S.key>="0"&&S.key<="9"||S.key===".")&&(ie(Z,_(Z)+S.key),ne()),S.key==="Enter"){const A=Number(_(Z));isFinite(A)&&_(f).forEach(H=>{H.selected&&(H.cents=A%1200,H.octave+=Math.floor(A/1200),H.octave>t-1&&(H.octave=t-1))}),ee()}S.key==="Backspace"&&ie(Z,yt(_(Z).slice(0,-1)))}if(_(he)&&ce.includes(S.code)){const A=ce.indexOf(S.code),H=_(C).length,W=me+Math.floor(A/H);if(W<t&&!_(k)[W][A%H]&&W<t){const Ae=_(C)[A%H];In.triggerAttack(zn(Ae,W)),_(k)[W][A%H]=!0}}S.code==="ArrowUp"&&(S.preventDefault(),S.shiftKey?_(f).filter(A=>A.selected).forEach(A=>{A.octave<t-1&&(A.octave+=1)}):_(f).filter(A=>A.selected).forEach(A=>{A.octave=A.octave+Math.floor((A.cents+1)/1200),A.cents=(A.cents+1)%1200,A.octave>=t&&(A.octave=t-1,A.cents=1199)})),S.code==="ArrowDown"&&(S.preventDefault(),S.shiftKey?_(f).filter(A=>A.selected).forEach(A=>{A.octave>0&&(A.octave-=1)}):_(f).filter(A=>A.selected).forEach(A=>{A.cents<1?A.octave>0?(A.cents=1200+A.cents-1,A.octave-=1):A.cents=0:A.cents-=1}))}function q(S){if(_(he)&&ce.includes(S.code)){const A=ce.indexOf(S.code),H=_(C).length,W=me+Math.floor(A/H);if(W<t&&_(k)[W][A%H]&&W<t){const Ae=_(C)[A%H];In.triggerRelease(zn(Ae,W)),_(k)[W][A%H]=!1}}}function xe(S,A){const H=hr(S,A);return{destroy(){H.destroy()}}}let Oe=st(!1),ve=st(!1),he=st(!1),$e=st(!1),kt=st(!0),B=st(!0),Y=0,ke=_t(()=>_(w)*_(h)*_(d)),fe=st(yt([Y,_(ke)])),le=_t(()=>_(w)*_(a)/_(ke)),ge=_t(()=>(_(ve)?_(f).filter(S=>x(S.time+S.duration)>_(le)*_(fe)[0]&&x(S.time)<_(le)*_(fe)[1]):_(f).filter(S=>S.selected)).map(({octave:S,cents:A,time:H,duration:W,selected:Ae})=>({y_px:v(A,S),cents:A})).filter((S,A,H)=>A===H.findIndex(W=>W.y_px===S.y_px)));function Ie(S,A){const H=URL.createObjectURL(S),W=document.createElement("a");W.href=H,W.download=A,document.body.appendChild(W),W.click(),document.body.removeChild(W)}function De(){const S=new Aa.Midi;S.header.setTempo(_(p)),S.header.timeSignatures.push({ticks:0,timeSignature:[_(h),4]});const A=S.addTrack(),H=_(f).filter((Ke,Ne,Bt)=>Ne===Bt.findIndex(mt=>mt.cents===Ke.cents)).map(Ke=>Ke.cents).sort((Ke,Ne)=>Ke-Ne),W=H.length;_(f).forEach(Ke=>{A.addNote({midi:Ke.octave*W+H.indexOf(Ke.cents),time:m(Ke.time),duration:m(Ke.duration)})});const Ae=S.toArray(),be=new Blob([new Uint8Array(Ae)],{type:"audio/midi"});Ie(be,"output.mid");const Se=`! output.scl 
 ${W} 
!
 ${H.map(Ke=>Ke.toFixed(2)).join(`
 `)}`,Ge=new Blob([Se],{type:"audio/scala"});Ie(Ge,"output.scl")}let Pe=st(!1),nt=st(0),Et=st(32.7),at,Yt,$t=st(.7),In;function jn(){at.unsync(),at.sync(),_(f).forEach(S=>{at.triggerAttackRelease(zn(S.cents,S.octave),m(S.duration),m(S.time))})}yh(()=>{I();const S={};for(let A=1;A<=7;(A+=1)-1)S[`C${A}`]=`C${A}.mp3`,S[`D#${A}`]=`Ds${A}.mp3`,S[`F#${A}`]=`Fs${A}.mp3`,S[`A${A}`]=`A${A}.mp3`;at=new Ns({urls:S,release:2,baseUrl:"https://tonejs.github.io/audio/salamander/"}),Yt=new is(20*Math.log10(_($t))).toDestination(),at.connect(Yt),at.sync(),In=new Ns({urls:S,release:2,baseUrl:"https://tonejs.github.io/audio/salamander/"}),In.connect(Yt),En().scheduleRepeat(A=>{ie(nt,yt(En().seconds))},"64n"),Ya(()=>{jn()})});function zn(S,A){return _(Et)*Math.pow(2,A+S/1200)}async function Vs(){await E_(),console.log("audio is ready")}function Ve(){_(Pe)?(at.releaseAll(),at.unsync(),at.sync(),En().stop(),En().seconds=0,ie(nt,yt(En().seconds)),ie(Pe,!1)):(Vs(),jn(),En().start(),ie(Pe,!0))}function E(S,A){const W=S.currentTarget.getBoundingClientRect(),Ae=S.clientX-W.left;En().seconds=m(Ae/_(a)+A),ie(nt,yt(En().seconds)),Ve()}var J=qy();Re("keydown",wn,_e),Re("keyup",wn,q),gh(S=>{var A=xy();ue(S,A)});var re=Dt(J),Ce=oe(re,!0);ae(re);var D=te(re,2);wy(D,{get open(){return _(Oe)},set open(S){ie(Oe,yt(S))}});var U=te(D,2),se=oe(U),Q=oe(se),He=oe(Q);He.__click=Ve;var ut=oe(He),Kt=oe(ut);ae(ut),ae(He);var Lt=te(He,2),Mt=oe(Lt);to(Mt),ae(Lt),ae(Q);var Hn=te(Q,2);Ur(Hn,S=>M=S,()=>M);var _n=oe(Hn),yn=oe(_n);hy(yn,{min_val:Y,get max_val(){return _(ke)},get values(){return _(fe)},set values(S){ie(fe,yt(S))}}),ae(_n);var Ls=te(_n,2),kr=oe(Ls);Ue(kr,()=>_(Pe),S=>{var A=ky();const H=_t(()=>`left: ${b(_(nt))*_(a)}px; position: absolute; margin-left: -15px;`);we(()=>j(A,"style",_(H))),ue(S,A)});var Bs=te(kr,2);dt(Bs,17,()=>Array.from({length:_(w)}),ht,(S,A,H)=>{var W=Cy();W.__click=Ae=>E(Ae,H),W.textContent=H+1,we(()=>j(W,"style",`width: ${_(a)??""}px;`)),ue(S,W)}),ae(Ls),ae(Hn),ae(se);var Jt=te(se,2),Gn=oe(Jt),Us=oe(Gn);Ur(Us,S=>O=S,()=>O);var Cr=oe(Us);j(Cr,"width",120);var Ia=oe(Cr);dt(Ia,17,()=>Array(t+1),ht,(S,A,H)=>{var W=Sy();j(W,"x2",120),we(()=>{j(W,"y1",H*_(c)),j(W,"y2",H*_(c))}),ue(S,W)});var Na=te(Ia);dt(Na,17,()=>Array(t),ht,(S,A,H)=>{var W=Ay();W.textContent="OCTAVE "+(t-H-1),we(()=>{j(W,"y",_(c)*(.5+H)),j(W,"transform",`rotate(-90, 18, ${_(c)*(.5+H)})`)}),ue(S,W)});var Ru=te(Na);Ue(Ru,()=>_(he),S=>{var A=cn(),H=Dt(A);dt(H,17,()=>Array.from({length:t}),ht,(W,Ae,be)=>{var Se=cn(),Ge=Dt(Se);dt(Ge,17,()=>_(C),ht,(Ke,Ne,Bt)=>{var mt=_t(()=>(t-be-_(Ne)/1200)*_(c));Lr(Ke,{get y_px(){return _(mt)},get cents(){return _(Ne)},len_px:20,keyboard:!0,text_shift:-40*(Bt%2),get is_played(){return _(k)[be][Bt]}})}),ue(W,Se)}),ue(S,A)},S=>{var A=cn(),H=Dt(A);dt(H,17,()=>_(ge),ht,(W,Ae)=>{let be=()=>_(Ae).y_px,Se=()=>_(Ae).cents;Lr(W,{get y_px(){return be()},get cents(){return Se()},len_px:20,keyboard:!0})}),ue(S,A)}),ae(Cr),ae(Us),ae(Gn);var Sr=te(Gn,2);Ur(Sr,S=>N=S,()=>N);var Ar=oe(Sr);Ar.__contextmenu=[Oy];var as=oe(Ar);as.__mousedown=V;var Ea=oe(as);dt(Ea,17,()=>Array(t+1),ht,(S,A,H)=>{var W=Iy();we(()=>{j(W,"y1",H*_(c)),j(W,"x2",_(w)*_(a)),j(W,"y2",H*_(c))}),ue(S,W)});var Ma=te(Ea);dt(Ma,17,()=>Array(_(w)+1),ht,(S,A,H)=>{var W=Ny();j(W,"y1",0),we(()=>{j(W,"x1",H*_(a)),j(W,"x2",H*_(a)),j(W,"y2",t*_(c))}),ue(S,W)});var Da=te(Ma);Ue(Da,()=>_(kt),S=>{var A=cn(),H=Dt(A);dt(H,17,()=>Array(_(w)+1),ht,(W,Ae,be)=>{var Se=cn(),Ge=Dt(Se);dt(Ge,17,()=>Array(_(h)),ht,(Ne,Bt,mt)=>{var Or=My(),Xs=Dt(Or);j(Xs,"y1",0);var ju=te(Xs);dt(ju,17,()=>Array(_(d)),ht,(zu,jy,Wa)=>{var Zs=Ey();j(Zs,"y1",0),we(()=>{j(Zs,"x1",(be+(mt+Wa/_(d))/_(h))*_(a)),j(Zs,"x2",(be+(mt+Wa/_(d))/_(h))*_(a)),j(Zs,"y2",t*_(c))}),ue(zu,Zs)}),we(()=>{j(Xs,"x1",(be+mt/_(h))*_(a)),j(Xs,"x2",(be+mt/_(h))*_(a)),j(Xs,"y2",t*_(c))}),ue(Ne,Or)}),ue(W,Se)}),ue(S,A)});var Pa=te(Da);Ue(Pa,()=>_(he),S=>{var A=cn(),H=Dt(A);dt(H,17,()=>Array.from({length:t}),ht,(W,Ae,be)=>{var Se=cn(),Ge=Dt(Se);dt(Ge,17,()=>_(C),ht,(Ke,Ne)=>{var Bt=_t(()=>(t-be-_(Ne)/1200)*_(c)),mt=_t(()=>_(w)*_(a));Lr(Ke,{get y_px(){return _(Bt)},get cents(){return _(Ne)},get len_px(){return _(mt)},keyboard:!1})}),ue(W,Se)}),ue(S,A)},S=>{var A=cn(),H=Dt(A);dt(H,17,()=>_(ge),ht,(W,Ae)=>{let be=()=>_(Ae).y_px,Se=()=>_(Ae).cents;var Ge=_t(()=>_(w)*_(a));Lr(W,{get y_px(){return be()},get cents(){return Se()},get len_px(){return _(Ge)},keyboard:!1})}),ue(S,A)});var Ra=te(Pa);dt(Ra,17,()=>_(f),ht,(S,A,H)=>{let W=()=>_(A).octave,Ae=()=>_(A).cents,be=()=>_(A).time,Se=()=>_(A).duration,Ge=()=>_(A).selected;var Ke=_t(()=>x(be())),Ne=_t(()=>v(Ae(),W())),Bt=_t(()=>x(Se()));gy(S,{get note_x_px(){return _(Ke)},get note_y_px(){return _(Ne)},get note_length(){return _(Bt)},get selected(){return Ge()},removeNote:()=>L(H),selectNote:mt=>F(H,mt),startDragging:(mt,Or)=>K(H,mt,Or),startResizing:mt=>z(H,mt)})});var Fu=te(Ra);Ue(Fu,()=>_(Pe),S=>{var A=Dy();we(()=>j(A,"x1",b(_(nt))*_(a))),j(A,"y1",0),we(()=>j(A,"x2",b(_(nt))*_(a))),we(()=>j(A,"y2",t*_(c))),ue(S,A)}),ae(as),ae(Ar),ae(Sr),ae(Jt);var Fa=te(Jt,2),qs=oe(Fa);qs.__click=[Py,Oe];var Vu=oe(qs);ae(qs);var Ws=te(qs,2);Ws.__click=[Ry,ve,he,$e];var Lu=oe(Ws);ae(Ws);var Va=te(Ws,4),js=te(Va,2);js.__click=[Fy,he,ve];var Bu=oe(js);ae(js);var Ri=te(js,6),Fi=te(oe(Ri),2),Vi=oe(Fi);Vi.value=(Vi.__value=2)==null?"":2;var Li=te(Vi);Li.value=(Li.__value=3)==null?"":3;var Bi=te(Li);Bi.value=(Bi.__value=4)==null?"":4;var La=te(Bi);La.value=(La.__value=5)==null?"":5,ae(Fi),ae(Ri);var Ui=te(Ri,2),qi=te(oe(Ui),2),Wi=oe(qi);Wi.value=(Wi.__value=1)==null?"":1;var ji=te(Wi);ji.value=(ji.__value=2)==null?"":2;var zi=te(ji);zi.value=(zi.__value=3)==null?"":3;var Hi=te(zi);Hi.value=(Hi.__value=4)==null?"":4;var Gi=te(Hi);Gi.value=(Gi.__value=6)==null?"":6;var Xi=te(Gi);Xi.value=(Xi.__value=8)==null?"":8;var Zi=te(Xi);Zi.value=(Zi.__value=12)==null?"":12;var Ba=te(Zi);Ba.value=(Ba.__value=16)==null?"":16,ae(qi),ae(Ui);var zs=te(Ui,2);zs.__click=[Vy,kt];var Uu=oe(zs);ae(zs);var Hs=te(zs,2);Hs.__click=[Ly,B];var qu=oe(Hs);ae(Hs);var Yi=te(Hs,2),Ua=te(oe(Yi),2);to(Ua),ae(Yi);var Gs=te(Yi,6);Gs.__click=[By];var Wu=oe(Gs);Wu.__change=[Ty,p,h,f,b],dh(2),ae(Gs);var $i=te(Gs,2);$i.__click=[Uy,De];var qa=te($i,4),Ki=te(oe(qa),2);to(Ki),Ki.__change=()=>Yt.volume.value=20*Math.log10(_($t)),ae(qa),ae(Fa),ae(U),we(()=>{j(re,"style",`--opacity: ${(_(G)?1:0)??""}`),ln(Ce,_(Z)),j(Kt,"d",_(Pe)?"M2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12Z":"M16.6582 9.28638C18.098 10.1862 18.8178 10.6361 19.0647 11.2122C19.2803 11.7152 19.2803 12.2847 19.0647 12.7878C18.8178 13.3638 18.098 13.8137 16.6582 14.7136L9.896 18.94C8.29805 19.9387 7.49907 20.4381 6.83973 20.385C6.26501 20.3388 5.73818 20.0469 5.3944 19.584C5 19.053 5 18.1108 5 16.2264V7.77357C5 5.88919 5 4.94701 5.3944 4.41598C5.73818 3.9531 6.26501 3.66111 6.83973 3.6149C7.49907 3.5619 8.29805 4.06126 9.896 5.05998L16.6582 9.28638Z"),j(Us,"style",`height: ${t*_(c)}px;`),j(Cr,"height",t*_(c)),j(Ar,"style",`height: ${t*_(c)}px; width: ${_(w)*_(a)}px`),j(as,"width",_(w)*_(a)),j(as,"height",t*_(c)),Ys(Vu,`${(_(Oe)?"active_button":"")??""} svelte-166zlhl`),Ys(Lu,`${(_(ve)?"active_button":"")??""} svelte-166zlhl`),Ys(Bu,`${(_(he)?"active_button":"")??""} svelte-166zlhl`),Ys(Uu,`${(_(kt)?"active_button":"")??""} svelte-166zlhl`),Ys(qu,`${(_(B)?"active_button":"")??""} svelte-166zlhl`)}),no(Mt,()=>_(Et),S=>ie(Et,S)),bn(Lt,(S,A)=>xe(S,A),()=>({content:"0 cents Octave 0, Hz"})),Re("scroll",Us,I),Re("scroll",Sr,I),Re("wheel",as,P),bn(qs,(S,A)=>xe(S,A),()=>({content:"Show help"})),bn(Ws,(S,A)=>xe(S,A),()=>({content:"Show cents of notes in scale zone"})),bn(Va,(S,A)=>xe(S,A),()=>({content:"Create notes using keys"})),bn(js,(S,A)=>xe(S,A),()=>({content:"Use notes from scale zone"})),tc(Fi,()=>_(h),S=>ie(h,S)),tc(qi,()=>_(d),S=>ie(d,S)),bn(zs,(S,A)=>xe(S,A),()=>({content:"Show grid"})),bn(Hs,(S,A)=>xe(S,A),()=>({content:"Snap notes to grid"})),no(Ua,()=>_(p),S=>ie(p,S)),bn(Gs,(S,A)=>xe(S,A),()=>({content:"Import Sequence (.mid + .scl files)"})),bn($i,(S,A)=>xe(S,A),()=>({content:"Export Sequence"})),no(Ki,()=>_($t),S=>ie($t,S)),ue(n,J),ci()}tl(["click","contextmenu","mousedown","change"]);export{k1 as component};
